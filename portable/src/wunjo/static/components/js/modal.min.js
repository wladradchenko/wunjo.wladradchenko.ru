function openFileParametersModal(e){var t=document.querySelector(".modal-file-parameters-template").content.cloneNode(!0),a=t.querySelector(".modal-root"),r=a.querySelector(".modal-update"),a=a.querySelector(".modal-root-metadata"),o=JSON.stringify(e,null,2);a.placeholder=o,r.onclick=function(){sendModuleData.updateData(e),closeModal(this)},document.body.appendChild(t)}function openCalendarModal(v=null,h=null){var e=document.querySelector(".modal-calendar-template").content.cloneNode(!0);let g=e.querySelector(".calendar"),r=e.querySelector(".calendar-content");var t=e.querySelector(".calendar-range");let y=e.querySelector(".date-from"),b=e.querySelector(".date-to"),d=e.querySelector(".calendar-today"),c=e.querySelector(".calendar-yesterday");var a,o,n,l,i,s,u=e.querySelector(".calendar-submit");let m=[getTranslationBabel("Jan"),getTranslationBabel("Feb"),getTranslationBabel("Mar"),getTranslationBabel("Apr"),getTranslationBabel("May"),getTranslationBabel("Jun"),getTranslationBabel("Jul"),getTranslationBabel("Aug"),getTranslationBabel("Sep"),getTranslationBabel("Oct"),getTranslationBabel("Nov"),getTranslationBabel("Dec")],p=[getTranslationBabel("January"),getTranslationBabel("February"),getTranslationBabel("March"),getTranslationBabel("April"),getTranslationBabel("May"),getTranslationBabel("June"),getTranslationBabel("July"),getTranslationBabel("August"),getTranslationBabel("September"),getTranslationBabel("October"),getTranslationBabel("November"),getTranslationBabel("December")],f=new Date,w=new Date(f);function x(e,t,a){var r=document.querySelector(".user-calendar-date");r.setAttribute("data-year-from",a),r.setAttribute("data-month-from",t),r.setAttribute("data-day-from",e),r.setAttribute("data-year-to",a),r.setAttribute("data-month-to",t),r.setAttribute("data-day-to",e)}function k(e,t=6){var a=document.querySelector(".user-calendar-date"),r=document.querySelector(".user-calendar-date-bg"),t=((a.textContent=e).length,t+.4*Math.max(e.length-5,0));a.style.width=t.toFixed(2)+"rem",r.style.width=t.toFixed(2)+"rem"}function L(e,t,a,r,o,n){var l=e,i=t,s=a;return{fromYear:e=r,fromMonth:t=o,fromDay:a=n,toYear:r=l,toMonth:o=i,toDay:n=s}}function E(){var e=new Date;let t,a,r,o,n,l;l=v?(t=parseInt(y.getAttribute("data-year-from"))||e.getFullYear(),a=parseInt(y.getAttribute("data-month-from"))||e.getMonth(),r=parseInt(y.getAttribute("data-day-from"))||e.getDate(),o=parseInt(b.getAttribute("data-year-to"))||e.getFullYear(),n=parseInt(b.getAttribute("data-month-to"))||e.getMonth(),parseInt(b.getAttribute("data-day-to"))||e.getDate()):(h=document.querySelector(".user-calendar-date"),t=parseInt(h.getAttribute("data-year-from"))||e.getFullYear(),a=parseInt(h.getAttribute("data-month-from"))||e.getMonth(),r=parseInt(h.getAttribute("data-day-from"))||e.getDate(),o=parseInt(h.getAttribute("data-year-to"))||e.getFullYear(),n=parseInt(h.getAttribute("data-month-to"))||e.getMonth(),parseInt(h.getAttribute("data-day-to"))||e.getDate());var i,s,d,c,u,m,h=new Date(t,a,r),e=new Date(o,n,l),e=(h.getTime()>e.getTime()&&(h=L(t,a,r,o,n,l),t=h.fromYear,a=h.fromMonth,r=h.fromDay,o=h.toYear,n=h.toMonth,l=h.toDay),a),h=r,p=n,f=l;if(e<0||11<e||p<0||11<p)throw new Error("Invalid month value");if(h<1||31<h||f<1||31<f)throw new Error("Invalid day value");i=t,s=a,d=r,c=o,u=n,m=l,g.querySelector(".calendar-days").querySelectorAll("div").forEach(e=>{var t=parseInt(e.getAttribute("data-year-uniq")),a=parseInt(e.getAttribute("data-month-uniq")),r=parseInt(e.getAttribute("data-day-uniq")),t=new Date(t,a,r),a=new Date(i,s,d),r=new Date(c,u,m);a<=t&&t<=r?(e.classList.add("curr-date"),e.classList.add("bg-accent-primary"),e.classList.add("text-dark-background"),e.classList.add("font-extra-thick")):(e.classList.remove("curr-date"),e.classList.remove("bg-accent-primary"),e.classList.remove("text-dark-background"),e.classList.remove("font-extra-thick"))})}function S(e,t,a){var r=new Date,o=parseInt(y.getAttribute("data-year-from"))||r.getFullYear(),n=parseInt(y.getAttribute("data-month-from"))||r.getMonth(),l=parseInt(y.getAttribute("data-day-from"))||r.getDate(),i=parseInt(b.getAttribute("data-year-to"))||r.getFullYear(),s=parseInt(b.getAttribute("data-month-to"))||r.getMonth(),r=parseInt(b.getAttribute("data-day-to"))||r.getDate();Math.abs(new Date(a,t,e)-new Date(o,n,l))<Math.abs(new Date(a,t,e)-new Date(i,s,r))?(console.log("Closer to labelDateFrom"),b.setAttribute("data-year-to",a),b.setAttribute("data-month-to",t),b.setAttribute("data-day-to",e),b.textContent=m[t]+` ${e}, `+a):(console.log("Closer to labelDateTo"),y.setAttribute("data-year-from",a),y.setAttribute("data-month-from",t),y.setAttribute("data-day-from",e),y.textContent=m[t]+` ${e}, `+a)}w.setDate(f.getDate()-1),v&&(t.classList.remove("hidden"),t=new Date,a=document.querySelector(".user-calendar-date"),o=parseInt(a.getAttribute("data-year-from"))||t.getFullYear(),n=parseInt(a.getAttribute("data-month-from"))||t.getMonth(),l=parseInt(a.getAttribute("data-day-from"))||t.getDate(),i=parseInt(a.getAttribute("data-year-to"))||t.getFullYear(),s=parseInt(a.getAttribute("data-month-to"))||t.getMonth(),a=parseInt(a.getAttribute("data-day-to"))||t.getDate(),b.setAttribute("data-year-to",i),b.setAttribute("data-month-to",s),b.setAttribute("data-day-to",a),b.textContent=m[s]+` ${a}, `+i,y.setAttribute("data-year-from",o),y.setAttribute("data-month-from",n),y.setAttribute("data-day-from",l),y.textContent=m[n]+` ${l}, `+o),isLeapYear=e=>e%4==0&&e%100!=0&&e%400!=0||e%100==0&&e%400==0,getFebDays=e=>isLeapYear(e)?29:28,u.onclick=function(){var e=new Date;let t=parseInt(y.getAttribute("data-year-from"))||e.getFullYear(),a=parseInt(y.getAttribute("data-month-from"))||e.getMonth(),r=parseInt(y.getAttribute("data-day-from"))||e.getDate(),o=parseInt(b.getAttribute("data-year-to"))||e.getFullYear(),n=parseInt(b.getAttribute("data-month-to"))||e.getMonth(),l=parseInt(b.getAttribute("data-day-to"))||e.getDate();var i,s,d,c,u,e=new Date(t,a,r),m=new Date(o,n,l);e.getTime()>m.getTime()&&(e=L(t,a,r,o,n,l),t=e.fromYear,a=e.fromMonth,r=e.fromDay,o=e.toYear,n=e.toMonth,l=e.toDay,y.setAttribute("data-year-from",t),y.setAttribute("data-month-from",a),y.setAttribute("data-day-from",r),b.setAttribute("data-year-to",o),b.setAttribute("data-month-to",n),b.setAttribute("data-day-to",l)),m=r,e=a,i=t,s=l,d=n,c=o,(u=document.querySelector(".user-calendar-date")).setAttribute("data-year-from",i),u.setAttribute("data-month-from",e),u.setAttribute("data-day-from",m),u.setAttribute("data-year-to",c),u.setAttribute("data-month-to",d),u.setAttribute("data-day-to",s),k(b.textContent+" - "+y.textContent),validCallback(h),closeModal(g)},generateCalendar=(a,r)=>{var e=g.querySelector(".calendar-year"),o=g.querySelector(".calendar-days"),n=[31,getFebDays(r),31,30,31,30,31,31,30,31,30,31];o.innerHTML="";let l=new Date;null==a&&(a=l.getMonth()),r=r||l.getFullYear();var t=""+p[a];C.innerHTML=t,e.innerHTML=r;let i=new Date(r,a,1);d.onclick=function(){x(l.getDate(),l.getMonth(),l.getFullYear()),k(getTranslationBabel("Today")),validCallback(h),closeModal(g)},c.onclick=function(){x(w.getDate(),w.getMonth(),w.getFullYear()),k(getTranslationBabel("Yesterday")),validCallback(h),closeModal(g)};for(let t=0;t<=n[a]+i.getDay()-1;t++){var s=document.createElement("div");t>=i.getDay()&&(s.classList.add("calendar-day-hover"),s.classList.add("rounded-md"),s.classList.add("w-10"),s.classList.add("h-10"),s.setAttribute("data-day-uniq",t-i.getDay()+1),s.setAttribute("data-month-uniq",a),s.setAttribute("data-year-uniq",r),s.innerHTML=t-i.getDay()+1,t-i.getDay()+1<=l.getDate()&&r===l.getFullYear()&&a===l.getMonth()||r===l.getFullYear()&&a<l.getMonth()||r<l.getFullYear()?s.onclick=()=>{var e=new Date(r,a,t-i.getDay()+1);e.toDateString()===f.toDateString()?(console.log("Today"),v?S(t-i.getDay()+1,a,r):(x(t-i.getDay()+1,a,r),k("Today"),validCallback(h),closeModal(g))):e.toDateString()===w.toDateString()?(console.log("Yesterday"),v?S(t-i.getDay()+1,a,r):(x(t-i.getDay()+1,a,r),k(getTranslationBabel("Yesterday")),validCallback(h),closeModal(g))):(console.log(e),v?S(t-i.getDay()+1,a,r):(x(t-i.getDay()+1,a,r),k(`${m[a]} ${t-i.getDay()+1}, `+r),validCallback(h),closeModal(g))),E()}:s.style.color="#ffffff6e"),o.appendChild(s)}E()};let M=g.querySelector(".month-list"),C=(m.forEach((e,t)=>{var a=document.createElement("div");a.innerHTML=`<div data-month="${t}">${e}</div>`,a.querySelector("div").onclick=()=>{M.classList.remove("block"),F.value=t,generateCalendar(t,q.value),r.classList.remove("hidden")},M.appendChild(a)}),g.querySelector(".month-picker"));C.onclick=()=>{M.classList.add("block"),r.classList.add("hidden")};t=new Date;let F={value:t.getMonth()},q={value:t.getFullYear()};generateCalendar(F.value,q.value),g.querySelector(".prev-year").onclick=()=>{--q.value,generateCalendar(F.value,q.value)},g.querySelector(".next-year").onclick=()=>{++q.value,generateCalendar(F.value,q.value)},document.body.appendChild(e)}function openRenameNoticeModal(i,s=null){return new Promise((t,a)=>{var e=extractStaticFilePathAndNameFromSrc(i);let r=e.srcFilePath,o=e.srcFileName;var e=document.querySelector(".modal-rename-notice-template").content.cloneNode(!0),n=e.querySelector(".modal-root-filename");n.textContent=o,n.href=i,n.download=o;let l=e.querySelector(".modal-root-filename-input");l.value=o,e.querySelector(".submit-rename").onclick=function(){console.log(l.value),fetch("/content-rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:r,fileName:o,newFileName:l.value})}).then(e=>e.json()).then(e=>{200===e.status?(validCallback(s),t({newFileName:e.newFileName,srcFilePath:r})):(frontendConsoleLogToBackendPrint(e.message),a({error:"File renaming failed",srcFileName:o,srcFilePath:r}))}).catch(e=>{console.error("Error:",e),a({error:e,srcFileName:o,srcFilePath:r})}),closeModal(this)},document.body.appendChild(e)})}function openDeleteNoticeModal(l,i=null){return new Promise((t,a)=>{var e=extractStaticFilePathAndNameFromSrc(l);let r=e.srcFilePath,o=e.srcFileName;var e=document.querySelector(".modal-delete-notice-template").content.cloneNode(!0),n=e.querySelector(".modal-root-filename");n.textContent=o,n.href=l,n.download=o,e.querySelector(".submit-delete").onclick=function(){fetch("/content-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:r,fileName:o})}).then(e=>e.json()).then(e=>{200===e.status?(validCallback(i),t(!0)):frontendConsoleLogToBackendPrint(e.message)}).catch(e=>{console.error("Error:",e),a(!1)}),closeModal(this)},document.body.appendChild(e)})}function openDeleteAllFilesNoticeModal(t,o=null){return new Promise((a,r)=>{var e=document.querySelector(".modal-delete-notice-template").content.cloneNode(!0);e.querySelector(".modal-root-filename").textContent="all files",e.querySelector(".submit-delete").onclick=function(){t.forEach(e=>{var e=extractStaticFilePathAndNameFromSrc(e.fullPath),t=e.srcFilePath;fetch("/content-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:t,fileName:e.srcFileName})}).then(e=>e.json()).then(e=>{200===e.status?(validCallback(o),a(!0)):frontendConsoleLogToBackendPrint(e.message)}).catch(e=>{console.error("Error:",e),r(!1)})}),closeModal(this)},document.body.appendChild(e)})}function createModalVideo(a,e,t=null){var r="ontouchstart"in window||navigator.msMaxTouchPoints,o=document.querySelector(".modal-video-template").content.cloneNode(!0);let n=o.querySelector(".modal-root"),l=n.querySelector(".video"),i=(l.src=a,n.querySelector(".download"));i.href=a,i.download=e.name;var s=new URL(window.location.href);s.origin;let d={[getTranslationBabel("Live portrait")]:"/live-portrait",[getTranslationBabel("Face swap")]:"/face-swap",[getTranslationBabel("Lip sync")]:"/lip-sync",[getTranslationBabel("Enhancement")]:"/enhancement",[getTranslationBabel("Remove object")]:"/remove-object",[getTranslationBabel("Remove background")]:"/remove-background",[getTranslationBabel("Restyling")]:"/restyling"};var s=Object.keys(d),c=n.querySelector(".edit-input");let u=new Awesomplete(c,{list:s,minChars:0,maxItems:10}),m=(u.ul.style.maxHeight="10rem",u.input.classList.remove("w-14"),u.input.classList.add("w-24"),c.addEventListener("focus",function(){u.evaluate(),u.open()}),c.addEventListener("awesomplete-selectcomplete",async function(e){e.text.value in d&&(e=d[e.text.value],window.location.href=e+"?attachment="+a)}),n.querySelector(".censure"));function h(){m.querySelector(".fa-eye").classList.toggle("hidden"),m.querySelector(".fa-eye-slash").classList.toggle("hidden"),l.style.filter=l.style.filter?"":"blur(50px)"}!0===e.censure&&(h(),m.onclick=h);let p=n.querySelector(".description");s=n.querySelector(".datetime-created");let f=n.querySelector(".fps"),v=n.querySelector(".duration"),g=n.querySelector(".sound-button");function y(e){var t=n.querySelector(".open-parameters-view"),a=n.querySelector(".parameters"),e=e.target;a.contains(e)||t.contains(e)||n.querySelector(".close-parameters-view").click()}function b(e){return Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0")}p.textContent=e.name,s.textContent=formatDateTime(e.created),n.querySelector(".repost-button").onclick=function(){var e=a,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("copy"),document.body.removeChild(t)},n.querySelector(".rename-button").onclick=function(){openRenameNoticeModal(a,t).then(e=>{p.textContent=e.newFileName;var t=createStaticSrc(e.srcFilePath,e.newFileName);a=t,l.src=t,i.href=t,i.download=e.newFileName}).catch(e=>{})},n.querySelector(".delete-button").onclick=function(){openDeleteNoticeModal(a,t).then(e=>{!0===e&&closeModal(this)}).catch(e=>{console.error("Error:",e)})},n.querySelector(".open-parameters-view").onclick=function(){var e=n.querySelector(".parameters");e.classList.remove("hidden"),e.classList.add("block"),setTimeout(()=>{document.addEventListener("click",y)},100)},n.querySelector(".close-parameters-view").onclick=function(){var e=n.querySelector(".parameters");e.classList.remove("block"),e.classList.add("hidden"),document.removeEventListener("click",y)},r?l.addEventListener("click",function(){l.paused?l.play():l.pause()}):(l.addEventListener("mouseover",function(){l.play().catch(e=>{})}),l.addEventListener("mouseout",function(){l.pause()})),g.addEventListener("click",function(){l.muted=!l.muted;var e=l.muted?'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="m14.667 6-4 4m0-4 4 4M7.333 3.333 4 6H1.333v4H4l3.333 2.667V3.333Z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="M10.36 3.64a3.333 3.333 0 0 1 0 4.713m2.353-7.066a6.667 6.667 0 0 1 0 9.426m-5.38-9.38L4 4H1.333v4H4l3.333 2.667V1.333Z"></path></svg>';g.innerHTML=e,l.focus()}),l.addEventListener("loadedmetadata",function(){l.pause(),l.muted=!1;var e,t=b(l.duration);v.textContent="0:00/"+t,l.webkitDecodedFrameCount&&l.webkitDroppedFrameCount?(t=l.webkitDecodedFrameCount/l.duration,e=l.webkitDroppedFrameCount/l.duration,f.textContent=`Decoded FPS: ${t.toFixed(2)}, Dropped FPS: `+e.toFixed(2)):console.log("Video FPS calculations are not supported")}),l.addEventListener("timeupdate",function(){var e=b(l.currentTime),t=b(l.duration);v.textContent=e+"/"+t}),document.body.appendChild(o)}function createModalImage(a,e,t=null){var r=document.querySelector(".modal-image-template").content.cloneNode(!0);let o=r.querySelector(".modal-root"),n=o.querySelector(".image"),l=(n.src=a,o.querySelector(".censure"));function i(){l.querySelector(".fa-eye").classList.toggle("hidden"),l.querySelector(".fa-eye-slash").classList.toggle("hidden"),n.style.filter=n.style.filter?"":"blur(50px)"}!0===e.censure&&(i(),l.onclick=i);let s=o.querySelector(".download");s.href=a,s.download=e.name;var d=new URL(window.location.href);d.origin;let c={[getTranslationBabel("Live portrait")]:"/live-portrait",[getTranslationBabel("Face swap")]:"/face-swap",[getTranslationBabel("Lip sync")]:"/lip-sync",[getTranslationBabel("Enhancement")]:"/enhancement",[getTranslationBabel("Remove object")]:"/remove-object",[getTranslationBabel("Remove background")]:"/remove-background",[getTranslationBabel("Generation")]:"/generation",[getTranslationBabel("Restyling")]:"/restyling"};var d=Object.keys(c),u=o.querySelector(".edit-input");let m=new Awesomplete(u,{list:d,minChars:0,maxItems:10}),h=(m.ul.style.maxHeight="10rem",m.input.classList.remove("w-14"),m.input.classList.add("w-24"),u.addEventListener("focus",function(){m.evaluate(),m.open()}),u.addEventListener("awesomplete-selectcomplete",async function(e){e.text.value in c&&(e=c[e.text.value],window.location.href=e+"?attachment="+a)}),o.querySelector(".description"));d=o.querySelector(".datetime-created");function p(e){var t=o.querySelector(".open-parameters-view"),a=o.querySelector(".parameters"),e=e.target;a.contains(e)||t.contains(e)||o.querySelector(".close-parameters-view").click()}h.textContent=e.name,d.textContent=formatDateTime(e.created),o.querySelector(".repost-button").onclick=function(){var e=a,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("copy"),document.body.removeChild(t)},o.querySelector(".rename-button").onclick=function(){openRenameNoticeModal(a,t).then(e=>{h.textContent=e.newFileName;var t=createStaticSrc(e.srcFilePath,e.newFileName);a=t,n.src=t,s.href=t,s.download=e.newFileName}).catch(e=>{})},o.querySelector(".delete-button").onclick=function(){openDeleteNoticeModal(a,t).then(e=>{!0===e&&closeModal(this)}).catch(e=>{console.error("Error:",e)})},o.querySelector(".open-parameters-view").onclick=function(){var e=o.querySelector(".parameters");e.classList.remove("hidden"),e.classList.add("block"),setTimeout(()=>{document.addEventListener("click",p)},100)},o.querySelector(".close-parameters-view").onclick=function(){var e=o.querySelector(".parameters");e.classList.remove("block"),e.classList.add("hidden"),document.removeEventListener("click",p)},document.body.appendChild(r)}function createModalImageGroup(i,n,e=null){var t=document.querySelector(".modal-image-group-template").content.cloneNode(!0);let r=t.querySelector(".modal-root"),s=r.querySelector(".image"),d=r.querySelector(".mini-images"),c=0;var a=i[c].fullPath;s.src=a;let o=r.querySelector(".censure");function l(){o.querySelector(".fa-eye").classList.toggle("hidden"),o.querySelector(".fa-eye-slash").classList.toggle("hidden"),s.style.filter=s.style.filter?"":"blur(50px)"}!0===n.censure&&(l(),o.onclick=l);let u=r.querySelector(".download"),m=(u.href=a,u.download=i[c].name,r.querySelector(".description"));a=r.querySelector(".datetime-created");m.textContent=i[c].name,a.textContent=formatDateTime(n.created);let h=0,p=0;function f(){d.querySelectorAll("button").forEach((e,t)=>{e.style.filter="grayscale(100%)"})}function v(n=null){let e,l=1.5*(e=0===d.querySelectorAll("button").length?10<i.length?10:i.length:1),t,a;"down"===n?(t=p+1,h=t,a=t+e-1,p=a):"up"===n?(a=h-1,(p=a)<0&&(a=i.length-1,p=a),t=Math.max(0,a-e+1),h=t):"init"===n&&(t=p,h=t,a=t+e-1,p=a);var r=[];for(let e=t;e<=a;e++)r.push(e);"up"===n&&r.reverse(),r.forEach(e=>{let t=e%i.length;e=i[t];let a=document.createElement("button");a.style="will-change: filter;transition: filter 0.12s ease-in, border-color 0.12s ease;",a.classList.add("mini-image-"+t),a.setAttribute("index",e.index),i[c].index!==e.index&&(a.style.filter="grayscale(100%)"),a.onclick=function(){c=t,s.src=i[c].fullPath,m.textContent=i[c].name,u.href=i[c].fullPath,u.download=i[c].name,f(),a.style.filter=""};var r=document.createElement("div"),o=(r.classList.add("h-7","w-7","absolute","left-1","z-[1]","text-s-mobile","lg:text-s","!font-medium","px-2","py-1.5","rounded-md","bg-dark-tags"),r.textContent=1+t,r.style.margin=".25rem",document.createElement("img"));o.classList.add("w-auto","object-contain","rounded-[.625rem]"),o.src=e.fullPath,a.appendChild(r),a.appendChild(o),"down"===n||"init"===n?(d.appendChild(a),d.firstChild&&l<d.childElementCount&&d.removeChild(d.firstChild)):"up"===n&&(d.insertBefore(a,d.firstChild),d.lastChild)&&l<d.childElementCount&&(d.removeChild(d.lastChild),d.scrollTop=l)})}function g(){d.querySelectorAll("button").forEach((e,t)=>{var a=parseInt(e.getAttribute("index"));i[c].index===a&&(f(),e.style.filter="")})}function y(e){var t=r.querySelector(".open-parameters-view"),a=r.querySelector(".parameters"),e=e.target;a.contains(e)||t.contains(e)||r.querySelector(".close-parameters-view").click()}d.addEventListener("wheel",e=>{e.preventDefault();e=.1*e.deltaY;d.scrollBy(0,e)},{passive:!1}),r.querySelector(".repost-button").onclick=function(){var e=i.map(e=>e.fullPath).join(", "),t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("copy"),document.body.removeChild(t)},v("init"),d.addEventListener("scroll",()=>{d.scrollTop+d.clientHeight>=d.scrollHeight?v("down"):0===d.scrollTop&&(console.log(1),v("up"))}),r.querySelectorAll(".touchscreen-back-button").forEach((e,t)=>{e.onclick=function(){c=(c-1+i.length)%i.length,s.src=i[c].fullPath,m.textContent=i[c].name,u.href=i[c].fullPath,u.download=i[c].name,g()}}),r.querySelectorAll(".touchscreen-next-button").forEach((e,t)=>{e.onclick=function(){c=(c+1)%i.length,s.src=i[c].fullPath,m.textContent=i[c].name,u.href=i[c].fullPath,u.download=i[c].name,g()}}),r.querySelector(".mini-up-images-button").onclick=function(){d.clientHeight;var e=d.scrollTop,t=d.querySelectorAll("button"),t=(t.length,2*t[0].offsetHeight);d.scrollTop=Math.max(e-t,0)},r.querySelector(".mini-down-images-button").onclick=function(){var e=d.clientHeight,t=d.scrollTop,a=d.querySelectorAll("button"),a=(a.length,2*a[0].offsetHeight);d.scrollTop=Math.min(t+a,d.scrollHeight-e)},r.querySelector(".delete-button").onclick=function(){openDeleteNoticeModal(i[c].fullPath,e).then(e=>{!0===e&&(d.querySelectorAll("button").forEach((e,t)=>{var a=parseInt(e.getAttribute("index"));i[c].index===a&&e.remove()}),-1<c&&i.splice(c,1),0===i.length&&closeModal(this),c>i.length-1&&(c=i.length-1),s.src=i[c].fullPath,m.textContent=i[c].name,u.href=i[c].fullPath,u.download=i[c].name,f(),d.querySelectorAll("button").forEach((e,t)=>{var a=parseInt(e.getAttribute("index"));i[c].index===a&&(e.style.filter="")}))}).catch(e=>{console.error("Error:",e)})},r.querySelectorAll(".delete-all-button").forEach(t=>{t.addEventListener("click",()=>{openDeleteAllFilesNoticeModal(i,e).then(e=>{!0===e&&closeModal(t)}).catch(e=>{console.error("Error:",e)})})}),r.querySelectorAll(".download-archive").forEach(o=>{o.addEventListener("click",()=>{o.querySelector("span").textContent="Archiving";let a=new JSZip,r=[];i.forEach(t=>{var e=fetch(t.fullPath).then(e=>e.blob()).then(e=>{a.file(t.name,e)}).catch(e=>console.error("Error fetching file:",e));r.push(e)}),Promise.all(r).then(()=>{a.generateAsync({type:"blob"}).then(e=>{var e=window.URL.createObjectURL(e),t=document.createElement("a");t.href=e,t.download=n.name+".zip",t.click(),window.URL.revokeObjectURL(e),o.querySelector("span").textContent="Download All"}).catch(e=>console.error("Error creating archive:",e))})})});let b=r.querySelector(".burger-list"),w=r.querySelector(".burger");function x(e){b.contains(e.target)||e.target===w||(b.classList.add("hidden"),document.removeEventListener("click",x))}w.onclick=function(){b.classList.remove("hidden"),setTimeout(()=>{document.addEventListener("click",x)},100)},r.querySelector(".open-parameters-view").onclick=function(){var e=r.querySelector(".parameters");e.classList.remove("hidden"),e.classList.add("block"),setTimeout(()=>{document.addEventListener("click",y)},100)},r.querySelector(".close-parameters-view").onclick=function(){var e=r.querySelector(".parameters");e.classList.remove("block"),e.classList.add("hidden"),document.removeEventListener("click",y)},document.body.appendChild(t)}function createModalAudio(a,e,t=null){var r=document.querySelector(".modal-audio-template").content.cloneNode(!0);let o=r.querySelector(".modal-root"),n=o.querySelector(".audio"),l=(n.src=a,o.querySelector(".download"));l.href=a,l.download=e.name;var i=new URL(window.location.href);i.origin;let s={[getTranslationBabel("Clone voice")]:"/clone-voice",[getTranslationBabel("Separator")]:"/separator"};var i=Object.keys(s),d=o.querySelector(".edit-input");let c=new Awesomplete(d,{list:i,minChars:0,maxItems:10}),u=(c.ul.style.maxHeight="10rem",d.addEventListener("focus",function(){c.evaluate(),c.open()}),d.addEventListener("awesomplete-selectcomplete",async function(e){e.text.value in s&&(e=s[e.text.value],window.location.href=e+"?attachment="+a)}),o.querySelector(".description"));i=o.querySelector(".datetime-created");let m=o.querySelector(".audio-control"),h=o.querySelector(".sound-button"),p=o.querySelector(".current-time"),f=o.querySelector(".duration"),v=o.querySelector(".current-time-slider"),g=o.querySelector(".audio-wave");function y(e){let l=20,i=document.createElement("canvas"),t=(i.style.opacity=.5,i.width=g.offsetWidth,i.height=g.offsetHeight-2*l,g.appendChild(i),window.AudioContext=window.AudioContext||window.webkitAudioContext,new AudioContext);let s=(e,t,a,r,o)=>{e.lineWidth=1,e.strokeStyle="#fff",e.fillStyle="#fff",e.beginPath(),a=o?a:-a,a=-Math.abs(a),e.moveTo(t,0),e.lineTo(t,a),e.arc(t+r/2,a,r/2,0,0,o),e.lineTo(t+r,0),e.stroke(),e.fill()};fetch(e).then(e=>e.arrayBuffer()).then(e=>t.decodeAudioData(e)).then(e=>(a=>{const e=window.devicePixelRatio||1,r=(i.width=i.offsetWidth*e,i.height=(i.offsetHeight+l*2)*e,i.getContext("2d")),o=(r.scale(e,e),r.translate(0,i.offsetHeight/2+l),i.offsetWidth/a.length);for(let t=0;t<a.length;t++){const n=o*t;let e=a[t]*i.offsetHeight-l;if(e<0)e=0;else if(e>i.offsetHeight/2)e=e>i.offsetHeight/2;s(r,n,e,o,(t+1)%2)}})((e=>{const t=Math.pow(Math.max(...e),-1);return e.map(e=>e*t)})((e=>{const r=e.getChannelData(0),t=100,o=Math.floor(r.length/t),n=[];for(let e=0;e<t;e++){let t=o*e;let a=0;for(let e=0;e<o;e++)a=a+Math.abs(r[t+e]);n.push(a/o)}return n})(e))))}function b(e){var t=o.querySelector(".open-parameters-view"),a=o.querySelector(".parameters"),e=e.target;a.contains(e)||t.contains(e)||o.querySelector(".close-parameters-view").click()}function w(e){return Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0")}u.textContent=e.name,i.textContent=formatDateTime(e.created),g.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a*100,e=(v.style.left=t+"%",n.duration),a=e*t/100;n.currentTime=a}),o.querySelector(".repost-button").onclick=function(){var e=a,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("copy"),document.body.removeChild(t)},o.querySelector(".rename-button").onclick=function(){openRenameNoticeModal(a,t).then(e=>{u.textContent=e.newFileName;var t=createStaticSrc(e.srcFilePath,e.newFileName);a=t,image.src=t,l.href=t,l.download=e.newFileName}).catch(e=>{})},o.querySelector(".delete-button").onclick=function(){openDeleteNoticeModal(a,t).then(e=>{!0===e&&closeModal(this)}).catch(e=>{console.error("Error:",e)})},o.querySelector(".open-parameters-view").onclick=function(){var e=o.querySelector(".parameters");e.classList.remove("hidden"),e.classList.add("block"),setTimeout(()=>{document.addEventListener("click",b)},100)},o.querySelector(".close-parameters-view").onclick=function(){var e=o.querySelector(".parameters");e.classList.remove("block"),e.classList.add("hidden"),document.removeEventListener("click",b)},h.addEventListener("click",function(){n.muted=!n.muted;var e=n.muted?'<svg style="scale:1.4;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="m14.667 6-4 4m0-4 4 4M7.333 3.333 4 6H1.333v4H4l3.333 2.667V3.333Z"></path></svg>':'<svg style="scale:1.4;" xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="M10.36 3.64a3.333 3.333 0 0 1 0 4.713m2.353-7.066a6.667 6.667 0 0 1 0 9.426m-5.38-9.38L4 4H1.333v4H4l3.333 2.667V1.333Z"></path></svg>';h.innerHTML=e}),m.addEventListener("click",function(){n.paused?n.play():n.pause();var e=n.paused?'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="#fff"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.167 2.5 15.832 10 4.166 17.5v-15Z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="#fff"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7.833 3.333H4.5v13.334h3.333V3.333ZM15.5 3.333h-3.333v13.334H15.5V3.333Z"></path></svg>';m.innerHTML=e}),n.addEventListener("loadedmetadata",function(){n.pause(),n.muted=!1;var e=w(n.duration);p.textContent="0:00",f.textContent=""+e,y(n.src)}),n.addEventListener("timeupdate",function(){var e=w(n.currentTime),t=w(n.duration),a=n.currentTime/n.duration*100;p.textContent=""+e,f.textContent=""+t,v.style.left=a+"%"}),document.body.appendChild(r)}async function createModalSAMLoadMessage(t){var e=document.querySelector(".modal-sam-load-model-template").content.cloneNode(!0);let a=e.querySelector(".modal-root");var r=a.querySelector(".close-button");document.body.appendChild(e);(()=>{let e=new XMLHttpRequest;e.addEventListener("load",()=>{200<=e.status&&e.status<300?(console.log("Model file has been successfully loaded."),closeModal(a)):console.error("Failed to load model file.")}),e.addEventListener("error",()=>{console.error("Error loading model file.")}),e.open("GET",t),e.send()})(),r.onclick=async function(){isUseBrash(2),closeModal(a)}}function createModalSAMVideo(e,t=null,a=null){let o="ontouchstart"in window||navigator.msMaxTouchPoints;var r=document.querySelector(".modal-sam-video-template").content.cloneNode(!0);let n=r.querySelector(".modal-root"),d=(turnOnUpdateEmbBrash(),n.querySelector(".video"));d.setAttribute("crossorigin","anonymous");try{d.src=URL.createObjectURL(e)}catch{d.src=e}let l,c=n.querySelector(".timeline"),i=n.querySelector(".duration");var s=n.querySelector(".sound-button");let u=0,m=n.querySelector(".timeline-range-current"),h=n.querySelector(".timeline-range-left"),p=n.querySelector(".timeline-range-right"),f=document.createElement("div"),v=(f.classList.add("rounded-l-md","h-14","absolute","z-2","left-0","flex-row","flex","bg-dark-elements","opacity-90"),document.createElement("div"));v.classList.add("rounded-r-md","h-14","absolute","z-2","right-0","flex-row","flex","bg-dark-elements","opacity-90"),c.parentElement.appendChild(f),c.parentElement.appendChild(v);var g=document.createElement("div"),y=(g.classList.add("h-14","absolute","z-2","left-0","w-full"),c.parentElement.appendChild(g),n.querySelector(".end-time-back"));let b=n.querySelector(".end-time-input");var w=n.querySelector(".end-time-forward"),x=n.querySelector(".start-time-back");let k=n.querySelector(".start-time-input");var L=n.querySelector(".start-time-forward");let E=n.querySelectorAll(".brush"),S=0,M=!0,C=n.querySelector(".watch-button");function F(e){return e<0?e=0:e>l&&(e=l),e>b.value&&(e=b.value),parseFloat(e).toFixed(2)}function q(e){return e<0?e=0:e>l&&(e=l),e<k.value&&(e=k.value),parseFloat(e).toFixed(2)}function T(e,t,a){return Math.abs(e/(a-t)*l).toFixed(2)}function A(e,t,a){return Math.abs(e/l*(a-t)).toFixed(2)}function D(){let t=d.offsetHeight;n.querySelectorAll(".canvas-brash").forEach(e=>{e.style.height=t+"px"}),n.querySelectorAll(".svg-brash").forEach(e=>{e.style.height=t+"px"})}function _(){sendModuleData.sourceFile.startTime=k.value,sendModuleData.sourceFile.endTime=b.value}function B(e){return Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0")}function U(){E.forEach(e=>{e.classList.remove("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),e.classList.add("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up")})}o?d.addEventListener("click",function(){!1===M&&(d.paused?d.play():d.pause())}):(d.addEventListener("mouseover",function(){!1===M&&d.play().catch(e=>{})}),d.addEventListener("mouseout",function(){!1===M&&d.pause()})),s.addEventListener("click",function(){d.muted=!d.muted;var e=d.muted?'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="m14.667 6-4 4m0-4 4 4M7.333 3.333 4 6H1.333v4H4l3.333 2.667V3.333Z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="M10.36 3.64a3.333 3.333 0 0 1 0 4.713m2.353-7.066a6.667 6.667 0 0 1 0 9.426m-5.38-9.38L4 4H1.333v4H4l3.333 2.667V1.333Z"></path></svg>';this.innerHTML=e,d.focus()}),n.querySelector(".reset-button").onclick=function(){sendModuleData.moduleParameters.SAM=[],k.value=0,b.value=l,k.onchange(),b.onchange(),clearBrash(),sendModuleData.moduleParameters.SAM=[],o?isUseBrash(2):isUseBrash(1),C.click(),_(),updateCloseButton(n.querySelector(".close-button"),!1)},g.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a,e=(m.value=t*m.max,t*l);d.currentTime=parseFloat(e)||0}),f.parentElement.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a,e=(m.value=t*m.max,t*l);d.currentTime=parseFloat(e)||0}),x.onclick=function(){k.value=F(parseFloat(k.value)-parseFloat(k.step)),h.value=A(parseFloat(k.value),h.min,h.max),h.oninput(),d.currentTime=parseFloat(k.value)||0},k.onchange=function(){this.value=F(parseFloat(this.value)),h.value=A(parseFloat(this.value),h.min,h.max),h.oninput(),d.currentTime=parseFloat(this.value)||0},L.onclick=function(){k.value=F(parseFloat(k.value)+parseFloat(k.step)),h.value=A(parseFloat(k.value),h.min,h.max),h.oninput(),d.currentTime=parseFloat(k.value)||0},y.onclick=function(){b.value=q(parseFloat(b.value)-parseFloat(b.step)),p.value=A(parseFloat(b.value),p.min,p.max),p.oninput(),d.currentTime=parseFloat(b.value)||0},b.onchange=function(){this.value=q(parseFloat(this.value)),p.value=A(parseFloat(this.value),p.min,p.max),p.oninput(),d.currentTime=parseFloat(this.value)||0},w.onclick=function(){b.value=q(parseFloat(b.value)+parseFloat(b.step)),p.value=A(parseFloat(b.value),p.min,p.max),p.oninput(),d.currentTime=parseFloat(b.value)||0},window.addEventListener("resize",function(){var e;e=c.offsetWidth*h.value/(h.max-h.min),f.style.width=e+"px",e=c.offsetWidth-c.offsetWidth*p.value/(p.max-p.min),v.style.width=e+"px",E.forEach(e=>{e.click()}),D()}),h.oninput=function(){parseInt(p.value)-parseInt(h.value)<=u&&(h.value=parseInt(p.value)-u);var e=c.offsetWidth*this.value/(this.max-this.min);f.style.width=e+"px",k.value=T(this.value,this.max,this.min),_()},p.oninput=function(){parseInt(p.value)-parseInt(h.value)<=u&&(p.value=parseInt(h.value)+u);var e=c.offsetWidth-c.offsetWidth*this.value/(this.max-this.min);v.style.width=e+"px",b.value=T(this.value,this.max,this.min),_()},d.addEventListener("loadedmetadata",async function(){var e=n.querySelector(".modal-content-display"),e=(e&&(e=window.getComputedStyle(e),e=parseFloat(e.getPropertyValue("padding-top")),this.offsetHeight<e?(this.classList.remove("h-full"),this.classList.add("h-auto")):this.classList.add("h-full")),this.pause(),this.muted=!0,sendModuleData.sourceFile.naturalWidth=this.videoWidth,sendModuleData.sourceFile.naturalHeight=this.videoHeight,sendModuleData.sourceFile.offsetWidth=this.offsetWidth,sendModuleData.sourceFile.offsetHeight=this.offsetHeight,l=sendModuleData.sourceFile.fileSizeBytes>maxFileSize?maxFileSize/sendModuleData.sourceFile.fileSizeBytes*this.duration:this.duration,sendModuleData.sourceFile.startTime=0,B(sendModuleData.sourceFile.endTime=l));i.textContent="0:00/"+e;{var[e,t=5]=[l];let a=n.querySelector(".timeline-markers"),r=(a.innerHTML="",e/t);e=Array.from({length:6},(e,t)=>B(r*t)),[...new Set(e)].forEach(e=>{var t=document.createElement("div");t.textContent=e,a.appendChild(t)})}await 0,await(async(e,l=10)=>{let i=document.createElement("canvas"),s=document.createElement("video");s.autoplay=!0,s.muted=!0,s.src=e,s.crossOrigin="anonymous",s.onloadeddata=async()=>{var t=i.getContext("2d"),a=(i.width=s.videoWidth,i.height=s.videoHeight,d.offsetWidth/(60/i.height*i.width*10)),r=(s.pause(),s.duration/(l-1));for(let e=0;e<l;e++){var o=e*r;s.currentTime=o,await new Promise(e=>s.onseeked=e),t.clearRect(0,0,i.width,i.height),i.width=s.videoWidth*a,i.height=s.videoHeight;for(let e=0;e<a;e++)t.drawImage(s,e*s.videoWidth,0,s.videoWidth,s.videoHeight);var o=i.toDataURL("image/png"),o=await(await fetch(o)).blob(),o=URL.createObjectURL(o),n=document.createElement("div");n.classList.add("h-14","w-full","opacity-60"),n.style.backgroundSize="auto 100%",n.style.backgroundRepeat="repeat",n.style.backgroundImage=`url(${o})`,c.appendChild(n)}}})(this.src),k.value=0,k.max=l.toFixed(2),b.value=l.toFixed(2),b.max=l.toFixed(2);t=Math.min((p.max-p.min)/l,(h.max-h.min)/l);u=t,D()}),d.addEventListener("timeupdate",function(){k.value>this.currentTime&&(this.currentTime=k.value),this.currentTime>b.value&&(this.currentTime=k.value);var e=B(this.currentTime),t=B(l);i.textContent=e+"/"+t,m.value=this.currentTime/l*m.max}),C.onclick=async function(){o||updateCanvasHoverBrash(),M=!1,n.querySelectorAll(".accessible-media-control").forEach(e=>{e.classList.add("hidden")}),C.classList.remove("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),C.classList.add("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),isUseBrash(0),n.querySelectorAll(".canvas-brash").forEach(e=>{e.classList.add("hidden")}),U(),d.paused&&d.play()},n.querySelector(".close-button").onclick=function(){sendModuleData.sourceFile.urlFile=e,sendModuleData.sourceFile.formatFile="mp4",a&&"function"==typeof a&&a(),turnOnUpdateEmbBrash(),t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.SAM)&&(0===sendModuleData.moduleParameters.SAM.length?(console.log("SAM is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("SAM is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},n.querySelector(".clear-brush").onclick=async function(){clearBrash(),sendModuleData.moduleParameters.SAM=[],o?isUseBrash(2):isUseBrash(1),updateCloseButton(n.querySelector(".close-button"),!1)},E.forEach((e,r)=>{let t=document.createElement("svg"),a=(t.classList.add("svg-brash","svg-brash-"+r,"absolute","w-full","h-full","z-[-1]"),d.insertAdjacentElement("beforebegin",t),document.createElement("canvas"));a.classList.add("canvas-brash","canvas-brash-"+r,"absolute","w-full","h-full","z-[0]"),a.setAttribute("id","canvas-brash-"+r),d.insertAdjacentElement("beforebegin",a),e.onclick=async function(){o||updateCanvasHoverBrash(),t.style.width=d.offsetWidth+"px",a.style.width=d.offsetWidth+"px",d.pause(),M=!0,n.querySelectorAll(".accessible-media-control").forEach(e=>{e.classList.remove("hidden")}),C.classList.remove("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),C.classList.add("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),o?isUseBrash(2):isUseBrash(1),n.querySelectorAll(".canvas-brash").forEach(e=>{e.classList.remove("hidden")}),U(),this.classList.remove("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),this.classList.add("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),n.querySelectorAll(".canvas-brash").forEach(e=>{a===e?(e.classList.remove("z-[0]"),e.classList.add("z-[1]")):(e.classList.add("z-[0]"),e.classList.remove("z-[1]"))}),d.currentTime=parseFloat(k.value)||0,S!==parseFloat(k.value)&&(S=parseFloat(k.value),clearBrash(),sendModuleData.moduleParameters.SAM=[],turnOnUpdateEmbBrash(),updateCloseButton(n.querySelector(".close-button"),!1)),await new Promise(a=>{d.addEventListener("seeked",async e=>{var t=document.createElement("canvas");t.width=e.target.videoWidth,t.height=e.target.videoHeight,t.getContext("2d").drawImage(e.target,0,0,e.target.videoWidth,e.target.videoHeight),t.toBlob(async e=>{await getEmbBrash(e,r),a()},"image/jpeg")})}),o?isUseBrash(2):isUseBrash(1)}}),document.body.appendChild(r),d.addEventListener("loadeddata",function(){0<E.length&&E[E.length-1].click()})}function createModalSAMImage(e,t=null,a=null){sendModuleData.moduleParameters.SAM=[];let o="ontouchstart"in window||navigator.msMaxTouchPoints;var r=document.querySelector(".modal-sam-image-template").content.cloneNode(!0);let n=r.querySelector(".modal-root"),l=(turnOnUpdateEmbBrash(),n.querySelector(".image"));try{l.src=URL.createObjectURL(e)}catch{l.src=e}let i=n.querySelectorAll(".brush");function s(){let t=l.offsetHeight;n.querySelectorAll(".canvas-brash").forEach(e=>{e.style.height=t+"px"}),n.querySelectorAll(".svg-brash").forEach(e=>{e.style.height=t+"px"})}n.querySelector(".clear-brush").onclick=async function(){clearBrash(),sendModuleData.moduleParameters.SAM=[],o?isUseBrash(2):isUseBrash(1),updateCloseButton(n.querySelector(".close-button"),!1)},n.querySelector(".close-button").onclick=function(){sendModuleData.sourceFile.urlFile=e,sendModuleData.sourceFile.formatFile="jpg",a&&"function"==typeof a&&a(),turnOnUpdateEmbBrash(),t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.SAM)&&(0===sendModuleData.moduleParameters.SAM.length?(console.log("SAM is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("SAM is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},o?isUseBrash(2):isUseBrash(1),i.forEach((e,t)=>{let a=document.createElement("svg"),r=(a.classList.add("svg-brash","svg-brash-"+t,"absolute","w-full","h-full","z-[-1]"),l.insertAdjacentElement("beforebegin",a),document.createElement("canvas"));r.classList.add("canvas-brash","canvas-brash-"+t,"absolute","w-full","h-full","z-[0]"),r.setAttribute("id","canvas-brash-"+t),l.insertAdjacentElement("beforebegin",r),e.onclick=async function(){o||updateCanvasHoverBrash(),a.style.width=l.offsetWidth+"px",r.style.width=l.offsetWidth+"px",sendModuleData.sourceFile.naturalWidth=l.naturalWidth,sendModuleData.sourceFile.naturalHeight=l.naturalHeight,sendModuleData.sourceFile.offsetWidth=l.offsetWidth,sendModuleData.sourceFile.offsetHeight=l.offsetHeight,i.forEach(e=>{e.classList.remove("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),e.classList.add("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up")}),this.classList.remove("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),this.classList.add("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),n.querySelectorAll(".canvas-brash").forEach(e=>{r===e?(e.classList.remove("z-[0]"),e.classList.add("z-[1]")):(e.classList.add("z-[0]"),e.classList.remove("z-[1]"))}),await getEmbBrash(l.src,t),o?isUseBrash(2):isUseBrash(1)}}),window.addEventListener("resize",function(){i.forEach(e=>{e.click()}),s()}),document.body.appendChild(r),l.addEventListener("load",function(){var e=n.querySelector(".modal-content-display");e&&(e=window.getComputedStyle(e),e=parseFloat(e.getPropertyValue("padding-top")),this.offsetHeight>e)&&(this.classList.add("h-full"),this.classList.remove("h-auto")),0<i.length&&i[i.length-1].click(),s()})}function createModalDetectVideo(e,t=null,a){var r="ontouchstart"in window||navigator.msMaxTouchPoints,o=document.querySelector(".modal-detect-video-template").content.cloneNode(!0);let n=o.querySelector(".modal-root"),l=n.querySelector(".watch-button"),i=!1,s=0,d=Math.floor(1e3*Math.random()),c=(n.querySelector(".modal-load-element").setAttribute("data-index",d),n.querySelector(".video"));c.setAttribute("crossorigin","anonymous"),c.src=e;let u,m=n.querySelector(".timeline"),h=n.querySelector(".duration");var p=n.querySelector(".sound-button");let f=0,v=n.querySelector(".timeline-range-current"),g=n.querySelector(".timeline-range-left"),y=n.querySelector(".timeline-range-right"),b=document.createElement("div"),w=(b.classList.add("rounded-l-md","h-14","absolute","z-2","left-0","flex-row","flex","bg-dark-elements","opacity-90"),document.createElement("div"));w.classList.add("rounded-r-md","h-14","absolute","z-2","right-0","flex-row","flex","bg-dark-elements","opacity-90"),m.parentElement.appendChild(b),m.parentElement.appendChild(w);var x=document.createElement("div"),k=(x.classList.add("h-14","absolute","z-2","left-0","w-full"),m.parentElement.appendChild(x),n.querySelector(".end-time-back"));let L=n.querySelector(".end-time-input");var E=n.querySelector(".end-time-forward"),S=n.querySelector(".start-time-back");let M=n.querySelector(".start-time-input");var C=n.querySelector(".start-time-forward");x.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a,e=(v.value=t*v.max,t*u);c.currentTime=parseFloat(e)||0}),b.parentElement.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a,e=(v.value=t*v.max,t*u);c.currentTime=parseFloat(e)||0});function F(e){return e<0?e=0:e>u&&(e=u),e>L.value&&(e=L.value),parseFloat(e).toFixed(2)}function q(e){return e<0?e=0:e>u&&(e=u),e<M.value&&(e=M.value),parseFloat(e).toFixed(2)}function T(e,t,a){return Math.abs(e/(a-t)*u).toFixed(2)}function A(e,t,a){return Math.abs(e/u*(a-t)).toFixed(2)}function D(){sendModuleData.sourceFile.startTime=M.value,sendModuleData.sourceFile.endTime=L.value}function _(a,r){r.forEach(e=>{var t=createFaceDetectCrop(a,c.parentElement,r,function(e,t,a,r){sendModuleData.moduleParameters.cropField=[{x:e,y:t,width:a-e,height:r-t}],updateCloseButton(n.querySelector(".close-button"),!0)});t.classList.add("bboxes","absolute","w-full","h-full","object-contain","z-[1]"),n.querySelectorAll(".bboxes").forEach(e=>e.remove()),c.parentElement.appendChild(t)}),loaderModalHidden(d)}function B(e){return Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0")}r?c.parentElement.addEventListener("click",function(){c.paused?i&&c.play():c.pause()}):(c.parentElement.addEventListener("mouseover",function(){i&&c.play().catch(e=>{})}),c.parentElement.addEventListener("mouseout",function(){c.pause()})),p.addEventListener("click",function(){c.muted=!c.muted;var e=c.muted?'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="m14.667 6-4 4m0-4 4 4M7.333 3.333 4 6H1.333v4H4l3.333 2.667V3.333Z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="M10.36 3.64a3.333 3.333 0 0 1 0 4.713m2.353-7.066a6.667 6.667 0 0 1 0 9.426m-5.38-9.38L4 4H1.333v4H4l3.333 2.667V1.333Z"></path></svg>';this.innerHTML=e,c.focus()}),n.querySelector(".reset-button").onclick=function(){M.value=0,L.value=u,M.onchange(),L.onchange(),D()},S.onclick=function(){M.value=F(parseFloat(M.value)-parseFloat(M.step)),g.value=A(parseFloat(M.value),g.min,g.max),g.oninput(),c.currentTime=parseFloat(M.value)||0},M.onchange=function(){this.value=F(parseFloat(this.value)),g.value=A(parseFloat(this.value),g.min,g.max),g.oninput(),c.currentTime=parseFloat(this.value)||0},C.onclick=function(){M.value=F(parseFloat(M.value)+parseFloat(M.step)),g.value=A(parseFloat(M.value),g.min,g.max),g.oninput(),c.currentTime=parseFloat(M.value)||0},k.onclick=function(){L.value=q(parseFloat(L.value)-parseFloat(L.step)),y.value=A(parseFloat(L.value),y.min,y.max),y.oninput(),c.currentTime=parseFloat(L.value)||0},L.onchange=function(){this.value=q(parseFloat(this.value)),y.value=A(parseFloat(this.value),y.min,y.max),y.oninput(),c.currentTime=parseFloat(this.value)||0},E.onclick=function(){L.value=q(parseFloat(L.value)+parseFloat(L.step)),y.value=A(parseFloat(L.value),y.min,y.max),y.oninput(),c.currentTime=parseFloat(L.value)||0},window.addEventListener("resize",function(){var e;e=m.offsetWidth*g.value/(g.max-g.min),b.style.width=e+"px",e=m.offsetWidth-m.offsetWidth*y.value/(y.max-y.min),w.style.width=e+"px"}),g.oninput=function(){parseInt(y.value)-parseInt(g.value)<=f&&(g.value=parseInt(y.value)-f);var e=m.offsetWidth*this.value/(this.max-this.min);b.style.width=e+"px",M.value=T(this.value,this.max,this.min),D()},y.oninput=function(){parseInt(y.value)-parseInt(g.value)<=f&&(y.value=parseInt(g.value)+f);var e=m.offsetWidth-m.offsetWidth*this.value/(this.max-this.min);w.style.width=e+"px",L.value=T(this.value,this.max,this.min),D()},c.addEventListener("loadedmetadata",async function(){this.pause(),this.muted=!0,sendModuleData.sourceFile.naturalWidth=this.videoWidth,sendModuleData.sourceFile.naturalHeight=this.videoHeight,sendModuleData.sourceFile.offsetWidth=this.offsetWidth,sendModuleData.sourceFile.offsetHeight=this.offsetHeight,u=sendModuleData.sourceFile.fileSizeBytes>maxFileSize?maxFileSize/sendModuleData.sourceFile.fileSizeBytes*this.duration:this.duration,sendModuleData.sourceFile.startTime=0;var e=B(sendModuleData.sourceFile.endTime=u);h.textContent="0:00/"+e;{var[e,t=5]=[u];let a=n.querySelector(".timeline-markers"),r=(a.innerHTML="",e/t);e=Array.from({length:6},(e,t)=>B(r*t)),[...new Set(e)].forEach(e=>{var t=document.createElement("div");t.textContent=e,a.appendChild(t)})}await 0,await(async(e,l=10)=>{let i=document.createElement("canvas"),s=document.createElement("video");s.autoplay=!0,s.muted=!0,s.src=e,s.crossOrigin="anonymous",s.onloadeddata=async()=>{var t=i.getContext("2d"),a=(i.width=s.videoWidth,i.height=s.videoHeight,c.offsetWidth/(60/i.height*i.width*10)),r=(s.pause(),s.duration/(l-1));for(let e=0;e<l;e++){var o=e*r;s.currentTime=o,await new Promise(e=>s.onseeked=e),t.clearRect(0,0,i.width,i.height),i.width=s.videoWidth*a,i.height=s.videoHeight;for(let e=0;e<a;e++)t.drawImage(s,e*s.videoWidth,0,s.videoWidth,s.videoHeight);var o=i.toDataURL("image/png"),o=await(await fetch(o)).blob(),o=URL.createObjectURL(o),n=document.createElement("div");n.classList.add("h-14","w-full","opacity-60"),n.style.backgroundSize="auto 100%",n.style.backgroundRepeat="repeat",n.style.backgroundImage=`url(${o})`,m.appendChild(n)}}})(this.src),M.value=0,M.max=u.toFixed(2),L.value=u.toFixed(2),L.max=u.toFixed(2),this.currentTime=parseFloat(M.value)||0,c.addEventListener("seeked",async function e(){var t=document.createElement("canvas"),a=t.getContext("2d"),a=(t.width=c.offsetWidth,t.height=c.offsetHeight,a.drawImage(c,0,0,t.width,t.height),t.toDataURL("image/png")),r=c.parentElement.querySelector("img");r||(r=document.createElement("img")).classList.add("absolute"),c.parentElement.insertBefore(r,c),r.onload=async()=>{try{await detectFacesTool(r,e=>{e&&e.length,_(r,e)})}catch(e){console.error("Failed to detect faces:",e)}},r.src=a,r.width=c.offsetWidth,r.height=c.offsetHeight,c.removeEventListener("seeked",e)},{once:!0});t=Math.min((y.max-y.min)/u,(g.max-g.min)/u);f=t}),c.addEventListener("timeupdate",function(){M.value>this.currentTime&&(this.currentTime=M.value),this.currentTime>L.value&&(this.currentTime=M.value);var e=B(this.currentTime),t=B(u);h.textContent=e+"/"+t,v.value=this.currentTime/u*v.max}),n.querySelector(".close-button").onclick=function(){sendModuleData.sourceFile.urlFile=e,sendModuleData.sourceFile.formatFile="mp4",t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.cropField)&&(0===sendModuleData.moduleParameters.cropField.length?(console.log("Crop field is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("Crop field is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},l.onclick=async function(){i?(async()=>{n.querySelectorAll(".accessible-media-control").forEach(e=>{e.classList.remove("hidden")}),l.classList.remove("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),l.classList.add("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),sendModuleData.sourceFile.startTime!==s?(s=sendModuleData.sourceFile.startTime,2<=c.readyState?(c.currentTime=s,c.addEventListener("seeked",async function e(){var t=document.createElement("canvas"),a=t.getContext("2d"),a=(t.width=c.offsetWidth,t.height=c.offsetHeight,a.drawImage(c,0,0,t.width,t.height),t.toDataURL("image/png")),t=c.parentElement.querySelector("img");c.parentElement.insertBefore(t,c),t.src=a,t.classList.add("absolute"),c.parentElement.insertBefore(t,c),t.width=c.offsetWidth,t.height=c.offsetHeight,c.removeEventListener("seeked",e)},{once:!0})):console.warn("Video is not ready to seek. Ensure it's fully loaded before attempting to capture frames.")):n.querySelectorAll(".bboxes").forEach(e=>{e.classList.remove("hidden")}),c.pause(),c.currentTime=parseFloat(M.value)||0})():(n.querySelectorAll(".accessible-media-control").forEach(e=>{e.classList.add("hidden")}),n.querySelectorAll(".bboxes").forEach(e=>{e.classList.add("hidden")}),l.classList.remove("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),l.classList.add("hover:bg-accent-hover","text-dark-background","bg-accent-primary")),i=!i},document.body.appendChild(o)}async function createModalDetectImage(e,t=null,a){"ontouchstart"in window||navigator.msMaxTouchPoints;var r=document.querySelector(".modal-detect-image-template").content.cloneNode(!0);let o=r.querySelector(".modal-root"),n=o.querySelector(".media-element-field"),l=Math.floor(1e3*Math.random()),i=(o.querySelector(".modal-load-element").setAttribute("data-index",l),o.querySelector(".image"));sendModuleData.moduleParameters.cropField=[],i.onload=async function(){try{await detectFacesTool(this,e=>{var a;e&&0!==e.length||loaderModalWarn("Face is not detected",l),(a=e).forEach(e=>{var t=createFaceDetectCrop(i,n,a,function(e,t,a,r){sendModuleData.moduleParameters.cropField=[{x:e,y:t,width:a-e,height:r-t}],updateCloseButton(o.querySelector(".close-button"),!0)});t.classList.add("bboxes","absolute","w-full","h-full","object-contain","z-[1]"),o.querySelectorAll(".bboxes").forEach(e=>e.remove()),n.appendChild(t)}),loaderModalHidden(l)})}catch(e){console.error("Failed to detect faces:",e)}sendModuleData.sourceFile.naturalWidth=i.naturalWidth,sendModuleData.sourceFile.naturalHeight=i.naturalHeight,sendModuleData.sourceFile.offsetWidth=i.offsetWidth,sendModuleData.sourceFile.offsetHeight=i.offsetHeight};try{i.src=URL.createObjectURL(e)}catch{i.src=e}o.querySelector(".close-button").onclick=function(){sendModuleData.sourceFile.urlFile=e,sendModuleData.sourceFile.formatFile="jpg",t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.cropField)&&(0===sendModuleData.moduleParameters.cropField.length?(console.log("Crop field is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("Crop field is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},document.body.appendChild(r)}function createModalCropperVideo(e,t=null,a){var r="ontouchstart"in window||navigator.msMaxTouchPoints,o=document.querySelector(".modal-cropper-video-template").content.cloneNode(!0);let n=o.querySelector(".modal-root"),l=n.querySelector(".watch-button"),i=!1;let d=n.querySelector(".video");d.setAttribute("crossorigin","anonymous"),d.src=e;let s,c=n.querySelector(".timeline"),u=n.querySelector(".duration");var m=n.querySelector(".sound-button");let h=0,p=n.querySelector(".timeline-range-current"),f=n.querySelector(".timeline-range-left"),v=n.querySelector(".timeline-range-right"),g=document.createElement("div"),y=(g.classList.add("rounded-l-md","h-14","absolute","z-2","left-0","flex-row","flex","bg-dark-elements","opacity-90"),document.createElement("div"));y.classList.add("rounded-r-md","h-14","absolute","z-2","right-0","flex-row","flex","bg-dark-elements","opacity-90"),c.parentElement.appendChild(g),c.parentElement.appendChild(y);var b=document.createElement("div"),w=(b.classList.add("h-14","absolute","z-2","left-0","w-full"),c.parentElement.appendChild(b),n.querySelector(".end-time-back"));let x=n.querySelector(".end-time-input");var k=n.querySelector(".end-time-forward"),L=n.querySelector(".start-time-back");let E=n.querySelector(".start-time-input");var S=n.querySelector(".start-time-forward");b.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a,e=(p.value=t*p.max,t*s);d.currentTime=parseFloat(e)||0}),g.parentElement.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a,e=(p.value=t*p.max,t*s);d.currentTime=parseFloat(e)||0});function M(e){return e<0?e=0:e>s&&(e=s),e>x.value&&(e=x.value),parseFloat(e).toFixed(2)}function C(e){return e<0?e=0:e>s&&(e=s),e<E.value&&(e=E.value),parseFloat(e).toFixed(2)}function F(e,t,a){return Math.abs(e/(a-t)*s).toFixed(2)}function q(e,t,a){return Math.abs(e/s*(a-t)).toFixed(2)}function T(){sendModuleData.sourceFile.startTime=E.value,sendModuleData.sourceFile.endTime=x.value}function A(e){return Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0")}r?d.parentElement.addEventListener("click",function(){d.paused?i&&d.play():d.pause()}):(d.parentElement.addEventListener("mouseover",function(){i&&d.play().catch(e=>{})}),d.parentElement.addEventListener("mouseout",function(){d.pause()})),m.addEventListener("click",function(){d.muted=!d.muted;var e=d.muted?'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="m14.667 6-4 4m0-4 4 4M7.333 3.333 4 6H1.333v4H4l3.333 2.667V3.333Z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="M10.36 3.64a3.333 3.333 0 0 1 0 4.713m2.353-7.066a6.667 6.667 0 0 1 0 9.426m-5.38-9.38L4 4H1.333v4H4l3.333 2.667V1.333Z"></path></svg>';this.innerHTML=e,d.focus()}),n.querySelector(".reset-button").onclick=function(){E.value=0,x.value=s,E.onchange(),x.onchange(),T()},L.onclick=function(){E.value=M(parseFloat(E.value)-parseFloat(E.step)),f.value=q(parseFloat(E.value),f.min,f.max),f.oninput(),d.currentTime=parseFloat(E.value)||0},E.onchange=function(){this.value=M(parseFloat(this.value)),f.value=q(parseFloat(this.value),f.min,f.max),f.oninput(),d.currentTime=parseFloat(this.value)||0},S.onclick=function(){E.value=M(parseFloat(E.value)+parseFloat(E.step)),f.value=q(parseFloat(E.value),f.min,f.max),f.oninput(),d.currentTime=parseFloat(E.value)||0},w.onclick=function(){x.value=C(parseFloat(x.value)-parseFloat(x.step)),v.value=q(parseFloat(x.value),v.min,v.max),v.oninput(),d.currentTime=parseFloat(x.value)||0},x.onchange=function(){this.value=C(parseFloat(this.value)),v.value=q(parseFloat(this.value),v.min,v.max),v.oninput(),d.currentTime=parseFloat(this.value)||0},k.onclick=function(){x.value=C(parseFloat(x.value)+parseFloat(x.step)),v.value=q(parseFloat(x.value),v.min,v.max),v.oninput(),d.currentTime=parseFloat(x.value)||0},window.addEventListener("resize",function(){var e;e=c.offsetWidth*f.value/(f.max-f.min),g.style.width=e+"px",e=c.offsetWidth-c.offsetWidth*v.value/(v.max-v.min),y.style.width=e+"px"}),f.oninput=function(){parseInt(v.value)-parseInt(f.value)<=h&&(f.value=parseInt(v.value)-h);var e=c.offsetWidth*this.value/(this.max-this.min);g.style.width=e+"px",E.value=F(this.value,this.max,this.min),T()},v.oninput=function(){parseInt(v.value)-parseInt(f.value)<=h&&(v.value=parseInt(f.value)+h);var e=c.offsetWidth-c.offsetWidth*this.value/(this.max-this.min);y.style.width=e+"px",x.value=F(this.value,this.max,this.min),T()},d.addEventListener("loadedmetadata",async function(){this.pause(),this.muted=!0,sendModuleData.sourceFile.naturalWidth=this.videoWidth,sendModuleData.sourceFile.naturalHeight=this.videoHeight,sendModuleData.sourceFile.offsetWidth=this.offsetWidth,sendModuleData.sourceFile.offsetHeight=this.offsetHeight,s=sendModuleData.sourceFile.fileSizeBytes>maxFileSize?maxFileSize/sendModuleData.sourceFile.fileSizeBytes*this.duration:this.duration,sendModuleData.sourceFile.startTime=0;var e=A(sendModuleData.sourceFile.endTime=s);u.textContent="0:00/"+e;{var[e,t=5]=[s];let a=n.querySelector(".timeline-markers"),r=(a.innerHTML="",e/t);e=Array.from({length:6},(e,t)=>A(r*t)),[...new Set(e)].forEach(e=>{var t=document.createElement("div");t.textContent=e,a.appendChild(t)})}await 0,await(async(e,l=10)=>{let i=document.createElement("canvas"),s=document.createElement("video");s.autoplay=!0,s.muted=!0,s.src=e,s.crossOrigin="anonymous",s.onloadeddata=async()=>{var t=i.getContext("2d"),a=(i.width=s.videoWidth,i.height=s.videoHeight,d.offsetWidth/(60/i.height*i.width*10)),r=(s.pause(),s.duration/(l-1));for(let e=0;e<l;e++){var o=e*r;s.currentTime=o,await new Promise(e=>s.onseeked=e),t.clearRect(0,0,i.width,i.height),i.width=s.videoWidth*a,i.height=s.videoHeight;for(let e=0;e<a;e++)t.drawImage(s,e*s.videoWidth,0,s.videoWidth,s.videoHeight);var o=i.toDataURL("image/png"),o=await(await fetch(o)).blob(),o=URL.createObjectURL(o),n=document.createElement("div");n.classList.add("h-14","w-full","opacity-60"),n.style.backgroundSize="auto 100%",n.style.backgroundRepeat="repeat",n.style.backgroundImage=`url(${o})`,c.appendChild(n)}}})(this.src),E.value=0,E.max=s.toFixed(2),x.value=s.toFixed(2),x.max=s.toFixed(2),this.currentTime=parseFloat(E.value)||0,d.addEventListener("seeked",async function e(){var t=document.createElement("canvas"),a=t.getContext("2d"),a=(t.width=d.offsetWidth,t.height=d.offsetHeight,a.fillStyle="transparent",a.fillRect(0,0,t.width,t.height),t.toDataURL("image/png")),r=d.parentElement.querySelector("img");r||(r=document.createElement("img")).classList.add("absolute"),d.parentElement.insertBefore(r,d),r.onload=async()=>{void 0!==r.cropper&&r.cropper.destroy();new Cropper(r,{viewMode:2,movable:!0,minCropBoxWidth:40,minCropBoxHeight:40,crop(e){e={x:e.detail.x,y:e.detail.y,width:e.detail.width,height:e.detail.height};sendModuleData.moduleParameters.cropField=[e],d.pause(),d.currentTime=parseFloat(E.value)||0}});updateCloseButton(n.querySelector(".close-button"),!0)},r.src=a,r.width=d.offsetWidth,r.height=d.offsetHeight,d.removeEventListener("seeked",e)},{once:!0});t=Math.min((v.max-v.min)/s,(f.max-f.min)/s);h=t}),d.addEventListener("timeupdate",function(){E.value>this.currentTime&&(this.currentTime=E.value),this.currentTime>x.value&&(this.currentTime=E.value);var e=A(this.currentTime),t=A(s);u.textContent=e+"/"+t,p.value=this.currentTime/s*p.max}),n.querySelector(".close-button").onclick=function(){sendModuleData.sourceFile.urlFile=e,sendModuleData.sourceFile.formatFile="mp4",t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.cropField)&&(0===sendModuleData.moduleParameters.cropField.length?(console.log("Crop field is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("Crop field is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},l.onclick=async function(){i?(async()=>{n.querySelectorAll(".accessible-media-control").forEach(e=>{e.classList.remove("hidden")}),l.classList.remove("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),l.classList.add("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),d.pause(),d.currentTime=parseFloat(E.value)||0})():(n.querySelectorAll(".accessible-media-control").forEach(e=>{e.classList.add("hidden")}),l.classList.remove("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),l.classList.add("hover:bg-accent-hover","text-dark-background","bg-accent-primary")),i=!i},document.body.appendChild(o)}async function createModalCropperImage(e,t=null,a){"ontouchstart"in window||navigator.msMaxTouchPoints;var r=document.querySelector(".modal-cropper-image-template").content.cloneNode(!0),o=r.querySelector(".modal-root");o.querySelector(".media-element-field");let n=o.querySelector(".image");n.onload=function(){var e=new Cropper(n,{viewMode:2,movable:!0,minCropBoxWidth:40,minCropBoxHeight:40,crop(e){e={x:e.detail.x,y:e.detail.y,width:e.detail.width,height:e.detail.height};sendModuleData.moduleParameters.cropField=[e]}});"function"==typeof e.ready&&e.ready.then(function(){}),sendModuleData.sourceFile.naturalWidth=n.naturalWidth,sendModuleData.sourceFile.naturalHeight=n.naturalHeight,sendModuleData.sourceFile.offsetWidth=n.offsetWidth,sendModuleData.sourceFile.offsetHeight=n.offsetHeight},updateCloseButton(o.querySelector(".close-button"),!0);try{n.src=URL.createObjectURL(e)}catch{n.src=e}o.querySelector(".close-button").onclick=function(){sendModuleData.sourceFile.urlFile=e,sendModuleData.sourceFile.formatFile="jpg",t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.cropField)&&(0===sendModuleData.moduleParameters.cropField.length?(console.log("Crop field is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("Crop field is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},document.body.appendChild(r)}async function createModalDetectAvatarImage(t=null,n=null){"ontouchstart"in window||navigator.msMaxTouchPoints;var e=document.querySelector(".modal-avatar-image-template").content.cloneNode(!0);let o=e.querySelector(".modal-root"),r=o.querySelector(".media-element-field"),l=Math.floor(1e3*Math.random()),a=o.querySelector(".modal-load-element");a.setAttribute("data-index",l);var i=o.querySelector("#avatar-input");let s=o.querySelector(".gender-button"),d="male",c=o.querySelector(".age-select"),u=o.querySelector(".desktop-ethnic-select"),m=o.querySelector(".mobile-ethnic-select"),h=o.querySelector(".generate-avatar-button"),p=o.querySelector(".image");async function f(t=null){let a=document.createElement("div");a.classList.add("group");var e=document.createElement("label"),r=(e.classList.add("w-20","h-20","relative","flex","flex-row","text-center","items-center","justify-center","gap-3","cursor-pointer","bg-dark-elements","rounded-[.625rem]","border","border-dashed","border-white","border-opacity-20","py-6"),document.createElement("button")),o=document.createElement("img"),o=(o.src=t,o.classList.add("w-20","h-20","object-cover","rounded-[.625rem]","opacity-60","group-hover:opacity-100"),r.appendChild(o),document.createElement("button")),e=(o.classList.add("rounded-md","flex","items-center","justify-center","transition-colors","font-normal","disabled:cursor-not-allowed","px-1.5","gap-1.5","py-1.5","opacity-0","group-hover:opacity-100","transition-opacity","absolute","top-1","right-1","z-[1]","full-opacity-on-touchscreen","!bg-dark-pop-up","hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements"),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="white"><g><path d="M2.5 4.99996H17.5M15.8333 4.99996V16.6666C15.8333 17.5 15 18.3333 14.1667 18.3333H5.83333C5 18.3333 4.16667 17.5 4.16667 16.6666V4.99996M6.66667 4.99996V3.33329C6.66667 2.49996 7.5 1.66663 8.33333 1.66663H11.6667C12.5 1.66663 13.3333 2.49996 13.3333 3.33329V4.99996M8.33333 9.16663V14.1666M11.6667 9.16663V14.1666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>',e.appendChild(r),e.appendChild(o),a.appendChild(e),h.parentElement),e=e.parentElement;e.parentElement;e.insertAdjacentElement("afterend",a),r.onclick=async function(){var e=await urlToBlob(t);p.src=window.URL.createObjectURL(e)},o.onclick=function(){openDeleteNoticeModal(t,n).then(e=>{!0===e&&a.remove()}).catch(e=>{console.error("Error:",e)})}}sendModuleData.moduleParameters.avatarCropField=[],p.onload=async function(){try{await detectFacesTool(this,e=>{var a;e&&0!==e.length||loaderModalWarn("Face is not detected",l),(a=e).forEach(e=>{var t=createFaceDetectCrop(p,r,a,function(e,t,a,r){sendModuleData.moduleParameters.avatarCropField=[{x:e,y:t,width:a-e,height:r-t}],updateCloseButton(o.querySelector(".close-button"),!0)});t.classList.add("bboxes","absolute","w-full","h-full","object-contain","z-[1]"),o.querySelectorAll(".bboxes").forEach(e=>e.remove()),r.appendChild(t)}),loaderModalHidden(l)})}catch(e){console.error("Failed to detect faces:",e)}sendModuleData.avatarFile.naturalWidth=p.naturalWidth,sendModuleData.avatarFile.naturalHeight=p.naturalHeight,sendModuleData.avatarFile.offsetWidth=p.offsetWidth,sendModuleData.avatarFile.offsetHeight=p.offsetHeight},u.onchange=function(){m.value=this.value},m.onchange=function(){u.value=this.value},s.onclick=function(){"male"===d?(d="female",s.querySelector(".fa-solid.fa-mars").parentElement.classList.add("hidden"),s.querySelector(".fa-solid.fa-venus").parentElement.classList.remove("hidden")):(d="male",s.querySelector(".fa-solid.fa-mars").parentElement.classList.remove("hidden"),s.querySelector(".fa-solid.fa-venus").parentElement.classList.add("hidden"))},h.onclick=async function(){try{var e=await fetch("/generate-avatar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gender:d,age:c.value,ethnic:u.value})});if(!e.ok)throw new Error("Network response was not ok");var t=await e.json();200===t.status&&f(window.location.origin+t.media_file)}catch(e){console.error("There was a problem with the fetch operation:",e)}},(async()=>{try{await new Promise((r,o)=>{fetch("/get-avatars").then(e=>{if(e.ok)return e.json();throw new Error("Network response was not ok")}).then(e=>{if(200===e.status){let t=window.location.origin,a=e.folder_name;e=e.user_avatars.map(async e=>{!1===e.isDirectory&&"image"===getFileFormat(e.name)&&f(`${t}/media/content/${userContentId}/${a}/`+e.name)});Promise.all(e).then(r).catch(o)}}).catch(e=>{console.error("There was a problem with the fetch operation:",e),o(e)})}),console.log("User avatars initialization completed successfully")}catch(e){console.error("Error initializing user avatars:",e)}})(),sendModuleData.avatarFile.urlFile&&(p.src=sendModuleData.avatarFile.urlFile),o.querySelector(".close-button").onclick=function(){var e=o.querySelector(".image");sendModuleData.avatarFile.urlFile=e.src,sendModuleData.avatarFile.formatFile="jpg",t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.avatarCropField)&&(0===sendModuleData.moduleParameters.avatarCropField.length?(console.log("Avatar crop field is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("Avatar crop field is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},i.addEventListener("change",function(e){e=e.target.files;if(0<e.length){a.classList.remove("hidden"),a.querySelector(".loader").classList.remove("loader-info","loader-error");let t=e[0];e=new FileReader;e.onload=async function(e){t.type.startsWith("image")&&(p.src=e.target.result)},e.readAsDataURL(t)}}),document.body.appendChild(e)}async function createModalDetectAvatarVideo(t=null,H){var e="ontouchstart"in window||navigator.msMaxTouchPoints,a=document.querySelector(".modal-avatar-video-template").content.cloneNode(!0);let o=a.querySelector(".modal-root"),r=o.querySelector(".watch-button"),n=!1,l=0,i=Math.floor(1e3*Math.random()),s=o.querySelector(".modal-load-element");s.setAttribute("data-index",i);var d=o.querySelector("#avatar-input");let c=o.querySelector(".video");var u=o.querySelectorAll(".example-avatar-button");let m,h=o.querySelector(".timeline"),p=o.querySelector(".duration");var f=o.querySelector(".sound-button");let v=0,g=o.querySelector(".timeline-range-current"),y=o.querySelector(".timeline-range-left"),b=o.querySelector(".timeline-range-right"),w=document.createElement("div"),x=(w.classList.add("rounded-l-md","h-14","absolute","z-2","left-0","flex-row","flex","bg-dark-elements","opacity-90"),document.createElement("div"));x.classList.add("rounded-r-md","h-14","absolute","z-2","right-0","flex-row","flex","bg-dark-elements","opacity-90"),h.parentElement.appendChild(w),h.parentElement.appendChild(x);var k=document.createElement("div"),L=(k.classList.add("h-14","absolute","z-2","left-0","w-full"),h.parentElement.appendChild(k),o.querySelector(".end-time-back"));let E=o.querySelector(".end-time-input");var S=o.querySelector(".end-time-forward"),M=o.querySelector(".start-time-back");let C=o.querySelector(".start-time-input");var F=o.querySelector(".start-time-forward");function q(e){return e<0?e=0:e>m&&(e=m),e>E.value&&(e=E.value),parseFloat(e).toFixed(2)}function T(e){return e<0?e=0:e>m&&(e=m),e<C.value&&(e=C.value),parseFloat(e).toFixed(2)}function A(e,t,a){return Math.abs(e/(a-t)*m).toFixed(2)}function D(e,t,a){return Math.abs(e/m*(a-t)).toFixed(2)}function _(){sendModuleData.sourceFile.startTime=C.value,sendModuleData.sourceFile.endTime=E.value}function B(e){h.innerHTML="",console.log(e),c.setAttribute("crossorigin","anonymous");try{c.src=URL.createObjectURL(e)}catch{c.src=e}o.querySelectorAll(".accessible-media-control").forEach(e=>{e.remove()})}k.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a,e=(g.value=t*g.max,t*m);c.currentTime=parseFloat(e)||0}),w.parentElement.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a,e=(g.value=t*g.max,t*m);c.currentTime=parseFloat(e)||0}),e?c.parentElement.addEventListener("click",function(){c.paused?n&&c.play():c.pause()}):(c.parentElement.addEventListener("mouseover",function(){n&&c.play().catch(e=>{})}),c.parentElement.addEventListener("mouseout",function(){c.pause()})),f.addEventListener("click",function(){c.muted=!c.muted;var e=c.muted?'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="m14.667 6-4 4m0-4 4 4M7.333 3.333 4 6H1.333v4H4l3.333 2.667V3.333Z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="M10.36 3.64a3.333 3.333 0 0 1 0 4.713m2.353-7.066a6.667 6.667 0 0 1 0 9.426m-5.38-9.38L4 4H1.333v4H4l3.333 2.667V1.333Z"></path></svg>';this.innerHTML=e,c.focus()}),o.querySelector(".reset-button").onclick=function(){C.value=0,E.value=m,C.onchange(),E.onchange(),_()},M.onclick=function(){C.value=q(parseFloat(C.value)-parseFloat(C.step)),y.value=D(parseFloat(C.value),y.min,y.max),y.oninput(),c.currentTime=parseFloat(C.value)||0},C.onchange=function(){this.value=q(parseFloat(this.value)),y.value=D(parseFloat(this.value),y.min,y.max),y.oninput(),c.currentTime=parseFloat(this.value)||0},F.onclick=function(){C.value=q(parseFloat(C.value)+parseFloat(C.step)),y.value=D(parseFloat(C.value),y.min,y.max),y.oninput(),c.currentTime=parseFloat(C.value)||0},L.onclick=function(){E.value=T(parseFloat(E.value)-parseFloat(E.step)),b.value=D(parseFloat(E.value),b.min,b.max),b.oninput(),c.currentTime=parseFloat(E.value)||0},E.onchange=function(){this.value=T(parseFloat(this.value)),b.value=D(parseFloat(this.value),b.min,b.max),b.oninput(),c.currentTime=parseFloat(this.value)||0},S.onclick=function(){E.value=T(parseFloat(E.value)+parseFloat(E.step)),b.value=D(parseFloat(E.value),b.min,b.max),b.oninput(),c.currentTime=parseFloat(E.value)||0},window.addEventListener("resize",function(){var e;e=h.offsetWidth*y.value/(y.max-y.min),w.style.width=e+"px",e=h.offsetWidth-h.offsetWidth*b.value/(b.max-b.min),x.style.width=e+"px"}),y.oninput=function(){parseInt(b.value)-parseInt(y.value)<=v&&(y.value=parseInt(b.value)-v);var e=h.offsetWidth*this.value/(this.max-this.min);w.style.width=e+"px",C.value=A(this.value,this.max,this.min),_()},b.oninput=function(){parseInt(b.value)-parseInt(y.value)<=v&&(b.value=parseInt(y.value)+v);var e=h.offsetWidth-h.offsetWidth*this.value/(this.max-this.min);x.style.width=e+"px",E.value=A(this.value,this.max,this.min),_()};function N(a,r){r.forEach(e=>{var t=createFaceDetectCrop(a,c.parentElement,r,function(e,t,a,r){sendModuleData.moduleParameters.avatarCropField=[{x:e,y:t,width:a-e,height:r-t}],updateCloseButton(o.querySelector(".close-button"),!0)});t.classList.add("bboxes","absolute","w-full","h-full","object-contain","z-[1]"),o.querySelectorAll(".bboxes").forEach(e=>e.remove()),c.parentElement.appendChild(t)}),loaderModalHidden(i)}function U(e){return Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0")}c.addEventListener("loadedmetadata",async function(){this.pause(),this.muted=!0,sendModuleData.avatarFile.naturalWidth=this.videoWidth,sendModuleData.avatarFile.naturalHeight=this.videoHeight,sendModuleData.avatarFile.offsetWidth=this.offsetWidth,sendModuleData.avatarFile.offsetHeight=this.offsetHeight,m=sendModuleData.sourceFile.fileSizeBytes>maxFileSize?maxFileSize/sendModuleData.avatarFile.fileSizeBytes*this.duration||0:this.duration||0,sendModuleData.avatarFile.startTime=0;var e=U(sendModuleData.avatarFile.endTime=m);p.textContent="0:00/"+e;{var[e,t=5]=[m];let a=o.querySelector(".timeline-markers"),r=(a.innerHTML="",e/t);e=Array.from({length:6},(e,t)=>U(r*t)),[...new Set(e)].forEach(e=>{var t=document.createElement("div");t.textContent=e,a.appendChild(t)})}await 0,await(async(e,l=10)=>{let i=document.createElement("canvas"),s=document.createElement("video");s.autoplay=!0,s.muted=!0,s.src=e,s.crossOrigin="anonymous",s.onloadeddata=async()=>{var t=i.getContext("2d"),a=(i.width=s.videoWidth,i.height=s.videoHeight,c.offsetWidth/(60/i.height*i.width*10)),r=(s.pause(),s.duration/(l-1));for(let e=0;e<l;e++){var o=e*r;s.currentTime=o,await new Promise(e=>s.onseeked=e),t.clearRect(0,0,i.width,i.height),i.width=s.videoWidth*a,i.height=s.videoHeight;for(let e=0;e<a;e++)t.drawImage(s,e*s.videoWidth,0,s.videoWidth,s.videoHeight);var o=i.toDataURL("image/png"),o=await(await fetch(o)).blob(),o=URL.createObjectURL(o),n=document.createElement("div");n.classList.add("h-14","w-full","opacity-60"),n.style.backgroundSize="auto 100%",n.style.backgroundRepeat="repeat",n.style.backgroundImage=`url(${o})`,h.appendChild(n)}}})(this.src),C.value=0,C.max=m.toFixed(2),E.value=m.toFixed(2),E.max=m.toFixed(2),this.currentTime=parseFloat(C.value)||0,c.addEventListener("seeked",async function e(){var t=document.createElement("canvas"),a=t.getContext("2d"),a=(t.width=c.offsetWidth,t.height=c.offsetHeight,a.drawImage(c,0,0,t.width,t.height),t.toDataURL("image/png")),r=c.parentElement.querySelector("img");r||(r=document.createElement("img")).classList.add("absolute"),c.parentElement.insertBefore(r,c),r.onload=async()=>{try{await detectFacesTool(r,e=>{e&&e.length,N(r,e)})}catch(e){console.error("Failed to detect faces:",e)}},r.src=a,r.width=c.offsetWidth,r.height=c.offsetHeight,c.removeEventListener("seeked",e)},{once:!0});t=Math.min((b.max-b.min)/m,(y.max-y.min)/m);v=t}),c.addEventListener("timeupdate",function(){C.value>this.currentTime&&(this.currentTime=C.value),this.currentTime>E.value&&(this.currentTime=C.value);var e=U(this.currentTime),t=U(m);p.textContent=e+"/"+t,g.value=this.currentTime/m*g.max}),o.querySelector(".close-button").onclick=function(){var e=o.querySelector(".video");sendModuleData.avatarFile.urlFile=e.src,sendModuleData.avatarFile.formatFile="mp4",t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.avatarCropField)&&(0===sendModuleData.moduleParameters.avatarCropField.length?(console.log("Crop field is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("Crop field is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},u.forEach(e=>{e.onclick=async function(){s.classList.remove("hidden"),s.querySelector(".loader").classList.remove("loader-info","loader-error");var e=generateVideoFilename();let t=this.getElementsByTagName("source")[0].src;(t="string"==typeof t?await urlToBlob(t):t)&&(console.log("download file"),await uploadChunkFile(t,e)),sendModuleData.avatarFile.urlFile="/media/tmp/"+e,setTimeout(()=>{B(sendModuleData.avatarFile.urlFile)},100)}}),sendModuleData.avatarFile.urlFile&&(B(sendModuleData.avatarFile.urlFile),s.classList.add("hidden")),d.addEventListener("change",function(e){e=e.target.files;if(0<e.length){let o=e[0],t=new FileReader;if(o.type.startsWith("video")){let a=0,r=(s.classList.remove("hidden"),s.querySelector(".loader").classList.remove("loader-info","loader-error"),generateVideoFilename());Math.min(maxFileSize,o.size);function n(){var e=Math.min(a+1048576,o.size),e=o.slice(a,e);t.readAsArrayBuffer(e)}t.onload=function(e){let t=e.target.result;uploadArrayBuffer(t,r,function(){(a+=t.byteLength)<o.size?n():(sendModuleData.avatarFile.urlFile="/media/tmp/"+r,sendModuleData.avatarFile.fileSizeBytes=o.size,B(sendModuleData.avatarFile.urlFile),s.classList.add("hidden"))})},t.onerror=function(e){console.error("Error reading file: ",e),s.classList.remove("hidden"),s.querySelector(".loader").classList.remove("loader-info"),s.querySelector(".loader").classList.add("loader-error"),s.querySelector("p").textContent="Error reading file. Please try again."},n()}}}),r.onclick=async function(){n?(async()=>{o.querySelectorAll(".accessible-media-control").forEach(e=>{e.classList.remove("hidden")}),r.classList.remove("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),r.classList.add("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),sendModuleData.sourceFile.startTime!==l?(l=sendModuleData.sourceFile.startTime,2<=c.readyState?(c.currentTime=l,c.addEventListener("seeked",async function e(){var t=document.createElement("canvas"),a=t.getContext("2d"),a=(t.width=c.offsetWidth,t.height=c.offsetHeight,a.drawImage(c,0,0,t.width,t.height),t.toDataURL("image/png")),t=c.parentElement.querySelector("img");c.parentElement.insertBefore(t,c),t.src=a,t.classList.add("absolute"),c.parentElement.insertBefore(t,c),t.width=c.offsetWidth,t.height=c.offsetHeight,c.removeEventListener("seeked",e)},{once:!0})):console.warn("Video is not ready to seek. Ensure it's fully loaded before attempting to capture frames.")):o.querySelectorAll(".bboxes").forEach(e=>{e.classList.remove("hidden")}),c.pause(),c.currentTime=parseFloat(C.value)||0})():(o.querySelectorAll(".accessible-media-control").forEach(e=>{e.classList.add("hidden")}),o.querySelectorAll(".bboxes").forEach(e=>{e.classList.add("hidden")}),r.classList.remove("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),r.classList.add("hover:bg-accent-hover","text-dark-background","bg-accent-primary")),n=!n},document.body.appendChild(a)}function createModalLoadOneAudio(a=null,r=null,e=null){"ontouchstart"in window||navigator.msMaxTouchPoints;var t=document.querySelector(".modal-load-one-audio-template").content.cloneNode(!0),o=t.querySelector(".modal-root");let n=o.querySelector(".modal-message");var l=o.querySelector(".modal-notification"),l=(e&&(l.classList.remove("hidden"),l.innerHTML=e),o.querySelector("#one-audio-input"));let i=l.parentElement,s=o.querySelector(".record-button"),d,c=[],u=Date.now(),m;function h(){var e,t;d&&"recording"===d.state&&(s.classList.remove("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements"),s.classList.add("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),s.innerHTML='<i style="scale: 1.2" class="fa-solid fa-microphone-lines fill-dark-background group-disabled:fill-light-tertiary"></i>Record voice',d.stop(),clearTimeout(m),0<c.length)&&(e=new Blob(c,{type:"audio/wav"}),e=URL.createObjectURL(e),t=(Date.now()-u)/1e3,n.classList.add("hidden"),createModalLoadedOneAudio(e,a,t,r)),d=null}function p(e){if(0<e.length){let t=e[0];e=new FileReader;e.onload=function(e){t.type.startsWith("audio")&&(n.classList.add("hidden"),e=e.target.result.split(",")[1],e=base64ToBlob(e,"audio/wav"),createModalLoadedOneAudio(URL.createObjectURL(e),a,void 0,r))},e.readAsDataURL(t)}else n.classList.remove("hidden"),n.querySelector("span").textContent="Something went wrong. Please, try again."}s.onclick=function(){d&&"recording"===d.state?h():(u=Date.now(),this.classList.remove("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),this.classList.add("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements"),this.innerHTML='<i style="scale: 1.2" class="fa-solid fa-microphone-lines-slash fill-dark-background group-disabled:fill-light-tertiary"></i>Stop record',c=[],navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){(d=new MediaRecorder(e)).ondataavailable=function(e){c.push(e.data)},d.onstop=function(){var e=new Blob(c,{type:"audio/webm"}),e=URL.createObjectURL(e),t=(Date.now()-u)/1e3;console.log("Recording stopped"),n.classList.add("hidden"),createModalLoadedOneAudio(e,a,t,r)},d.start(),console.log("Recording started"),m=setTimeout(h,1e3*maxDurationToShow)}).catch(function(e){console.error("Error accessing microphone:",e)}))},a&&(o.querySelector("h2").querySelector("text").textContent=a),i.addEventListener("dragover",e=>{e.preventDefault(),i.style.opacity="0.6",i.style.outline="2px dotted #414141",i.style.borderRadius="10px",i.style.outlineOffset="5px"}),i.addEventListener("dragleave",e=>{i.style.opacity="",i.style.outline="",i.style.borderRadius="",i.style.outlineOffset=""}),i.addEventListener("drop",e=>{e.preventDefault(),p(e.dataTransfer.files),i.style.opacity="",i.style.outline="",i.style.borderRadius="",i.style.outlineOffset=""}),l.addEventListener("change",function(e){p(e.target.files)}),document.body.appendChild(t)}function createModalLoadedOneAudio(e,t=null,r=null,a=null){"ontouchstart"in window||navigator.msMaxTouchPoints;var o=document.querySelector(".modal-loaded-one-audio-template").content.cloneNode(!0),n=o.querySelector(".modal-root");let l=n.querySelector(".trim-audio-message");var i=n.querySelector(".restart-button"),s=n.querySelector(".attach-button"),d=n.querySelector(".close-button");let c=n.querySelector(".timeline-range-current"),u=n.querySelector(".timeline-range-left"),m=n.querySelector(".timeline-markers-audio-start"),h=n.querySelector(".timeline-range-right"),p=n.querySelector(".timeline-markers-audio-end"),f=document.createElement("div"),v=(f.classList.add("h-full","absolute","z-[2]","left-0","flex-row","flex","bg-dark-elements","opacity-90"),document.createElement("div")),g=(v.classList.add("h-full","absolute","z-[2]","right-0","flex-row","flex","bg-dark-elements","opacity-90"),c.parentElement.appendChild(f),c.parentElement.appendChild(v),10),y,b,w=n.querySelector("audio"),x=(w.src=e,n.querySelector(".audio-control"));function k(e){var t=c.parentElement;let l=20,i=document.createElement("canvas"),a=(i.style.opacity=.5,i.width=t.offsetWidth,i.height=t.offsetHeight-2*l,t.appendChild(i),window.AudioContext=window.AudioContext||window.webkitAudioContext,new AudioContext);let s=(e,t,a,r,o)=>{e.lineWidth=1,e.strokeStyle="#fff",e.fillStyle="#fff",e.beginPath(),a=o?a:-a,a=-Math.abs(a),e.moveTo(t,0),e.lineTo(t,a),e.arc(t+r/2,a,r/2,0,0,o),e.lineTo(t+r,0),e.stroke(),e.fill()};fetch(e).then(e=>e.arrayBuffer()).then(e=>a.decodeAudioData(e)).then(e=>(a=>{const e=window.devicePixelRatio||1,r=(i.width=i.offsetWidth*e,i.height=(i.offsetHeight+l*2)*e,i.getContext("2d")),o=(r.scale(e,e),r.translate(0,i.offsetHeight/2+l),i.offsetWidth/a.length);for(let t=0;t<a.length;t++){const n=o*t;let e=a[t]*i.offsetHeight-l;if(e<0)e=0;else if(e>i.offsetHeight/2)e=e>i.offsetHeight/2;s(r,n,e,o,(t+1)%2)}})((e=>{const t=Math.pow(Math.max(...e),-1);return e.map(e=>e*t)})((e=>{const r=e.getChannelData(0),t=100,o=Math.floor(r.length/t),n=[];for(let e=0;e<t;e++){let t=o*e;let a=0;for(let e=0;e<o;e++)a=a+Math.abs(r[t+e]);n.push(a/o)}return n})(e))))}function L(e,t,a){return Math.abs(e/(a-t)*r).toFixed(2)}function E(e){var t=Math.floor(e/60),e=Math.floor(e%60);return t.toString().padStart(2,"0")+":"+e.toString().padStart(2,"0")}w.addEventListener("timeupdate",function(){var e;y>this.currentTime&&isFinite(y)&&(this.currentTime=y),b<this.currentTime&&isFinite(y)&&(this.currentTime=y),(r||isFinite(w.duration))&&(e=this.currentTime/r*100,c.style.left=e+"%")}),w.onloadedmetadata=function(){y=0,m.textContent="0:00",!r&&isFinite(w.duration)?(b=w.duration,r=w.duration):b=r,r>maxDurationToShow&&(b=maxDurationToShow),p.textContent=E(b),h.value=(a=b,e=h.min,t=h.max,Math.abs(a/r*(t-e)).toFixed(2)),h.oninput(),r>maxDurationToShow&&(l.classList.remove("hidden"),l.querySelector("text").textContent=maxDurationToShow+" seconds");var e,t,a=Math.min((h.max-h.min)/r,(u.max-u.min)/r);g=a,k(w.src),(t=document.createElement("div")).classList.add("h-14","absolute","z-2","left-0","w-full"),c.parentElement.appendChild(t),t.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=(this.offsetWidth,Math.min(e,this.offsetWidth)/this.offsetWidth*100),t=(c.style.left=a+"%",r*a/100);w.currentTime=t})},x.addEventListener("click",function(){w.paused?w.play():w.pause();var e=w.paused?'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="#fff"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.167 2.5 15.832 10 4.166 17.5v-15Z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="#fff"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7.833 3.333H4.5v13.334h3.333V3.333ZM15.5 3.333h-3.333v13.334H15.5V3.333Z"></path></svg>';x.innerHTML=e}),window.addEventListener("resize",function(){var e;e=timeline.offsetWidth*u.value/(u.max-u.min),f.style.width=e+"px",e=timeline.offsetWidth-timeline.offsetWidth*h.value/(h.max-h.min),v.style.width=e+"px"}),u.parentElement.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=(this.offsetWidth,Math.min(e,this.offsetWidth)/this.offsetWidth*100),t=(c.style.left=a+"%",r*a/100);w.currentTime=t}),u.oninput=function(){parseInt(h.value)-parseInt(u.value)<=g&&(u.value=parseInt(h.value)-g);var e=this.parentElement.offsetWidth*this.value/(this.max-this.min),e=(m.style.left=e+"px",this.parentElement.offsetWidth*this.value/(this.max-this.min));f.style.width=e+"px",y=L(this.value,this.max,this.min),isFinite(y)&&(m.textContent=E(y))},h.oninput=function(){parseInt(h.value)-parseInt(u.value)<=g&&(h.value=parseInt(u.value)+g);var e=this.parentElement.offsetWidth-this.parentElement.offsetWidth*this.value/(this.max-this.min),e=(p.style.right=e+"px",this.parentElement.offsetWidth-this.parentElement.offsetWidth*this.value/(this.max-this.min));v.style.width=e+"px",b=L(this.value,this.max,this.min),isFinite(b)&&(p.textContent=E(b))},i.onclick=function(){w.currentTime=y},s.onclick=function(){a&&"function"==typeof a&&a(e,y,b),document.querySelectorAll(".modal-root").forEach(e=>{closeModal(e)})},d.onclick=function(){document.querySelectorAll(".modal-root").forEach(e=>{closeModal(e)})},t&&(n.querySelector("h2").querySelector("text").textContent=t),document.body.appendChild(o)}async function createModalLoadAnalysis(a,r=null){"ontouchstart"in window||navigator.msMaxTouchPoints;var e=document.querySelector(".modal-load-analysis-template").content.cloneNode(!0),t=e.querySelector(".modal-root");let o=t.querySelector(".modal-message");t=t.querySelector(".scan-button");let n=t.parentElement.parentElement,l=async()=>{let e;e=(["jpg","jpeg","png","gif","bmp"].includes(r.toLowerCase())?generateImageFilename:["mp4","avi","mov","wmv","mkv"].includes(r.toLowerCase())?generateVideoFilename:["wav","mp3"].includes(r.toLowerCase())?generateAudioFilename:generateUUID)(),"string"!=typeof a||sendModuleData.sourceFile.urlFile.includes("media")?e=sendModuleData.sourceFile.urlFile.split("/").pop():(a=await urlToBlob(a),uploadChunkFile(a,e));var t={method:analysisModuleName,filename:e};await fetch("/submit-cpu-task",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(t=>{if(200===t.status){let e=t.id;setTimeout(()=>{(async e=>{const a=setInterval(async()=>{await fetch(`/query-cpu-task/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{if(e.status===200){clearInterval(a);if(!e.response){i(getTranslationBabel("Oops! Something went wrong. Please try again."),"error");return}const t=e.response.is_original;if(t===true)i(getTranslationBabel("Heads up: This content is not a deepfake from Wunjo, but it could be a deepfake from another program or even original content. You know, I dont know what I dont know!"),"ok");else i(getTranslationBabel("Yeah! This content appears to be a deepfake created by Wunjo."),"ok")}else if(e.status===300){clearInterval(a);i(e.response.message,"default")}else if(e.status===404){clearInterval(a);i(e.response.message,"error")}}).catch(e=>{console.error("An error occurred:",error);clearInterval(a);i(getTranslationBabel("Oops! An unexpected error occurred. Please try again."),"error")})},3e3)})(e)},1e3)}else i("Something wrong..."+t.message,"error")}).catch(e=>{i("Something wrong...During create task.","error")})};function i(e,t="default"){n.classList.add("hidden"),o.setAttribute("status",t),o.setAttribute("value",e)}t.onclick=async function(){var e,t,a;n.innerHTML="",sendModuleData.sourceFile.naturalHeight<256||sendModuleData.sourceFile.naturalWidth<256?i(getTranslationBabel("Content too small, should be larger than 256x256"),"error"):((e=document.createElement("div")).classList.add("flex","items-center","gap-2","p-2.5","relative","w-full","h-10","bg-dark-elements","rounded-[.625rem]","overflow-hidden"),(t=document.createElement("div")).classList.add("absolute","w-full","h-full","left-0","top-0","bg-gradient-to-r","from-[rgba(255,237,210,0.20)]","to-accent-primary","opacity-10"),t.style.background="linear-gradient(to right, rgba(255, 237, 210, 0.2), rgb(255, 237, 210))",(a=document.createElement("p")).classList.add("text-m-mobile","md:text-m","grow"),a.textContent="Scanning...",(scanLoadingDivBackground=document.createElement("div")).classList.add("absolute","h-full","w-full","left-0","top-0","animate-loadingStripe"),scanLoadingDivBackground.style.background="repeating-linear-gradient(-45deg, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0) 16px, rgba(0, 0, 0, 0.08) 16px, rgba(0, 0, 0, 0.08) 32px) 0% 0% / 200% 200%",e.appendChild(t),e.innerHTML+='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none" class="animate-loadingRing mx-auto stroke-accent-primary"><path d="M17.5 10C17.5 14.1421 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 5.85786 5.85786 2.5 10 2.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>',e.appendChild(a),e.appendChild(scanLoadingDivBackground),n.appendChild(e),await l())},document.body.appendChild(e)}async function createModalUpdate(){var e=document.querySelector(".modal-update-template").content.cloneNode(!0),a=e.querySelector(".modal-root").querySelector("h2");function r(e){return e.split(".").map(e=>parseInt(e,10))}function o(t,a){for(let e=0;e<t.length;e++){if(a[e]>t[e])return!0;if(a[e]<t[e])return!1}return!1}var s=JSON.parse(serverVersionData);if(0!==Object.keys(s).length&&s.hasOwnProperty("version")){var n=s.version;let t=r(document.querySelector(".version").getAttribute("vers"));if(o(t,r(n))){let n=s.history,l=Object.keys(n).filter(e=>o(t,r(e))).sort((e,t)=>{e=r(e);return r(t).join(".")-e.join(".")}),i=document.createElement("div");l.forEach((e,a)=>{let r=document.createElement("p"),o=(r.classList.add("max-h-[500px]","flex","gap-2.5","text-m-mobile","md:tex-m","p-2.5","bg-dark-background","bg-opacity-30","rounded-md"),r.style.overflowY="auto",r.innerHTML='<svg class="shrink-0 opacity-60" width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" stroke="white" stroke-width="1.5"/><path d="M10.125 8.875C10.125 7.83947 10.9645 7 12 7C13.0355 7 13.875 7.83947 13.875 8.875C13.875 9.56245 13.505 10.1635 12.9534 10.4899C12.478 10.7711 12 11.1977 12 11.75V13" stroke="white" stroke-width="1.5" stroke-linecap="round"/><circle cx="12" cy="16" r="1" fill="white"/></svg>',document.createElement("span"));o.classList.add("flex","flex-col");var t=document.createElement("strong");t.textContent=e,o.appendChild(t),n[e].forEach(e=>{var t=document.createElement("text");t.classList.add("text-light-secondary","my-1"),t.textContent=e,o.appendChild(t)}),r.appendChild(o),a!==l.length-1&&r.classList.add("hidden"),i.appendChild(r),r.addEventListener("click",()=>{let e=a-1;e<0&&(e=l.length-1);var t=i.children[e];r.classList.add("hidden"),t&&t.classList.remove("hidden")})}),a.after(i)}}document.body.appendChild(e)}function createModalMessage(e){var t=document.querySelector(".modal-message-template").content.cloneNode(!0);t.querySelector(".modal-root").querySelector(".message").textContent=e,document.body.appendChild(t)}function createModalInvalidPathMessage(){var e=document.querySelector(".modal-invalid-path-template").content.cloneNode(!0);document.body.appendChild(e)}function handleLoader({msg:e=null,index:t=null,type:a=null,isBar:r=null}){var o,n=r?".loader-bar":".loader-circle",t=t?document.querySelector(n+`[data-index="${t}"]`)||document.querySelector(`.modal-load-element[data-index="${t}"]`):document.querySelector(n)||document.querySelector(".modal-load-element");t&&(n=t.querySelector(".loader"),(o=t.querySelector("p"))&&e&&(o.textContent=e),a?t.classList.remove("hidden"):t.classList.add("hidden"),n)&&!r&&(n.classList.remove("loader-warn","loader-error","loader-info"),a)&&n.classList.add("loader-"+a)}function loaderModalHidden(e=null,t=null){handleLoader({type:null,index:e,isBar:t})}function loaderModalBusy(e,t=null,a=null){handleLoader({msg:e,index:t,type:"busy",isBar:a})}function loaderModalInfo(e,t=null,a=null){handleLoader({msg:e,index:t,type:"info",isBar:a})}function loaderModalWarn(e,t=null,a=null){handleLoader({msg:e,index:t,type:"warn",isBar:a})}function loaderModalError(e,t=null,a=null){handleLoader({msg:e,index:t,type:"error",isBar:a})}async function createModalLiteSetting(e=null,h=null,t=4096){var a=document.querySelector(".modal-lite-setting-template").content.cloneNode(!0);let r=a.querySelector(".modal-root");var o=r.querySelector(".modal-root-name"),n=r.querySelector(".modal-parameters"),l=r.querySelector(".submit-setting"),i=document.querySelector(".system-processor")||null,s=r.querySelector(".settings-processor"),p=(i?("GPU"===(i=i.textContent.trim())?(s.classList.add("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),s.classList.remove("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements")):(s.classList.remove("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),s.classList.add("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements")),s.textContent=""+i):s.remove(),e&&(o.textContent=e),null),f=null;try{var d=await fetch("/system-resources");if(!d.ok)throw new Error("Failed to fetch system resources");if(200!==(p=await d.json()).status)return void(window.location.href="/settings")}catch(e){return console.error("Error fetching system resources:",e.message),void(window.location.href="/settings")}try{var c=await fetch("/get-init-config");if(!c.ok)throw new Error("Failed to fetch init config");if(200!==(f=await c.json()).status)return void(window.location.href="/settings")}catch(e){return console.error("Error fetching config:",e.message),void(window.location.href="/settings")}let v={CPU_MAX_QUEUE_ALL_USER:f.all_parameters.CPU_MAX_QUEUE_ALL_USER,MODULE_MAX_QUEUE_ALL_USER:f.all_parameters.MODULE_MAX_QUEUE_ALL_USER,CPU_MAX_QUEUE_ONE_USER:f.all_parameters.CPU_MAX_QUEUE_ONE_USER,MODULE_MAX_QUEUE_ONE_USER:f.all_parameters.MODULE_MAX_QUEUE_ONE_USER,CPU_QUEUE_CANCEL_TIME_MIN:f.all_parameters.CPU_QUEUE_CANCEL_TIME_MIN,MODULE_QUEUE_CANCEL_TIME_MIN:f.all_parameters.MODULE_QUEUE_CANCEL_TIME_MIN,["MAX_DURATION_SEC_"+h]:f.all_parameters["MAX_DURATION_SEC_"+h],["MAX_NUMBER_SYNBOLS_"+h]:f.all_parameters["MAX_NUMBER_SYNBOLS_"+h],["MAX_RESOLUTION_"+h]:f.all_parameters["MAX_RESOLUTION_"+h],[`MIN_VRAM_${h}_GB`]:f.all_parameters[`MIN_VRAM_${h}_GB`],[`MIN_RAM_${h}_GB`]:f.all_parameters[`MIN_RAM_${h}_GB`]};function g(e=null,t=null){var a=document.createElement("div"),r=(a.classList.add("gap-2.5","grid","flex-col"),a.style.overflowX="auto",a.style.overflowY="auto",a.style.maxHeight="60vh",document.createElement("div")),o=(r.classList.add("flex","flex-col","gap-5","overflow-auto","transition-[height_max-height]","pr-2","gap-2.5","text-m-mobile","md:text-m","p-2.5","bg-opacity-30","rounded-md","text-s"),r.style.maxHeight="calc(933px - var(--navbar-height) - 60px)",document.createElement("div")),n=(o.classList.add("flex","gap-3","items-center","justify-between"),document.createElement("p")),e=(n.classList.add("flex","flex-row","font-extra-thick","text-accent-primary","question","group"),n.innerHTML=e,document.createElement("div"));return a.appendChild(r),r.appendChild(o),r.appendChild(e),o.appendChild(n),t instanceof HTMLElement&&e.appendChild(t),a}function u(e=null,t=0,a=0,r=1,o=1,n=null){var l=document.createElement("div"),i=(l.style.overflowX="auto",l.style.overflowY="auto",l.style.maxHeight="60vh",l.className="gap-2.5 grid flex-col",document.createElement("div")),s=(i.className="flex flex-col gap-5 overflow-auto transition-[height_max-height] pr-2 gap-2.5 text-m-mobile md:text-m p-2.5 bg-opacity-30 rounded-md text-s",i.style.maxHeight="calc(933px - var(--navbar-height) - 60px)",document.createElement("div")),d=document.createElement("div"),c=(d.className="mb-4 flex gap-3 items-center justify-between",document.createElement("p"));c.className="font-extra-thick text-accent-primary question group",c.innerHTML=e;let u=document.createElement("input");u.className="px-2 py-1.5 rounded-md bg-dark-elements w-9 box-content text-center outline-none",u.type="number",u.value=t,u.min=a,u.max=r,u.step=o,d.appendChild(c),d.appendChild(u);e=document.createElement("div"),e.className="flex gap-4 items-center text-m-mobile lg:text-m",c=document.createElement("span");c.className="opacity-60",c.textContent=a;let m=document.createElement("input");m.className="relative slider flex-1 appearance-none h-1 bg-light-border rounded-md outline-none after:absolute after:left-0 after:top-0 after:h-1 after:rounded-md after:bg-accent-primary after:w-[var(--fill-size)] after:z-0",m.type="range",m.min=a,m.max=r,m.step=o,m.value=t,m.style.setProperty("--fill-size",Math.ceil((t-a)/(r-a)*100)+"%");o=document.createElement("span");return o.className="opacity-60",o.textContent=r,u.addEventListener("change",function(){var e=this.value,t=Math.ceil((e-m.min)/(m.max-m.min)*100);m.value=e,m.style.setProperty("--fill-size",t+"%"),"function"==typeof n&&n(e)}),m.addEventListener("input",function(){var e=this.value,t=Math.ceil((e-this.min)/(this.max-this.min)*100);u.value=e,this.style.setProperty("--fill-size",t+"%"),"function"==typeof n&&n(e)}),e.appendChild(c),e.appendChild(m),e.appendChild(o),s.appendChild(d),s.appendChild(e),i.appendChild(s),l.appendChild(i),l}function m(){let o=p.total_ram.toFixed(2),n=p.total_vram.toFixed(2),l=p.available_ram.toFixed(2),i=p.available_vram.toFixed(2);let s=document.createElement("div"),d=(s.classList.add("grid-cols-3","gap-5","grid"),s.style.maxHeight="6.9rem",document.createElement("div")),c=(d.classList.add("group","flex","flex-col","justify-center","items-center","text-center"),document.createElement("button"));c.classList.add("fill-white","w-full","flex-col","rounded-md","flex","items-center","justify-center","transition-colors","font-normal","disabled:cursor-not-allowed","px-2.5","gap-1","py-2.5","basis-1/3","flex-1","hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-elements"),c.type="button";var e=[`<div class="flex items-center"><svg width="11" height="16" viewBox="0 0 11 16" fill="none" xmlns="http://www.w3.org/2000/svg" color="white" class=""><path fill-rule="evenodd" clip-rule="evenodd" d="M6.92851 0.727609C6.92859 0.567738 6.87693 0.412296 6.78152 0.285327C6.6861 0.158358 6.55226 0.0669382 6.40069 0.0252099C6.24911 -0.0165185 6.08826 -0.00623016 5.943 0.0544834C5.79775 0.115197 5.6762 0.222952 5.59714 0.361081L0.59735 9.08795C0.53401 9.19847 0.500431 9.32405 0.500004 9.45201C0.499577 9.57997 0.532318 9.70578 0.59492 9.81673C0.657523 9.92769 0.74777 10.0199 0.85655 10.0839C0.96533 10.148 1.08879 10.1818 1.21447 10.1817H4.07149V15.2724C4.07141 15.4323 4.12307 15.5877 4.21848 15.7147C4.3139 15.8416 4.44774 15.9331 4.59931 15.9748C4.75089 16.0165 4.91174 16.0062 5.057 15.9455C5.20225 15.8848 5.32381 15.777 5.40286 15.6389L10.4027 6.91205C10.466 6.80153 10.4996 6.67595 10.5 6.54799C10.5004 6.42003 10.4677 6.29422 10.4051 6.18327C10.3425 6.07231 10.2522 5.98014 10.1434 5.91605C10.0347 5.85197 9.91121 5.81824 9.78553 5.81828H6.92851V0.727609Z" fill="white" fill-opacity="0.75"></path></svg></div><text class="w-[5.625rem]" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${getTranslationBabel("Minimum")}</text>`,`<div class="flex items-center"><svg style="margin-left: -5px; margin-right: -5px;" width="11" height="16" viewBox="0 0 11 16" fill="none" xmlns="http://www.w3.org/2000/svg" color="white" class=""><path fill-rule="evenodd" clip-rule="evenodd" d="M6.92851 0.727609C6.92859 0.567738 6.87693 0.412296 6.78152 0.285327C6.6861 0.158358 6.55226 0.0669382 6.40069 0.0252099C6.24911 -0.0165185 6.08826 -0.00623016 5.943 0.0544834C5.79775 0.115197 5.6762 0.222952 5.59714 0.361081L0.59735 9.08795C0.53401 9.19847 0.500431 9.32405 0.500004 9.45201C0.499577 9.57997 0.532318 9.70578 0.59492 9.81673C0.657523 9.92769 0.74777 10.0199 0.85655 10.0839C0.96533 10.148 1.08879 10.1818 1.21447 10.1817H4.07149V15.2724C4.07141 15.4323 4.12307 15.5877 4.21848 15.7147C4.3139 15.8416 4.44774 15.9331 4.59931 15.9748C4.75089 16.0165 4.91174 16.0062 5.057 15.9455C5.20225 15.8848 5.32381 15.777 5.40286 15.6389L10.4027 6.91205C10.466 6.80153 10.4996 6.67595 10.5 6.54799C10.5004 6.42003 10.4677 6.29422 10.4051 6.18327C10.3425 6.07231 10.2522 5.98014 10.1434 5.91605C10.0347 5.85197 9.91121 5.81824 9.78553 5.81828H6.92851V0.727609Z" fill="white" fill-opacity="0.5"></path></svg><svg width="11" height="16" viewBox="0 0 11 16" fill="none" xmlns="http://www.w3.org/2000/svg" color="white" class=""><path fill-rule="evenodd" clip-rule="evenodd" d="M6.92851 0.727609C6.92859 0.567738 6.87693 0.412296 6.78152 0.285327C6.6861 0.158358 6.55226 0.0669382 6.40069 0.0252099C6.24911 -0.0165185 6.08826 -0.00623016 5.943 0.0544834C5.79775 0.115197 5.6762 0.222952 5.59714 0.361081L0.59735 9.08795C0.53401 9.19847 0.500431 9.32405 0.500004 9.45201C0.499577 9.57997 0.532318 9.70578 0.59492 9.81673C0.657523 9.92769 0.74777 10.0199 0.85655 10.0839C0.96533 10.148 1.08879 10.1818 1.21447 10.1817H4.07149V15.2724C4.07141 15.4323 4.12307 15.5877 4.21848 15.7147C4.3139 15.8416 4.44774 15.9331 4.59931 15.9748C4.75089 16.0165 4.91174 16.0062 5.057 15.9455C5.20225 15.8848 5.32381 15.777 5.40286 15.6389L10.4027 6.91205C10.466 6.80153 10.4996 6.67595 10.5 6.54799C10.5004 6.42003 10.4677 6.29422 10.4051 6.18327C10.3425 6.07231 10.2522 5.98014 10.1434 5.91605C10.0347 5.85197 9.91121 5.81824 9.78553 5.81828H6.92851V0.727609Z" fill="white" fill-opacity="0.75"></path></svg></div><text class="w-[5.625rem]" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${getTranslationBabel("Medium")}</text>`,`<div class="flex items-center"><svg width="11" height="16" viewBox="0 0 11 16" fill="none" xmlns="http://www.w3.org/2000/svg" color="grey" class=""><path fill-rule="evenodd" clip-rule="evenodd" d="M6.92851 0.727609C6.92859 0.567738 6.87693 0.412296 6.78152 0.285327C6.6861 0.158358 6.55226 0.0669382 6.40069 0.0252099C6.24911 -0.0165185 6.08826 -0.00623016 5.943 0.0544834C5.79775 0.115197 5.6762 0.222952 5.59714 0.361081L0.59735 9.08795C0.53401 9.19847 0.500431 9.32405 0.500004 9.45201C0.499577 9.57997 0.532318 9.70578 0.59492 9.81673C0.657523 9.92769 0.74777 10.0199 0.85655 10.0839C0.96533 10.148 1.08879 10.1818 1.21447 10.1817H4.07149V15.2724C4.07141 15.4323 4.12307 15.5877 4.21848 15.7147C4.3139 15.8416 4.44774 15.9331 4.59931 15.9748C4.75089 16.0165 4.91174 16.0062 5.057 15.9455C5.20225 15.8848 5.32381 15.777 5.40286 15.6389L10.4027 6.91205C10.466 6.80153 10.4996 6.67595 10.5 6.54799C10.5004 6.42003 10.4677 6.29422 10.4051 6.18327C10.3425 6.07231 10.2522 5.98014 10.1434 5.91605C10.0347 5.85197 9.91121 5.81824 9.78553 5.81828H6.92851V0.727609Z" fill="#FFFFFF" fill-opacity="0.15"></path></svg><svg style="margin-left: -5px; margin-right: -5px;" width="11" height="16" viewBox="0 0 11 16" fill="none" xmlns="http://www.w3.org/2000/svg" color="white" class=""><path fill-rule="evenodd" clip-rule="evenodd" d="M6.92851 0.727609C6.92859 0.567738 6.87693 0.412296 6.78152 0.285327C6.6861 0.158358 6.55226 0.0669382 6.40069 0.0252099C6.24911 -0.0165185 6.08826 -0.00623016 5.943 0.0544834C5.79775 0.115197 5.6762 0.222952 5.59714 0.361081L0.59735 9.08795C0.53401 9.19847 0.500431 9.32405 0.500004 9.45201C0.499577 9.57997 0.532318 9.70578 0.59492 9.81673C0.657523 9.92769 0.74777 10.0199 0.85655 10.0839C0.96533 10.148 1.08879 10.1818 1.21447 10.1817H4.07149V15.2724C4.07141 15.4323 4.12307 15.5877 4.21848 15.7147C4.3139 15.8416 4.44774 15.9331 4.59931 15.9748C4.75089 16.0165 4.91174 16.0062 5.057 15.9455C5.20225 15.8848 5.32381 15.777 5.40286 15.6389L10.4027 6.91205C10.466 6.80153 10.4996 6.67595 10.5 6.54799C10.5004 6.42003 10.4677 6.29422 10.4051 6.18327C10.3425 6.07231 10.2522 5.98014 10.1434 5.91605C10.0347 5.85197 9.91121 5.81824 9.78553 5.81828H6.92851V0.727609Z" fill="white" fill-opacity="0.5"></path></svg><svg width="11" height="16" viewBox="0 0 11 16" fill="none" xmlns="http://www.w3.org/2000/svg" color="white" class=""><path fill-rule="evenodd" clip-rule="evenodd" d="M6.92851 0.727609C6.92859 0.567738 6.87693 0.412296 6.78152 0.285327C6.6861 0.158358 6.55226 0.0669382 6.40069 0.0252099C6.24911 -0.0165185 6.08826 -0.00623016 5.943 0.0544834C5.79775 0.115197 5.6762 0.222952 5.59714 0.361081L0.59735 9.08795C0.53401 9.19847 0.500431 9.32405 0.500004 9.45201C0.499577 9.57997 0.532318 9.70578 0.59492 9.81673C0.657523 9.92769 0.74777 10.0199 0.85655 10.0839C0.96533 10.148 1.08879 10.1818 1.21447 10.1817H4.07149V15.2724C4.07141 15.4323 4.12307 15.5877 4.21848 15.7147C4.3139 15.8416 4.44774 15.9331 4.59931 15.9748C4.75089 16.0165 4.91174 16.0062 5.057 15.9455C5.20225 15.8848 5.32381 15.777 5.40286 15.6389L10.4027 6.91205C10.466 6.80153 10.4996 6.67595 10.5 6.54799C10.5004 6.42003 10.4677 6.29422 10.4051 6.18327C10.3425 6.07231 10.2522 5.98014 10.1434 5.91605C10.0347 5.85197 9.91121 5.81824 9.78553 5.81828H6.92851V0.727609Z" fill="white" fill-opacity="0.75"></path></svg></div><text class="w-[5.625rem]" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${getTranslationBabel("Maximum")}</text>`];let u=f.all_parameters[`MIN_VRAM_${h}_GB`],m=f.all_parameters[`MIN_RAM_${h}_GB`];return e.forEach((e,r)=>{var t=d.cloneNode(!0),a=c.cloneNode(!0);a.innerHTML=e,a.onclick=function(){var e,t=s.getElementsByTagName("button");for(let e=0;e<t.length;e++){t[e].classList.remove("!bg-accent-primary","!text-dark-background","fill-black"),t[e].classList.add("!bg-dark-elements","fill-white");var a=t[e].querySelector("div");t[e]===this?a.style.filter="invert(100%)":a.style.filter=""}this.classList.add("!bg-accent-primary","!text-dark-background","fill-black"),this.classList.remove("!bg-dark-elements","fill-white"),0===(e=r)?(v[`MIN_VRAM_${h}_GB`]=.8*n,v[`MIN_RAM_${h}_GB`]=.7*o):1===e?(v[`MIN_VRAM_${h}_GB`]=.6*n,v[`MIN_RAM_${h}_GB`]=.5*o):(v[`MIN_VRAM_${h}_GB`]=Math.min(.3*n,.9*i),v[`MIN_RAM_${h}_GB`]=Math.min(.2*o,.8*l))},((u+m)/2>=(.8*n+.7*o)/2&&0===r||(u+m)/2>=(.3*n+.2*o)/2&&(u+m)/2<(.8*n+.7*o)/2&&1===r||(u+m)/2<(.3*n+.2*o)/2&&2===r)&&(a.classList.add("!bg-accent-primary","!text-dark-background","fill-black"),a.classList.remove("!bg-dark-elements","fill-white"),a.querySelector("div").style.filter="invert(100%)"),s.appendChild(t),t.appendChild(a)}),g(`${getTranslationBabel("Power usage?")}<div class="bg-dark-pop-up bg-opacity-50 backdrop-blur-2xl absolute bottom-full -translate-y-1 left-1/2 -translate-x-1/2 lg:text-s text-s-mobile px-1.5 py-1 rounded-md after:absolute after:top-full after:left-1/2 after:-translate-x-1/2 after:border-t-[5px] after:border-x-[3px] after:border-x-transparent after:border-t-dark-elements hidden hidden-on-touchscreen group-hover:block whitespace-nowrap">${getTranslationBabel("Choose your RAM and VRAM power levels. Go big for multitasking magic or play it safe with minimal memory usage.")}</div>`,s)}n.appendChild((()=>{let o=document.createElement("div"),n=(o.classList.add("grid-cols-3","gap-5","grid"),o.style.maxHeight="6.9rem",document.createElement("div")),l=(n.classList.add("group","flex","flex-col","justify-center","items-center","text-center"),document.createElement("button"));l.classList.add("fill-white","w-full","flex-col","rounded-md","flex","items-center","justify-center","transition-colors","font-normal","disabled:cursor-not-allowed","px-2.5","gap-1","py-2.5","basis-1/3","flex-1","hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-elements"),l.type="button";var e=[`<svg viewBox="0 0 20 20" width="20px" height="20px"><g><path d=" M 16.504 15.474 C 16.646 15.676 16.664 15.941 16.55 16.16 C 16.436 16.38 16.21 16.518 15.962 16.518 L 4.038 16.518 C 3.79 16.518 3.564 16.38 3.45 16.161 C 3.336 15.941 3.354 15.676 3.496 15.474 C 4.426 14.154 5.736 13.148 7.251 12.589 C 5.426 11.377 4.611 9.112 5.244 7.015 C 5.877 4.917 7.809 3.482 10 3.482 C 12.191 3.482 14.123 4.917 14.757 7.015 C 15.39 9.112 14.574 11.377 12.749 12.589 C 14.264 13.148 15.574 14.154 16.504 15.474 L 16.504 15.474 Z "/></g></svg><text class="w-[5.625rem]" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${getTranslationBabel("Just me!")}</text>`,`<svg width="20px" height="20px" viewBox="0 0 256 256" id="Flat" xmlns="http://www.w3.org/2000/svg"><path d="M166.5415,192.78516a7.99991,7.99991,0,0,1-6.54052,12.606l-144.0044.00537a8.0002,8.0002,0,0,1-6.542-12.60546,96.21448,96.21448,0,0,1,45.34753-34.84351,60.00007,60.00007,0,1,1,66.39661,0A96.21491,96.21491,0,0,1,166.5415,192.78516Zm81.522,0a96.214,96.214,0,0,0-45.34327-34.83765A60.00088,60.00088,0,0,0,153.24707,50.23535a8,8,0,0,0-4.251,12.47852,75.83151,75.83151,0,0,1,3.84082,84.88623,8,8,0,0,0,2.04493,10.60107,113.20643,113.20643,0,0,1,8.74365,7.2146c.14429.15674.28979.31275.44873.46021a112.03418,112.03418,0,0,1,25.479,34.90527,7.99971,7.99971,0,0,0,7.24951,4.61523l44.72071-.00537a8.0001,8.0001,0,0,0,6.54-12.606Z"/></svg><text class="w-[5.625rem]" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${getTranslationBabel("A small group")}</text>`,`<svg width="20px" height="20px" viewBox="0 0 256 256" id="Flat" xmlns="http://www.w3.org/2000/svg"><path d="M25.60059,115.19336A67.8103,67.8103,0,0,1,53.0293,93.51074a40,40,0,1,1,53.9414,0A67.30469,67.30469,0,0,1,128,107.81421a67.29094,67.29094,0,0,1,21.0293-14.30347,40,40,0,1,1,53.9414,0,67.81009,67.81009,0,0,1,27.42676,21.68067,7.99981,7.99981,0,1,1-12.79248,9.60937,52.0088,52.0088,0,0,0-83.21143.00195c-.01318.01758-.0288.032-.042.04932a7.86941,7.86941,0,0,1-.5166.60791c-.05957.064-.1206.12476-.18213.18628q-.21019.20983-.43847.406c-.08838.07666-.17725.15185-.26807.22387-.04785.03784-.09082.07959-.13965.11646-.09131.06836-.1875.12524-.28076.18921-.10156.07007-.20166.14184-.30615.20654-.16358.10181-.33155.19238-.5.281-.084.04419-.165.0935-.25.13452a7.94481,7.94481,0,0,1-1.62012.57348c-.08057.01905-.16211.0315-.24365.0481-.19434.03979-.38916.07544-.58545.10034-.11035.01416-.22071.02295-.33106.03272-.16552.01416-.33056.02417-.49609.02807-.06738.00171-.13477.01148-.20215.01148-.0459,0-.09082-.00977-.13623-.01075a8.03172,8.03172,0,0,1-1.03027-.08081c-.09424-.01391-.187-.03637-.28076-.05371a7.99507,7.99507,0,0,1-.83692-.2019c-.09424-.02832-.18945-.05078-.2832-.08276a8.00518,8.00518,0,0,1-.96045-.40381c-.09326-.04615-.18555-.09375-.27783-.14405a7.8885,7.8885,0,0,1-.92823-.58471c-.021-.01538-.04443-.02539-.06494-.041-.1167-.0874-.22168-.18408-.332-.27637-.064-.0542-.13037-.10473-.19287-.16088-.166-.1482-.32129-.304-.47266-.4629-.02636-.02807-.05468-.054-.08056-.08251a7.99527,7.99527,0,0,1-.61231-.74,52.00276,52.00276,0,0,0-83.1084.13085,8,8,0,1,1-12.793-9.60937ZM202.9707,197.51074a40,40,0,1,0-53.9414,0A67.29094,67.29094,0,0,0,128,211.81421a67.30469,67.30469,0,0,0-21.0293-14.30347,40,40,0,1,0-53.9414,0,67.8103,67.8103,0,0,0-27.42871,21.68262,8,8,0,0,0,6.39648,12.80469l95.97266-.002.02734.002,96.00439-.002a7.9996,7.9996,0,0,0,6.396-12.80468A67.81009,67.81009,0,0,0,202.9707,197.51074Z"/></svg><text class="w-[5.625rem]" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${getTranslationBabel("Bring all!")}</text>`];let i=f.all_parameters.MODULE_MAX_QUEUE_ALL_USER;return e.forEach((e,a)=>{var t=n.cloneNode(!0),r=l.cloneNode(!0);r.innerHTML=e,r.onclick=function(){var e,t=o.getElementsByTagName("button");for(let e=0;e<t.length;e++)t[e].classList.remove("!bg-accent-primary","!text-dark-background","fill-black"),t[e].classList.add("!bg-dark-elements","fill-white");this.classList.add("!bg-accent-primary","!text-dark-background","fill-black"),this.classList.remove("!bg-dark-elements","fill-white"),0===(e=a)?(v.CPU_MAX_QUEUE_ALL_USER=2,v.MODULE_MAX_QUEUE_ALL_USER=1,v.CPU_MAX_QUEUE_ONE_USER=2,v.MODULE_MAX_QUEUE_ONE_USER=1,v.CPU_QUEUE_CANCEL_TIME_MIN=5,v.MODULE_QUEUE_CANCEL_TIME_MIN=10):1===e?(v.CPU_MAX_QUEUE_ALL_USER=6,v.MODULE_MAX_QUEUE_ALL_USER=3,v.CPU_MAX_QUEUE_ONE_USER=3,v.MODULE_MAX_QUEUE_ONE_USER=2,v.CPU_QUEUE_CANCEL_TIME_MIN=10,v.MODULE_QUEUE_CANCEL_TIME_MIN=20):(v.CPU_MAX_QUEUE_ALL_USER=200,v.MODULE_MAX_QUEUE_ALL_USER=100,v.CPU_MAX_QUEUE_ONE_USER=10,v.MODULE_MAX_QUEUE_ONE_USER=5,v.CPU_QUEUE_CANCEL_TIME_MIN=25,v.MODULE_QUEUE_CANCEL_TIME_MIN=60)},(1===i&&0===a||1<i&&i<=3&&1===a||3<i&&i<=100&&2===a)&&(r.classList.add("!bg-accent-primary","!text-dark-background","fill-black"),r.classList.remove("!bg-dark-elements","fill-white")),o.appendChild(t),t.appendChild(r)}),g(`${getTranslationBabel("How many users are there?")}<div class="bg-dark-pop-up bg-opacity-50 backdrop-blur-2xl absolute bottom-full -translate-y-1 left-1/2 -translate-x-1/2 lg:text-s text-s-mobile px-1.5 py-1 rounded-md after:absolute after:top-full after:left-1/2 after:-translate-x-1/2 after:border-t-[5px] after:border-x-[3px] after:border-x-transparent after:border-t-dark-elements hidden hidden-on-touchscreen group-hover:block whitespace-nowrap">${getTranslationBabel("Pick your user squad! This sets how many tasks can strut their stuff simultaneously for everyone.")}</div>`,o)})()),f.all_parameters["MAX_RESOLUTION_"+h]&&n.appendChild((()=>{let o=document.createElement("div"),n=(o.classList.add("gap-5","grid","grid-cols-5","gap-1","justify-between"),o.style.maxHeight="6.9rem",document.createElement("div")),l=(n.classList.add("group","w-full","flex","flex-col","justify-center","items-center","text-center"),document.createElement("button")),i=(l.classList.add("fill-white","w-full","flex-col","rounded-md","flex","items-center","justify-center","transition-colors","font-normal","disabled:cursor-not-allowed","px-2.5","gap-1","py-2.5","basis-1/3","flex-1","hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-elements"),l.type="button",f.all_parameters["MAX_RESOLUTION_"+h]||null);return[320,480,512,640,720,768,1080,1280,1920,4096].filter(e=>e<=t).forEach((e,t)=>{var a=n.cloneNode(!0),r=l.cloneNode(!0);r.innerHTML=e,r.onclick=function(){var t=o.getElementsByTagName("button");for(let e=0;e<t.length;e++)t[e].classList.remove("!bg-accent-primary","!text-dark-background","fill-black"),t[e].classList.add("!bg-dark-elements","fill-white");this.classList.add("!bg-accent-primary","!text-dark-background","fill-black"),this.classList.remove("!bg-dark-elements","fill-white"),v["MAX_RESOLUTION_"+h]=e},i===e&&(r.classList.add("!bg-accent-primary","!text-dark-background","fill-black"),r.classList.remove("!bg-dark-elements","fill-white")),o.appendChild(a),a.appendChild(r)}),g(`${getTranslationBabel("What is resolution?")}<div class="bg-dark-pop-up bg-opacity-50 backdrop-blur-2xl absolute bottom-full -translate-y-1 left-1/2 -translate-x-1/2 lg:text-s text-s-mobile px-1.5 py-1 rounded-md after:absolute after:top-full after:left-1/2 after:-translate-x-1/2 after:border-t-[5px] after:border-x-[3px] after:border-x-transparent after:border-t-dark-elements hidden hidden-on-touchscreen group-hover:block whitespace-nowrap">${getTranslationBabel("Dial in the max length of your contents long side. Bigger isnt always better, but it sure does look good!")}</div>`,o)})()),f.all_parameters["MAX_DURATION_SEC_"+h]&&n.appendChild((i=f.all_parameters["MAX_DURATION_SEC_"+h]/60||.1,u(`${getTranslationBabel("What is the duration? (in minutes)")}<div class="bg-dark-pop-up bg-opacity-50 backdrop-blur-2xl absolute bottom-full -translate-y-1 left-1/2 -translate-x-1/2 lg:text-s text-s-mobile px-1.5 py-1 rounded-md after:absolute after:top-full after:left-1/2 after:-translate-x-1/2 after:border-t-[5px] after:border-x-[3px] after:border-x-transparent after:border-t-dark-elements hidden hidden-on-touchscreen group-hover:block whitespace-nowrap">${getTranslationBabel("Set the limit for your content duraton. Anything longer gets the chopno one likes an endless show!")}</div>`,i,.1,1440,.1,function(e){v["MAX_DURATION_SEC_"+h]=60*e}))),f.all_parameters["MAX_NUMBER_SYNBOLS_"+h]&&n.appendChild((s=f.all_parameters["MAX_NUMBER_SYNBOLS_"+h]||1e3,u(`${getTranslationBabel("What is the text length? (characters)")}<div class="bg-dark-pop-up bg-opacity-50 backdrop-blur-2xl absolute bottom-full -translate-y-1 left-1/2 -translate-x-1/2 lg:text-s text-s-mobile px-1.5 py-1 rounded-md after:absolute after:top-full after:left-1/2 after:-translate-x-1/2 after:border-t-[5px] after:border-x-[3px] after:border-x-transparent after:border-t-dark-elements hidden hidden-on-touchscreen group-hover:block whitespace-nowrap">${getTranslationBabel("Define the max character count for your text.")}</div>`,s,1e3,1e5,500,function(e){v["MAX_NUMBER_SYNBOLS_"+h]=e}))),(f.all_parameters[`MIN_VRAM_${h}_GB`]||f.all_parameters[`MIN_RAM_${h}_GB`])&&n.appendChild(m()),l.onclick=async function(){await createConnection(async function(){try{var e=await fetch("/set-init-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(!e.ok)throw new Error("Failed to set new init parameters");200===(await e.json()).status&&r.remove()}catch(e){console.error("Error setting new init parameters:",e.message)}},null,!1,!1)},document.body.appendChild(a)}async function createModalCacheFolderSetting(){var e=document.querySelector(".modal-cache-folder-setting-template").content.cloneNode(!0),t=e.querySelector(".modal-root");let n=t.querySelector(".load"),l=t.querySelector(".modal-message"),i=t.querySelector(".input-cache-folder"),s=t.querySelector(".submit-cache-folder");s.addEventListener("click",async function(e){if(e.preventDefault(),i.value.trim()){var t,a;i.parentElement.classList.remove("border","border-danger-primary"),i.parentElement.classList.add("hidden"),n.classList.remove("hidden"),s.disabled=!0,e=getTranslationBabel("Transferring models may take some time. Do not close the software."),l.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" stroke="#fff" fill="#fff" class="shrink-0"><g clip-path="url(#a)"><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.6" stroke-width="1.5" d="M10 6.666V10m0 3.333h.008M18.333 10a8.333 8.333 0 1 0-16.667 0 8.333 8.333 0 0 0 16.667 0Z"></path></g><defs><clipPath id="a"><path stroke="none" d="M0 0h20v20H0z"></path></clipPath></defs></svg><span>${e}</span>`,l.classList.remove("bg-danger-primary","bg-accent-primary"),l.classList.add("bg-dark-background");try{var r=await fetch("/set-home",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({home:i.value})});if(!r.ok)throw new Error("Failed to set port");var o=await r.json();console.log(o.status),200===o.status?(a=o.message,l.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" stroke="#fff" fill="#fff" class="shrink-0"><g clip-path="url(#a)"><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.6" stroke-width="1.5" d="M10 6.666V10m0 3.333h.008M18.333 10a8.333 8.333 0 1 0-16.667 0 8.333 8.333 0 0 0 16.667 0Z"></path></g><defs><clipPath id="a"><path stroke="none" d="M0 0h20v20H0z"></path></clipPath></defs></svg><span>${a}</span>`,l.classList.remove("bg-dark-background","bg-danger-primary"),l.classList.add("bg-accent-primary"),setTimeout(()=>{fetch("/profile",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({exit:"true"})}).then(e=>{if(!e.ok)throw new Error("Network response was not ok");console.log("Post successful")}).catch(e=>{console.error("Error:",e)})},5e3),window.close()):(t=o.message,l.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" stroke="#fff" fill="#fff" class="shrink-0"><g clip-path="url(#a)"><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.6" stroke-width="1.5" d="M10 6.666V10m0 3.333h.008M18.333 10a8.333 8.333 0 1 0-16.667 0 8.333 8.333 0 0 0 16.667 0Z"></path></g><defs><clipPath id="a"><path stroke="none" d="M0 0h20v20H0z"></path></clipPath></defs></svg><span>${t}</span>`,l.classList.remove("bg-dark-background","bg-accent-primary"),l.classList.add("bg-danger-primary"),i.parentElement.classList.remove("hidden"),n.classList.add("hidden"),s.disabled=!1)}catch(e){console.error("Error setting port:",e.message)}}else i.parentElement.classList.add("border","border-danger-primary")}),document.body.appendChild(e)}