function createFooterFile(p=null,m=null){var e=document.querySelector(".footer-block"),t=document.querySelector(".footer-file-template").content.cloneNode(!0);const o=t.querySelector(".footer-root"),h=o.querySelector(".footer-notification"),a=o.querySelector(".footer-submit"),f=o.querySelector(".footer-input-root"),i=o.querySelector(".footer-input");var n=i.querySelector("label"),s=document.createElement("div"),l=(s.classList.add("relative"),document.createElement("i")),r=(l.classList.add("fa-solid","fa-paperclip"),l.style.scale="1.3",document.createElement("span")),d=(r.classList.add("max-md:hidden"),r.style.textWrap="nowrap",document.createElement("input"));function v(){a.disabled=!1,a.classList.remove("bg-light-emphasis","hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","fill-white","opacity-20"),a.classList.add("!text-light-tertiary","hover:bg-accent-hover","text-dark-background","bg-accent-primary","fill-black","transition-colors","transition-opacity")}if(d.classList.add("hidden"),d.type="file",d.id="file-input",m&&Array.isArray(m)){if(m.includes("text")&&p&&"function"==typeof p.setTextareaCallback&&(c=p.setTextareaCallback(),Array.isArray(c)?c.forEach(e=>{e instanceof HTMLElement&&i.appendChild(e)}):c instanceof HTMLElement&&i.appendChild(c),v()),["video","image","audio"].some(e=>m.includes(e))){const S={image:"image/png,image/jpeg",video:".mov,.mp4",audio:".wav,.mp3"};var c=m.map(e=>S[e]).filter(Boolean).join(",");r.textContent=m.filter(e=>!e.toLowerCase().includes("text")).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" or "),d.accept=c,m&&m.includes("text")&&((c=document.createElement("div")).classList.add("z-30","bg-dark-pop-up","bg-opacity-50","backdrop-blur-2xl","absolute","bottom-full","-translate-y-1","left-1/2","-translate-x-1/2","lg:text-s","text-s-mobile","px-1.5","py-1","rounded-md","after:absolute","after:top-full","after:left-1/2","after:-translate-x-1/2","after:border-t-[5px]","after:border-x-[3px]","after:border-x-transparent","after:border-t-dark-elements","hidden","hidden-on-touchscreen","group-hover:block","whitespace-nowrap"),c.textContent="Input "+r.textContent.toLowerCase(),r.classList.add("hidden"),s.appendChild(c)),s.appendChild(l),n.appendChild(s),n.appendChild(r),n.appendChild(d)}}else v();const u=o.querySelector(".footer-parameters");function y(e=!0){var t=o.querySelector(".footer-meta-button").querySelector("button"),a=t.querySelector(".description-button").querySelector("div");!0===e?(t.classList.add("opacity-20"),t.classList.remove("hover:opacity-100"),t.classList.remove("opacity-60"),t.disabled=e,a.classList.add("opacity-0")):(t.classList.remove("opacity-20"),t.classList.add("hover:opacity-100"),t.classList.add("opacity-60"),t.disabled=e,a.classList.remove("opacity-0"))}function g(e=!0){var t=o.querySelector(".footer-motion-button").querySelector("button"),a=t.querySelector(".description-button").querySelector("div");!0===e?(t.classList.add("opacity-20"),t.classList.remove("hover:opacity-100"),t.classList.remove("opacity-60"),t.disabled=e,a.classList.add("opacity-0")):(t.classList.remove("opacity-20"),t.classList.add("hover:opacity-100"),t.classList.add("opacity-60"),t.disabled=e,a.classList.remove("opacity-0"))}if(p){if(p.toggleModificationCallback&&([c=null]=[p.toggleModificationCallback],"function"==typeof c)&&((l=o.querySelector(".footer-toggle")).classList.remove("hidden"),c(l)),p.setMetaButtonCallback){{var[C=null]=[p.setMetaButtonCallback];s=o.querySelector(".footer-meta-button");s.classList.remove("hidden");const q=s.querySelector("button"),T=(q.disabled=!1,q.querySelector(".description-button")),E=T.querySelector("div");function L(e){var t=u.querySelector(".footer-parameters-close");(u.contains(e.target)||q.contains(e.target))&&!t.contains(e.target)||(T.appendChild(E),q.querySelector("span").classList.remove("opacity-100"),q.querySelector("span").classList.add("opacity-0"),u.classList.add("hidden"),document.removeEventListener("click",L),u.querySelector("div").innerHTML="")}q.onclick=function(){E.remove(),q.querySelector("span").classList.remove("opacity-0"),q.querySelector("span").classList.add("opacity-100"),u.classList.remove("hidden"),validCallback(C),setTimeout(()=>{document.addEventListener("click",L)},100)}}y(!0)}if(p.setMotionButtonCallback){{var[A=null]=[p.setMotionButtonCallback];r=o.querySelector(".footer-motion-button");r.classList.remove("hidden");const F=r.querySelector("button"),H=F.querySelector(".description-button"),B=H.querySelector("div");function b(e){var t=u.querySelector(".footer-parameters-close");(u.contains(e.target)||F.contains(e.target))&&!t.contains(e.target)||(H.appendChild(B),F.querySelector("span").classList.remove("opacity-100"),F.querySelector("span").classList.add("opacity-0"),u.classList.add("hidden"),document.removeEventListener("click",b),u.querySelector("div").innerHTML="")}F.onclick=function(){B.remove(),F.querySelector("span").classList.remove("opacity-0"),F.querySelector("span").classList.add("opacity-100"),u.classList.remove("hidden"),validCallback(A),setTimeout(()=>{document.addEventListener("click",b)},100)}}g(!0)}if(p.setParametersButtonCallback){var[V=null]=[p.setParametersButtonCallback];n=o.querySelector(".footer-parameters-button");n.classList.remove("hidden");const D=n.querySelector("button"),W=(D.disabled=!1,D.querySelector(".description-button")),j=W.querySelector("div");function x(e){var t=u.querySelector(".footer-parameters-close");(u.contains(e.target)||D.contains(e.target))&&!t.contains(e.target)||(W.appendChild(j),D.querySelector("span").classList.remove("opacity-100"),D.querySelector("span").classList.add("opacity-0"),u.classList.add("hidden"),document.removeEventListener("click",x),u.querySelector("div").innerHTML="")}D.onclick=function(){j.remove(),D.querySelector("span").classList.remove("opacity-0"),D.querySelector("span").classList.add("opacity-100"),u.classList.remove("hidden"),validCallback(V),setTimeout(()=>{document.addEventListener("click",x)},100)}}}function k(e){return Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0")}function w(e){if(0<e.length){const u=e[0];let c;if(u.size>maxFileSize)f.classList.add("hidden"),f.innerHTML="",h.textContent=`${getTranslationBabel("Wow, that’s a large file! Please upload a file that’s less than")} ${maxFileSize} `+getTranslationBabel("bytes or change settings limit."),h.classList.remove("hidden");else if(u.type.startsWith("image")&&m.includes("image")?c=generateImageFilename():u.type.startsWith("video")&&m.includes("video")?c=generateVideoFilename():u.type.startsWith("audio")&&m.includes("audio")&&(c=generateAudioFilename()),c){10485760<u.size&&(f.innerHTML=`<div class="h-full w-full flex animate-loadingStripe" style="justify-content: left;background: repeating-linear-gradient(-45deg, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0) 16px, rgba(0, 0, 0, 0.08) 16px, rgba(0, 0, 0, 0.08) 32px) 0% 0% / 200% 200%;"><div class="flex gap-3 items-center overflow-hidden"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none" class="animate-loadingRing mx-auto stroke-accent-primary"><path d="M17.5 10C17.5 14.1421 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 5.85786 5.85786 2.5 10 2.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg><p class="text-m-mobile lg:text-m opacity-60 leading-8">${getTranslationBabel("Loading")}...</p></div></div>`,f.classList.remove("hidden"));{var o=u;var i=c;var t=1048576;var n=function(){console.log("Finished reading the file in chunks."),h.textContent="",h.classList.add("hidden"),sendModuleData.sourceFile.nameFile=c,sendModuleData.sourceFile.urlFile="/media/tmp/"+c,sendModuleData.sourceFile.fileSizeBytes=u.size;var e=document.createElement("div");e.classList.add("flex","gap-3","items-center","overflow-hidden");const t=document.createElement("span"),a=(t.classList.add("text-m-mobile","lg:text-m","opacity-60","leading-8"),document.createElement("span")),o=(a.classList.add("text-m-mobile","lg:text-m","opacity-60","leading-8"),document.createElement("div"));if(o.classList.add("flex","gap-3","items-center","basis-full","flex-wrap"),u.type.startsWith("image")&&m.includes("image")){const s=document.createElement("img");s.alt="Preview",s.classList.add("footer-preview","w-8","h-8","rounded-[.625rem]","object-cover"),s.src=sendModuleData.sourceFile.urlFile,s.onload=function(){t.textContent=s.naturalWidth+"x"+s.naturalHeight,sendModuleData.sourceFile.naturalWidth=s.naturalWidth,sendModuleData.sourceFile.naturalHeight=s.naturalHeight},e.appendChild(s),sendModuleData.sourceFile.formatFile="jpg",p&&(p.setMetaButtonCallback&&y(!1),p.setMotionButtonCallback&&g(!0),"function"==typeof p.setModuleImgButtonsCallback)&&(i=p.setModuleImgButtonsCallback(),Array.isArray(i)?i.forEach(e=>{e instanceof HTMLElement&&o.appendChild(e)}):i instanceof HTMLElement&&o.appendChild(i)),v()}else if(u.type.startsWith("video")&&m.includes("video")){const l=document.createElement("video");l.classList.add("footer-preview","w-8","h-8","rounded-[.625rem]","object-cover"),l.crossOrigin="anonymous",l.playsInline=!0,e.appendChild(l),l.src=sendModuleData.sourceFile.urlFile,l.addEventListener("loadedmetadata",function(){maxDurationToShow&&l.duration>maxDurationToShow?(f.classList.add("hidden"),f.innerHTML="",h.textContent=`${getTranslationBabel("Wow, that’s a lengthy video! Please upload a video that’s less than")} ${maxDurationToShow} `+getTranslationBabel("seconds long or change settings limit."),h.classList.remove("hidden")):(t.textContent=l.videoWidth+"x"+l.videoHeight,sendModuleData.sourceFile.naturalWidth=l.videoWidth,sendModuleData.sourceFile.naturalHeight=l.videoHeight)}),sendModuleData.sourceFile.formatFile="mp4",p&&(p.setMetaButtonCallback&&y(!1),p.setMotionButtonCallback&&g(!1),"function"==typeof p.setModuleVideoButtonsCallback)&&(i=p.setModuleVideoButtonsCallback(),Array.isArray(i)?i.forEach(e=>{e instanceof HTMLElement&&o.appendChild(e)}):i instanceof HTMLElement&&o.appendChild(i)),v()}else if(u.type.startsWith("audio")&&m.includes("audio")){const r=document.createElement("button"),d=(r.type="button",r.alt="Preview",r.classList.add("footer-preview","w-8","h-8","rounded-[.625rem]","object-cover","flex","items-center","justify-center"),r.innerHTML='<svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="scale: 0.8;"><path d="M14.3187 2.50498C13.0514 2.35716 11.8489 3.10033 11.4144 4.29989C11.3165 4.57023 11.2821 4.86251 11.266 5.16888C11.2539 5.40001 11.2509 5.67552 11.2503 6L11.25 6.45499C11.25 6.4598 11.25 6.4646 11.25 6.46938V14.5359C10.4003 13.7384 9.25721 13.25 8 13.25C5.37665 13.25 3.25 15.3766 3.25 18C3.25 20.6234 5.37665 22.75 8 22.75C10.6234 22.75 12.75 20.6234 12.75 18V9.21059C12.8548 9.26646 12.9683 9.32316 13.0927 9.38527L15.8002 10.739C16.2185 10.9481 16.5589 11.1183 16.8378 11.2399C17.119 11.3625 17.3958 11.4625 17.6814 11.4958C18.9486 11.6436 20.1511 10.9004 20.5856 9.70089C20.6836 9.43055 20.7179 9.13826 20.7341 8.83189C20.75 8.52806 20.75 8.14752 20.75 7.67988L20.7501 7.59705C20.7502 7.2493 20.7503 6.97726 20.701 6.71946C20.574 6.05585 20.2071 5.46223 19.6704 5.05185C19.4618 4.89242 19.2185 4.77088 18.9074 4.6155L16.1999 3.26179C15.7816 3.05264 15.4412 2.88244 15.1623 2.76086C14.8811 2.63826 14.6043 2.53829 14.3187 2.50498Z" fill="" style="fill: #adadad;"></path></svg>',r.style.border="1px solid #dddddd",r.style.backgroundColor="#161616",e.appendChild(r),sendModuleData.sourceFile.formatFile="wav",document.createElement("audio"));d.src=URL.createObjectURL(u),d.addEventListener("loadedmetadata",function(){var e=d.duration;maxDurationToShow&&e>maxDurationToShow&&(f.classList.add("hidden"),f.innerHTML="",h.textContent=`${getTranslationBabel("Wow, that’s a lengthy audio! Please upload an audio that’s less than")} ${maxDurationToShow} `+getTranslationBabel("seconds long. Let’s keep it short!"),h.classList.remove("hidden")),a.textContent="0:00/"+k(d.duration),sendModuleData.sourceFile.startTime=0,sendModuleData.sourceFile.endTime=d.duration,r.onclick=function(){d.paused?(d.play(),r.innerHTML='<svg style="scale: 0.8" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="#fff"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7.833 3.333H4.5v13.334h3.333V3.333ZM15.5 3.333h-3.333v13.334H15.5V3.333Z"></path></svg>'):(d.pause(),r.innerHTML='<svg style="scale: 0.8" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="#fff"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.167 2.5 15.832 10 4.166 17.5v-15Z"></path></svg>')},d.addEventListener("ended",function(){r.innerHTML='<svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="scale: 0.8;"><path d="M14.3187 2.50498C13.0514 2.35716 11.8489 3.10033 11.4144 4.29989C11.3165 4.57023 11.2821 4.86251 11.266 5.16888C11.2539 5.40001 11.2509 5.67552 11.2503 6L11.25 6.45499C11.25 6.4598 11.25 6.4646 11.25 6.46938V14.5359C10.4003 13.7384 9.25721 13.25 8 13.25C5.37665 13.25 3.25 15.3766 3.25 18C3.25 20.6234 5.37665 22.75 8 22.75C10.6234 22.75 12.75 20.6234 12.75 18V9.21059C12.8548 9.26646 12.9683 9.32316 13.0927 9.38527L15.8002 10.739C16.2185 10.9481 16.5589 11.1183 16.8378 11.2399C17.119 11.3625 17.3958 11.4625 17.6814 11.4958C18.9486 11.6436 20.1511 10.9004 20.5856 9.70089C20.6836 9.43055 20.7179 9.13826 20.7341 8.83189C20.75 8.52806 20.75 8.14752 20.75 7.67988L20.7501 7.59705C20.7502 7.2493 20.7503 6.97726 20.701 6.71946C20.574 6.05585 20.2071 5.46223 19.6704 5.05185C19.4618 4.89242 19.2185 4.77088 18.9074 4.6155L16.1999 3.26179C15.7816 3.05264 15.4412 2.88244 15.1623 2.76086C14.8811 2.63826 14.6043 2.53829 14.3187 2.50498Z" fill="" style="fill: #adadad;"></path></svg>'}),d.addEventListener("timeupdate",function(){var e=k(d.currentTime),t=k(d.duration);a.textContent=e+"/"+t}),v()}),p&&(p.setMetaButtonCallback&&y(!1),"function"==typeof p.setModuleAudioButtonsCallback)&&(i=p.setModuleAudioButtonsCallback(),Array.isArray(i)?i.forEach(e=>{e instanceof HTMLElement&&o.appendChild(e)}):i instanceof HTMLElement&&o.appendChild(i))}var i=document.createElement("div"),n=(i.classList.add("ml-auto","flex","gap-3.5","items-center","p-1","h-8"),document.createElement("button"));n.type="button",n.classList.add("opacity-60","hover:opacity-100","transition-opacity"),n.innerHTML='<svg width="21px" height="21px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 6H20M16 6L15.7294 5.18807C15.4671 4.40125 15.3359 4.00784 15.0927 3.71698C14.8779 3.46013 14.6021 3.26132 14.2905 3.13878C13.9376 3 13.523 3 12.6936 3H11.3064C10.477 3 10.0624 3 9.70951 3.13878C9.39792 3.26132 9.12208 3.46013 8.90729 3.71698C8.66405 4.00784 8.53292 4.40125 8.27064 5.18807L8 6M18 6V16.2C18 17.8802 18 18.7202 17.673 19.362C17.3854 19.9265 16.9265 20.3854 16.362 20.673C15.7202 21 14.8802 21 13.2 21H10.8C9.11984 21 8.27976 21 7.63803 20.673C7.07354 20.3854 6.6146 19.9265 6.32698 19.362C6 18.7202 6 17.8802 6 16.2V6M14 10V17M10 10V17" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',n.onclick=function(){f.classList.add("hidden"),f.innerHTML="",h.textContent="",h.classList.add("hidden"),p&&p.setClearCallback&&"function"==typeof p.setClearCallback&&p.setClearCallback()},f.innerHTML="",(m.includes("image")||m.includes("video"))&&e.appendChild(t),m.includes("audio")&&e.appendChild(a),u.type.startsWith("image")||u.type.startsWith("image")?(t.classList.remove("hidden"),a.classList.add("hidden")):u.type.startsWith("audio")&&(t.classList.add("hidden"),a.classList.remove("hidden")),f.appendChild(e),i.appendChild(n),f.appendChild(i),0<o.childElementCount&&f.appendChild(o),f.classList.remove("hidden")};let a=0;const l=new FileReader;Math.min(maxFileSize,o.size);function s(){var e=Math.min(a+t,o.size),e=o.slice(a,e);l.readAsArrayBuffer(e)}l.onload=function(e){const t=e.target.result;uploadArrayBuffer(t,i,function(){((a+=t.byteLength)<o.size?s:n)()})},l.onerror=function(e){console.error("Error reading file: ",e),h.textContent=getTranslationBabel("Error reading file. Please try again."),h.classList.remove("hidden")},s()}event&&event.target&&(event.target.value="")}}}m&&d.addEventListener("change",function(e){w(e.target.files)});const M=new URLSearchParams(window.location.search).get("attachment");M&&m?fetch(M).then(e=>e.blob()).then(e=>{var t=M.split(".").pop().toLowerCase();let a;"application/octet-stream"!==(a=!m.includes("image")||"jpg"!==t&&"jpeg"!==t&&"png"!==t&&"gif"!==t?!m.includes("video")||"mp4"!==t&&"mov"!==t?!m.includes("audio")||"wav"!==t&&"mp3"!==t?"application/octet-stream":"audio":"video/mp4":"image/jpeg")&&w([new File([e],"filename",{type:a})])}).catch(e=>{console.error("Error fetching attachment:",e)}):console.log("No attachment URL found in query parameters"),a.onclick=function(){this.querySelector("svg").style.animation="paperClickForward 1.5s forwards",p&&p.fetchSendModuleDataCallback&&p.fetchSendModuleDataCallback().then(({statusBool:e,validMessage:t})=>{1==e?(h.textContent=t,h.classList.add("hidden"),this.innerHTML+='<i class="fa-solid fa-check absolute text-dark-background" style="animation: paperFadeInOut 3s forwards;"></i>'):(h.textContent=t,h.classList.remove("hidden"),this.innerHTML+='<i class="fa-solid fa-ban absolute text-dark-background" style="animation: paperFadeInOut 3s forwards;"></i>')}).catch(e=>{console.error(e),h.textContent=e,h.classList.remove("hidden"),this.innerHTML+='<i class="fa-solid fa-ban absolute text-dark-background" style="animation: paperFadeInOut 3s forwards;"></i>'}),setTimeout(()=>{this.querySelector("svg").style.animation="paperClickDisappear 2s forwards";var e=this.querySelector("i");e&&e.remove()},2500),setTimeout(()=>{this.querySelector("svg").style.animation=""},5e3)},o.addEventListener("dragover",e=>{e.preventDefault(),o.style.opacity="0.6",o.style.outline="2px dotted #414141",o.style.borderRadius="10px",o.style.outlineOffset="5px"}),o.addEventListener("dragleave",e=>{o.style.opacity="",o.style.outline="",o.style.borderRadius="",o.style.outlineOffset=""}),o.addEventListener("drop",e=>{e.preventDefault(),w(e.dataTransfer.files),o.style.opacity="",o.style.outline="",o.style.borderRadius="",o.style.outlineOffset=""}),e.appendChild(t)}