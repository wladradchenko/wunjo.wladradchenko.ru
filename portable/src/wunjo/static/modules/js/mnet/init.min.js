import{detectFaces}from"./detect.min.js";const detectFacesInitTool=async(e,t)=>{try{t(await detectFaces(e))}catch(e){console.error("Failed to detect faces:",e)}},createFaceDetectCropTool=(x,g,e,m=null)=>{const B=document.createElement("div"),y=[];return e&&0<e.length?e.forEach(e=>{const[t,o,a,c]=e.rect;var e=x.naturalWidth,n=x.naturalHeight,s=x.offsetWidth,i=x.offsetHeight,r=a-t,l=c-o,e=s/e,n=i/n,d=r*e,f=l*n,h=t*e,p=o*n;const u=document.createElement("button");u.style=`
            width: ${d}px;
            height: ${f}px;
            transform: translateX(${h}px) translateY(${p}px);
            position: absolute;
        `,u.classList.add("detect-face"),u.innerHTML='<i class="fa-solid fa-xmark"></i>',centerBoundingBox(u,g,s,i),u.onclick=()=>handleBoundingBoxClick(u,t,o,a,c,m),y.push({element:u,x1:t,y1:o,x2:a,y2:c,scaleX:e,scaleY:n,cropWidth:r,cropHeight:l}),B.appendChild(u)}):console.log("No bounding boxes found."),window.addEventListener("resize",()=>resizeBoundingBoxes(y,x)),B};function centerBoundingBox(e,t,o,a){o=(t.offsetWidth-o)/2,t=(t.offsetHeight-a)/2;e.style.transform+=` translateX(${o}px) translateY(${t}px)`}function handleBoundingBoxClick(e,t,o,a,c,n){e.parentElement.querySelectorAll("button").forEach(e=>{e.style.background="",e.innerHTML='<i class="fa-solid fa-xmark"></i>',e.classList.remove("selected-face"),e.classList.add("detect-face")}),e.classList.add("selected-face"),e.classList.remove("detect-face"),e.innerHTML='<i class="fa-solid fa-check"></i>',n&&"function"==typeof n&&n(t,o,a,c)}function resizeBoundingBoxes(e,i){const r=i.offsetWidth,l=i.offsetHeight;e.forEach(({element:e,x1:t,y1:o,cropWidth:a,cropHeight:c})=>{var n=r/i.naturalWidth,s=l/i.naturalHeight;e.style.width=a*n+"px",e.style.height=c*s+"px",e.style.transform=`translateX(${t*n}px) translateY(${o*s}px)`,centerBoundingBox(e,e.parentElement,r,l)})}window.detectFacesTool=detectFacesInitTool,window.createFaceDetectCrop=createFaceDetectCropTool;export{detectFacesInitTool,createFaceDetectCropTool};