function openCalendarModal(v=null,c=null){var e=document.querySelector(".modal-calendar-template").content.cloneNode(!0);const g=e.querySelector(".calendar"),o=e.querySelector(".calendar-content");var t=e.querySelector(".calendar-range");const y=e.querySelector(".date-from"),w=e.querySelector(".date-to"),d=e.querySelector(".calendar-today"),u=e.querySelector(".calendar-yesterday");var a,r,n,l,i,s,h=e.querySelector(".calendar-submit");const m=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=["January","February","March","April","May","June","July","August","September","October","November","December"],f=new Date,b=new Date(f);function S(e,t,a){var o=document.querySelector(".user-calendar-date");o.setAttribute("data-year-from",a),o.setAttribute("data-month-from",t),o.setAttribute("data-day-from",e),o.setAttribute("data-year-to",a),o.setAttribute("data-month-to",t),o.setAttribute("data-day-to",e)}function k(e,t=6){var a=document.querySelector(".user-calendar-date"),o=document.querySelector(".user-calendar-date-bg"),t=((a.textContent=e).length,t+.4*Math.max(e.length-5,0));a.style.width=t.toFixed(2)+"rem",o.style.width=t.toFixed(2)+"rem"}function x(){var r,n,l,i,s,c,e=new Date;let t,a,o,d,u,h;h=v?(t=parseInt(y.getAttribute("data-year-from"))||e.getFullYear(),a=parseInt(y.getAttribute("data-month-from"))||e.getMonth(),o=parseInt(y.getAttribute("data-day-from"))||e.getDate(),d=parseInt(w.getAttribute("data-year-to"))||e.getFullYear(),u=parseInt(w.getAttribute("data-month-to"))||e.getMonth(),parseInt(w.getAttribute("data-day-to"))||e.getDate()):(m=document.querySelector(".user-calendar-date"),t=parseInt(m.getAttribute("data-year-from"))||e.getFullYear(),a=parseInt(m.getAttribute("data-month-from"))||e.getMonth(),o=parseInt(m.getAttribute("data-day-from"))||e.getDate(),d=parseInt(m.getAttribute("data-year-to"))||e.getFullYear(),u=parseInt(m.getAttribute("data-month-to"))||e.getMonth(),parseInt(m.getAttribute("data-day-to"))||e.getDate());var m=a,e=o,p=u,f=h;if(m<0||11<m||p<0||11<p)throw new Error("Invalid month value");if(e<1||31<e||f<1||31<f)throw new Error("Invalid day value");r=t,n=a,l=o,i=d,s=u,c=h,g.querySelector(".calendar-days").querySelectorAll("div").forEach(e=>{var t=parseInt(e.getAttribute("data-year-uniq")),a=parseInt(e.getAttribute("data-month-uniq")),o=parseInt(e.getAttribute("data-day-uniq")),t=new Date(t,a,o),a=new Date(r,n,l),o=new Date(i,s,c);a<=t&&t<=o?(e.classList.add("curr-date"),e.classList.add("bg-accent-primary"),e.classList.add("text-dark-background"),e.classList.add("font-extra-thick")):(e.classList.remove("curr-date"),e.classList.remove("bg-accent-primary"),e.classList.remove("text-dark-background"),e.classList.remove("font-extra-thick"))})}function L(e,t,a){var o=new Date,r=parseInt(y.getAttribute("data-year-from"))||o.getFullYear(),n=parseInt(y.getAttribute("data-month-from"))||o.getMonth(),l=parseInt(y.getAttribute("data-day-from"))||o.getDate(),i=parseInt(w.getAttribute("data-year-to"))||o.getFullYear(),s=parseInt(w.getAttribute("data-month-to"))||o.getMonth(),o=parseInt(w.getAttribute("data-day-to"))||o.getDate();Math.abs(new Date(a,t,e)-new Date(r,n,l))<Math.abs(new Date(a,t,e)-new Date(i,s,o))?(console.log("Closer to labelDateFrom"),w.setAttribute("data-year-to",a),w.setAttribute("data-month-to",t),w.setAttribute("data-day-to",e),w.textContent=m[t]+` ${e}, `+a):(console.log("Closer to labelDateTo"),y.setAttribute("data-year-from",a),y.setAttribute("data-month-from",t),y.setAttribute("data-day-from",e),y.textContent=m[t]+` ${e}, `+a)}b.setDate(f.getDate()-1),v&&(t.classList.remove("hidden"),t=new Date,a=document.querySelector(".user-calendar-date"),r=parseInt(a.getAttribute("data-year-from"))||t.getFullYear(),n=parseInt(a.getAttribute("data-month-from"))||t.getMonth(),l=parseInt(a.getAttribute("data-day-from"))||t.getDate(),i=parseInt(a.getAttribute("data-year-to"))||t.getFullYear(),s=parseInt(a.getAttribute("data-month-to"))||t.getMonth(),a=parseInt(a.getAttribute("data-day-to"))||t.getDate(),w.setAttribute("data-year-to",i),w.setAttribute("data-month-to",s),w.setAttribute("data-day-to",a),w.textContent=m[s]+` ${a}, `+i,y.setAttribute("data-year-from",r),y.setAttribute("data-month-from",n),y.setAttribute("data-day-from",l),y.textContent=m[n]+` ${l}, `+r),isLeapYear=e=>e%4==0&&e%100!=0&&e%400!=0||e%100==0&&e%400==0,getFebDays=e=>isLeapYear(e)?29:28,h.onclick=function(){var e,t=new Date,a=parseInt(y.getAttribute("data-year-from"))||t.getFullYear(),o=parseInt(y.getAttribute("data-month-from"))||t.getMonth(),r=parseInt(y.getAttribute("data-day-from"))||t.getDate(),n=parseInt(w.getAttribute("data-year-to"))||t.getFullYear(),l=parseInt(w.getAttribute("data-month-to"))||t.getMonth(),t=parseInt(w.getAttribute("data-day-to"))||t.getDate();r=r,o=o,a=a,t=t,l=l,n=n,(e=document.querySelector(".user-calendar-date")).setAttribute("data-year-from",a),e.setAttribute("data-month-from",o),e.setAttribute("data-day-from",r),e.setAttribute("data-year-to",n),e.setAttribute("data-month-to",l),e.setAttribute("data-day-to",t),k(w.textContent+" - "+y.textContent),validCallback(c),closeModal(g)},generateCalendar=(a,o)=>{var e=g.querySelector(".calendar-year"),r=g.querySelector(".calendar-days"),n=[31,getFebDays(o),31,30,31,30,31,31,30,31,30,31];r.innerHTML="";let l=new Date;null==a&&(a=l.getMonth()),o=o||l.getFullYear();var t=""+p[a];M.innerHTML=t,e.innerHTML=o;let i=new Date(o,a,1);d.onclick=function(){S(l.getDate(),l.getMonth(),l.getFullYear()),k("Today"),validCallback(c),closeModal(g)},u.onclick=function(){S(b.getDate(),b.getMonth(),b.getFullYear()),k("Yesterday"),validCallback(c),closeModal(g)};for(let t=0;t<=n[a]+i.getDay()-1;t++){var s=document.createElement("div");t>=i.getDay()&&(s.classList.add("calendar-day-hover"),s.classList.add("rounded-md"),s.classList.add("w-10"),s.classList.add("h-10"),s.setAttribute("data-day-uniq",t-i.getDay()+1),s.setAttribute("data-month-uniq",a),s.setAttribute("data-year-uniq",o),s.innerHTML=t-i.getDay()+1,t-i.getDay()+1<=l.getDate()&&o===l.getFullYear()&&a===l.getMonth()||o===l.getFullYear()&&a<l.getMonth()||o<l.getFullYear()?s.onclick=()=>{var e=new Date(o,a,t-i.getDay()+1);e.toDateString()===f.toDateString()?(console.log("Today"),v?L(t-i.getDay()+1,a,o):(S(t-i.getDay()+1,a,o),k("Today"),validCallback(c),closeModal(g))):e.toDateString()===b.toDateString()?(console.log("Yesterday"),v?L(t-i.getDay()+1,a,o):(S(t-i.getDay()+1,a,o),k("Yesterday"),validCallback(c),closeModal(g))):(console.log(e),v?L(t-i.getDay()+1,a,o):(S(t-i.getDay()+1,a,o),k(`${m[a]} ${t-i.getDay()+1}, `+o),validCallback(c),closeModal(g))),x()}:s.style.color="#ffffff6e"),r.appendChild(s)}x()};let q=g.querySelector(".month-list"),M=(m.forEach((e,t)=>{var a=document.createElement("div");a.innerHTML=`<div data-month="${t}">${e}</div>`,a.querySelector("div").onclick=()=>{q.classList.remove("block"),C.value=t,generateCalendar(t,E.value),o.classList.remove("hidden")},q.appendChild(a)}),g.querySelector(".month-picker"));M.onclick=()=>{q.classList.add("block"),o.classList.add("hidden")};t=new Date;let C={value:t.getMonth()},E={value:t.getFullYear()};generateCalendar(C.value,E.value),g.querySelector(".prev-year").onclick=()=>{--E.value,generateCalendar(C.value,E.value)},g.querySelector(".next-year").onclick=()=>{++E.value,generateCalendar(C.value,E.value)},document.body.appendChild(e)}function openRenameNoticeModal(i,s=null){return new Promise((t,a)=>{var e=extractStaticFilePathAndNameFromSrc(i);const o=e.srcFilePath,r=e.srcFileName;var e=document.querySelector(".modal-rename-notice-template").content.cloneNode(!0),n=e.querySelector(".modal-root-filename");n.textContent=r,n.href=i,n.download=r;const l=e.querySelector(".modal-root-filename-input");l.value=r,e.querySelector(".submit-rename").onclick=function(){console.log(l.value),fetch("/content-rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:o,fileName:r,newFileName:l.value})}).then(e=>e.json()).then(e=>{200===e.status?(validCallback(s),t({newFileName:e.newFileName,srcFilePath:o})):(frontendConsoleLogToBackendPrint(e.message),a({error:"File renaming failed",srcFileName:r,srcFilePath:o}))}).catch(e=>{console.error("Error:",e),a({error:e,srcFileName:r,srcFilePath:o})}),closeModal(this)},document.body.appendChild(e)})}function openDeleteNoticeModal(l,i=null){return new Promise((t,a)=>{var e=extractStaticFilePathAndNameFromSrc(l);const o=e.srcFilePath,r=e.srcFileName;var e=document.querySelector(".modal-delete-notice-template").content.cloneNode(!0),n=e.querySelector(".modal-root-filename");n.textContent=r,n.href=l,n.download=r,e.querySelector(".submit-delete").onclick=function(){fetch("/content-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:o,fileName:r})}).then(e=>e.json()).then(e=>{200===e.status?(validCallback(i),t(!0)):frontendConsoleLogToBackendPrint(e.message)}).catch(e=>{console.error("Error:",e),a(!1)}),closeModal(this)},document.body.appendChild(e)})}function openDeleteAllFilesNoticeModal(t,r=null){return new Promise((a,o)=>{var e=document.querySelector(".modal-delete-notice-template").content.cloneNode(!0);e.querySelector(".modal-root-filename").textContent="all files",e.querySelector(".submit-delete").onclick=function(){t.forEach(e=>{var e=extractStaticFilePathAndNameFromSrc(e.fullPath),t=e.srcFilePath,e=e.srcFileName;fetch("/content-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:t,fileName:e})}).then(e=>e.json()).then(e=>{200===e.status?(validCallback(r),a(!0)):frontendConsoleLogToBackendPrint(e.message)}).catch(e=>{console.error("Error:",e),o(!1)})}),closeModal(this)},document.body.appendChild(e)})}function createModalVideo(a,e,t=null){var o="ontouchstart"in window||navigator.msMaxTouchPoints,r=document.querySelector(".modal-video-template").content.cloneNode(!0);const n=r.querySelector(".modal-root"),l=n.querySelector(".video"),i=(l.src=a,n.querySelector(".download")),s=(i.href=a,i.download=e.name,n.querySelector(".censure"));function c(){s.querySelector(".fa-eye").classList.toggle("hidden"),s.querySelector(".fa-eye-slash").classList.toggle("hidden"),l.style.filter=l.style.filter?"":"blur(50px)"}!0===e.censure&&(c(),s.onclick=c);const d=n.querySelector(".description");var u=n.querySelector(".datetime-created");const h=n.querySelector(".fps"),m=n.querySelector(".duration"),p=n.querySelector(".sound-button");function f(e){var t=n.querySelector(".open-parameters-view"),a=n.querySelector(".parameters"),e=e.target;a.contains(e)||t.contains(e)||n.querySelector(".close-parameters-view").click()}function v(e){return Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0")}d.textContent=e.name,u.textContent=formatDateTime(e.created),n.querySelector(".repost-button").onclick=function(){var e=a,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("copy"),document.body.removeChild(t)},n.querySelector(".rename-button").onclick=function(){openRenameNoticeModal(a,t).then(e=>{d.textContent=e.newFileName;var t=createStaticSrc(e.srcFilePath,e.newFileName);a=t,l.src=t,i.href=t,i.download=e.newFileName}).catch(e=>{})},n.querySelector(".delete-button").onclick=function(){openDeleteNoticeModal(a,t).then(e=>{!0===e&&closeModal(this)}).catch(e=>{console.error("Error:",e)})},n.querySelector(".open-parameters-view").onclick=function(){var e=n.querySelector(".parameters");e.classList.remove("hidden"),e.classList.add("block"),setTimeout(()=>{document.addEventListener("click",f)},100)},n.querySelector(".close-parameters-view").onclick=function(){var e=n.querySelector(".parameters");e.classList.remove("block"),e.classList.add("hidden"),document.removeEventListener("click",f)},o?l.addEventListener("click",function(){l.paused?l.play():l.pause()}):(l.addEventListener("mouseover",function(){l.play().catch(e=>{})}),l.addEventListener("mouseout",function(){l.pause()})),p.addEventListener("click",function(){l.muted=!l.muted;var e=l.muted?'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="m14.667 6-4 4m0-4 4 4M7.333 3.333 4 6H1.333v4H4l3.333 2.667V3.333Z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="M10.36 3.64a3.333 3.333 0 0 1 0 4.713m2.353-7.066a6.667 6.667 0 0 1 0 9.426m-5.38-9.38L4 4H1.333v4H4l3.333 2.667V1.333Z"></path></svg>';p.innerHTML=e,l.focus()}),l.addEventListener("loadedmetadata",function(){l.pause(),l.muted=!0;var e,t=v(l.duration);m.textContent="0:00/"+t,l.webkitDecodedFrameCount&&l.webkitDroppedFrameCount?(t=l.webkitDecodedFrameCount/l.duration,e=l.webkitDroppedFrameCount/l.duration,h.textContent=`Decoded FPS: ${t.toFixed(2)}, Dropped FPS: `+e.toFixed(2)):console.log("Video FPS calculations are not supported")}),l.addEventListener("timeupdate",function(){var e=v(l.currentTime),t=v(l.duration);m.textContent=e+"/"+t}),document.body.appendChild(r)}function createModalImage(a,e,t=null){var o=document.querySelector(".modal-image-template").content.cloneNode(!0);const r=o.querySelector(".modal-root"),n=r.querySelector(".image"),l=(n.src=a,r.querySelector(".censure"));function i(){l.querySelector(".fa-eye").classList.toggle("hidden"),l.querySelector(".fa-eye-slash").classList.toggle("hidden"),n.style.filter=n.style.filter?"":"blur(50px)"}!0===e.censure&&(i(),l.onclick=i);const s=r.querySelector(".download"),c=(s.href=a,s.download=e.name,r.querySelector(".description"));var d=r.querySelector(".datetime-created");function u(e){var t=r.querySelector(".open-parameters-view"),a=r.querySelector(".parameters"),e=e.target;a.contains(e)||t.contains(e)||r.querySelector(".close-parameters-view").click()}c.textContent=e.name,d.textContent=formatDateTime(e.created),r.querySelector(".repost-button").onclick=function(){var e=a,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("copy"),document.body.removeChild(t)},r.querySelector(".rename-button").onclick=function(){openRenameNoticeModal(a,t).then(e=>{c.textContent=e.newFileName;var t=createStaticSrc(e.srcFilePath,e.newFileName);a=t,n.src=t,s.href=t,s.download=e.newFileName}).catch(e=>{})},r.querySelector(".delete-button").onclick=function(){openDeleteNoticeModal(a,t).then(e=>{!0===e&&closeModal(this)}).catch(e=>{console.error("Error:",e)})},r.querySelector(".open-parameters-view").onclick=function(){var e=r.querySelector(".parameters");e.classList.remove("hidden"),e.classList.add("block"),setTimeout(()=>{document.addEventListener("click",u)},100)},r.querySelector(".close-parameters-view").onclick=function(){var e=r.querySelector(".parameters");e.classList.remove("block"),e.classList.add("hidden"),document.removeEventListener("click",u)},document.body.appendChild(o)}function createModalImageGroup(i,n,e=null){var t=document.querySelector(".modal-image-group-template").content.cloneNode(!0);const o=t.querySelector(".modal-root"),s=o.querySelector(".image"),c=o.querySelector(".mini-images");let d=0;var a=i[d].fullPath;s.src=a;const r=o.querySelector(".censure");function l(){r.querySelector(".fa-eye").classList.toggle("hidden"),r.querySelector(".fa-eye-slash").classList.toggle("hidden"),s.style.filter=s.style.filter?"":"blur(50px)"}!0===n.censure&&(l(),r.onclick=l);const u=o.querySelector(".download"),h=(u.href=a,u.download=i[d].name,o.querySelector(".description"));a=o.querySelector(".datetime-created");h.textContent=i[d].name,a.textContent=formatDateTime(n.created);let m=0,p=0;function f(){c.querySelectorAll("button").forEach((e,t)=>{e.style.filter="grayscale(100%)"})}function v(n=null){let e;const l=1.5*(e=0===c.querySelectorAll("button").length?10<i.length?10:i.length:1);let t,a;"down"===n?(t=p+1,m=t,a=t+e-1,p=a):"up"===n?(a=m-1,(p=a)<0&&(a=i.length-1,p=a),t=Math.max(0,a-e+1),m=t):"init"===n&&(t=p,m=t,a=t+e-1,p=a);var o=[];for(let e=t;e<=a;e++)o.push(e);"up"===n&&o.reverse(),o.forEach(e=>{const t=e%i.length;e=i[t];const a=document.createElement("button");a.style="will-change: filter;transition: filter 0.12s ease-in, border-color 0.12s ease;",a.classList.add("mini-image-"+t),a.setAttribute("index",e.index),i[d].index!==e.index&&(a.style.filter="grayscale(100%)"),a.onclick=function(){d=t,s.src=i[d].fullPath,h.textContent=i[d].name,u.href=i[d].fullPath,u.download=i[d].name,f(),a.style.filter=""};var o=document.createElement("div"),r=(o.classList.add("h-7","w-7","absolute","left-1","z-[1]","text-s-mobile","lg:text-s","!font-medium","px-2","py-1.5","rounded-md","bg-dark-tags"),o.textContent=1+t,o.style.margin=".25rem",document.createElement("img"));r.classList.add("w-auto","object-contain","rounded-[.625rem]"),r.src=e.fullPath,a.appendChild(o),a.appendChild(r),"down"===n||"init"===n?(c.appendChild(a),c.firstChild&&l<c.childElementCount&&c.removeChild(c.firstChild)):"up"===n&&(c.insertBefore(a,c.firstChild),c.lastChild)&&l<c.childElementCount&&(c.removeChild(c.lastChild),c.scrollTop=l)})}function g(){c.querySelectorAll("button").forEach((e,t)=>{var a=parseInt(e.getAttribute("index"));i[d].index===a&&(f(),e.style.filter="")})}function y(e){var t=o.querySelector(".open-parameters-view"),a=o.querySelector(".parameters"),e=e.target;a.contains(e)||t.contains(e)||o.querySelector(".close-parameters-view").click()}c.addEventListener("wheel",e=>{e.preventDefault();e=.1*e.deltaY;c.scrollBy(0,e)},{passive:!1}),o.querySelector(".repost-button").onclick=function(){var e=i.map(e=>e.fullPath).join(", "),t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("copy"),document.body.removeChild(t)},v("init"),c.addEventListener("scroll",()=>{c.scrollTop+c.clientHeight>=c.scrollHeight?v("down"):0===c.scrollTop&&(console.log(1),v("up"))}),o.querySelectorAll(".touchscreen-back-button").forEach((e,t)=>{e.onclick=function(){d=(d-1+i.length)%i.length,s.src=i[d].fullPath,h.textContent=i[d].name,u.href=i[d].fullPath,u.download=i[d].name,g()}}),o.querySelectorAll(".touchscreen-next-button").forEach((e,t)=>{e.onclick=function(){d=(d+1)%i.length,s.src=i[d].fullPath,h.textContent=i[d].name,u.href=i[d].fullPath,u.download=i[d].name,g()}}),o.querySelector(".mini-up-images-button").onclick=function(){c.clientHeight;var e=c.scrollTop,t=c.querySelectorAll("button"),t=(t.length,2*t[0].offsetHeight);c.scrollTop=Math.max(e-t,0)},o.querySelector(".mini-down-images-button").onclick=function(){var e=c.clientHeight,t=c.scrollTop,a=c.querySelectorAll("button"),a=(a.length,2*a[0].offsetHeight);c.scrollTop=Math.min(t+a,c.scrollHeight-e)},o.querySelector(".delete-button").onclick=function(){openDeleteNoticeModal(i[d].fullPath,e).then(e=>{!0===e&&(c.querySelectorAll("button").forEach((e,t)=>{var a=parseInt(e.getAttribute("index"));i[d].index===a&&e.remove()}),-1<d&&i.splice(d,1),0===i.length&&closeModal(this),d>i.length-1&&(d=i.length-1),s.src=i[d].fullPath,h.textContent=i[d].name,u.href=i[d].fullPath,u.download=i[d].name,f(),c.querySelectorAll("button").forEach((e,t)=>{var a=parseInt(e.getAttribute("index"));i[d].index===a&&(e.style.filter="")}))}).catch(e=>{console.error("Error:",e)})},o.querySelectorAll(".delete-all-button").forEach(t=>{t.addEventListener("click",()=>{openDeleteAllFilesNoticeModal(i,e).then(e=>{!0===e&&closeModal(t)}).catch(e=>{console.error("Error:",e)})})}),o.querySelectorAll(".download-archive").forEach(r=>{r.addEventListener("click",()=>{r.querySelector("span").textContent="Archiving";const a=new JSZip,o=[];i.forEach(t=>{var e=fetch(t.fullPath).then(e=>e.blob()).then(e=>{a.file(t.name,e)}).catch(e=>console.error("Error fetching file:",e));o.push(e)}),Promise.all(o).then(()=>{a.generateAsync({type:"blob"}).then(e=>{var e=window.URL.createObjectURL(e),t=document.createElement("a");t.href=e,t.download=n.name+".zip",t.click(),window.URL.revokeObjectURL(e),r.querySelector("span").textContent="Download All"}).catch(e=>console.error("Error creating archive:",e))})})});const w=o.querySelector(".burger-list"),b=o.querySelector(".burger");function S(e){w.contains(e.target)||e.target===b||(w.classList.add("hidden"),document.removeEventListener("click",S))}b.onclick=function(){w.classList.remove("hidden"),setTimeout(()=>{document.addEventListener("click",S)},100)},o.querySelector(".open-parameters-view").onclick=function(){var e=o.querySelector(".parameters");e.classList.remove("hidden"),e.classList.add("block"),setTimeout(()=>{document.addEventListener("click",y)},100)},o.querySelector(".close-parameters-view").onclick=function(){var e=o.querySelector(".parameters");e.classList.remove("block"),e.classList.add("hidden"),document.removeEventListener("click",y)},document.body.appendChild(t)}function createModalAudio(a,e,t=null){var o=document.querySelector(".modal-audio-template").content.cloneNode(!0);const r=o.querySelector(".modal-root"),n=r.querySelector(".audio"),l=(n.src=a,r.querySelector(".download")),i=(l.href=a,l.download=e.name,r.querySelector(".description"));var s=r.querySelector(".datetime-created");const c=r.querySelector(".audio-control"),d=r.querySelector(".sound-button"),u=r.querySelector(".current-time"),h=r.querySelector(".duration"),m=r.querySelector(".current-time-slider"),p=r.querySelector(".audio-wave");function f(e){const l=20,i=document.createElement("canvas"),t=(i.style.opacity=.5,i.width=p.offsetWidth,i.height=p.offsetHeight-2*l,console.log(i.height),p.appendChild(i),window.AudioContext=window.AudioContext||window.webkitAudioContext,new AudioContext);const s=(e,t,a,o,r)=>{e.lineWidth=1,e.strokeStyle="#fff",e.fillStyle="#fff",e.beginPath(),a=r?a:-a,a=-Math.abs(a),e.moveTo(t,0),e.lineTo(t,a),e.arc(t+o/2,a,o/2,0,0,r),e.lineTo(t+o,0),e.stroke(),e.fill()};fetch(e).then(e=>e.arrayBuffer()).then(e=>t.decodeAudioData(e)).then(e=>{{var a=(e=>{const t=Math.pow(Math.max(...e),-1);return e.map(e=>e*t)})((e=>{const o=e.getChannelData(0),t=100,r=Math.floor(o.length/t),n=[];for(let e=0;e<t;e++){let t=r*e;let a=0;for(let e=0;e<r;e++)a=a+Math.abs(o[t+e]);n.push(a/r)}return n})(e)),t=window.devicePixelRatio||1,o=(i.width=i.offsetWidth*t,i.height=(i.offsetHeight+2*l)*t,i.getContext("2d")),r=(o.scale(t,t),o.translate(0,i.offsetHeight/2+l),i.offsetWidth/a.length);for(let t=0;t<a.length;t++){var n=r*t;let e=a[t]*i.offsetHeight-l;e<0?e=0:e>i.offsetHeight/2&&(e=e>i.offsetHeight/2),s(o,n,e,r,(t+1)%2)}}})}function v(e){var t=r.querySelector(".open-parameters-view"),a=r.querySelector(".parameters"),e=e.target;a.contains(e)||t.contains(e)||r.querySelector(".close-parameters-view").click()}function g(e){return Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0")}i.textContent=e.name,s.textContent=formatDateTime(e.created),p.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a*100,e=(m.style.left=t+"%",n.duration),a=e*t/100;n.currentTime=a}),r.querySelector(".repost-button").onclick=function(){var e=a,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("copy"),document.body.removeChild(t)},r.querySelector(".rename-button").onclick=function(){openRenameNoticeModal(a,t).then(e=>{i.textContent=e.newFileName;var t=createStaticSrc(e.srcFilePath,e.newFileName);a=t,image.src=t,l.href=t,l.download=e.newFileName}).catch(e=>{})},r.querySelector(".delete-button").onclick=function(){openDeleteNoticeModal(a,t).then(e=>{!0===e&&closeModal(this)}).catch(e=>{console.error("Error:",e)})},r.querySelector(".open-parameters-view").onclick=function(){var e=r.querySelector(".parameters");e.classList.remove("hidden"),e.classList.add("block"),setTimeout(()=>{document.addEventListener("click",v)},100)},r.querySelector(".close-parameters-view").onclick=function(){var e=r.querySelector(".parameters");e.classList.remove("block"),e.classList.add("hidden"),document.removeEventListener("click",v)},d.addEventListener("click",function(){n.muted=!n.muted;var e=n.muted?'<svg style="scale:1.4;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="m14.667 6-4 4m0-4 4 4M7.333 3.333 4 6H1.333v4H4l3.333 2.667V3.333Z"></path></svg>':'<svg style="scale:1.4;" xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="M10.36 3.64a3.333 3.333 0 0 1 0 4.713m2.353-7.066a6.667 6.667 0 0 1 0 9.426m-5.38-9.38L4 4H1.333v4H4l3.333 2.667V1.333Z"></path></svg>';d.innerHTML=e}),c.addEventListener("click",function(){n.paused?n.play():n.pause();var e=n.paused?'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="#fff"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.167 2.5 15.832 10 4.166 17.5v-15Z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="#fff"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7.833 3.333H4.5v13.334h3.333V3.333ZM15.5 3.333h-3.333v13.334H15.5V3.333Z"></path></svg>';c.innerHTML=e}),n.addEventListener("loadedmetadata",function(){n.pause(),n.muted=!1;var e=g(n.duration);u.textContent="0:00",h.textContent=""+e,f(n.src)}),n.addEventListener("timeupdate",function(){var e=g(n.currentTime),t=g(n.duration),a=n.currentTime/n.duration*100;u.textContent=""+e,h.textContent=""+t,m.style.left=a+"%"}),document.body.appendChild(o)}async function createModalSAMLoadMessage(e){var t=document.querySelector(".modal-sam-load-model-template").content.cloneNode(!0);const a=t.querySelector(".modal-root");var o=a.querySelector(".close-button");document.body.appendChild(t);{const r=new XMLHttpRequest;r.addEventListener("load",()=>{200<=r.status&&r.status<300?(console.log("Model file has been successfully loaded."),closeModal(a)):console.error("Failed to load model file.")}),r.addEventListener("error",()=>{console.error("Error loading model file.")}),r.open("GET",e),r.send()}o.onclick=async function(){isUseBrash(2),closeModal(a)}}function createModalSAMVideo(e,t=null,a=null){const r="ontouchstart"in window||navigator.msMaxTouchPoints;var o=document.querySelector(".modal-sam-video-template").content.cloneNode(!0);const n=o.querySelector(".modal-root"),c=(turnOnUpdateEmbBrash(),n.querySelector(".video"));c.setAttribute("crossorigin","anonymous");try{c.src=URL.createObjectURL(e)}catch{c.src=e}let d;const u=n.querySelector(".timeline"),h=n.querySelector(".duration");var l=n.querySelector(".sound-button");let m=0;const i=n.querySelector(".timeline-range-current"),p=n.querySelector(".timeline-range-left"),f=n.querySelector(".timeline-range-right"),s=document.createElement("div"),v=(s.classList.add("rounded-l-md","h-14","absolute","z-2","left-0","flex-row","flex","bg-dark-elements","opacity-90"),document.createElement("div"));v.classList.add("rounded-r-md","h-14","absolute","z-2","right-0","flex-row","flex","bg-dark-elements","opacity-90"),u.parentElement.appendChild(s),u.parentElement.appendChild(v);var g=document.createElement("div"),y=(g.classList.add("h-14","absolute","z-2","left-0","w-full"),u.parentElement.appendChild(g),n.querySelector(".end-time-back"));const w=n.querySelector(".end-time-input");var b=n.querySelector(".end-time-forward"),S=n.querySelector(".start-time-back");const k=n.querySelector(".start-time-input");var x=n.querySelector(".start-time-forward");const L=n.querySelectorAll(".brush");let q=0,M=!0;const C=n.querySelector(".watch-button");function E(e){return e<0?e=0:e>d&&(e=d),e>w.value&&(e=w.value),parseFloat(e).toFixed(2)}function F(e){return e<0?e=0:e>d&&(e=d),e<k.value&&(e=k.value),parseFloat(e).toFixed(2)}function A(e,t,a){return Math.abs(e/(a-t)*d).toFixed(2)}function D(e,t,a){return Math.abs(e/d*(a-t)).toFixed(2)}function T(){const t=c.offsetHeight;n.querySelectorAll(".canvas-brash").forEach(e=>{e.style.height=t+"px"}),n.querySelectorAll(".svg-brash").forEach(e=>{e.style.height=t+"px"})}function H(){sendModuleData.sourceFile.startTime=k.value,sendModuleData.sourceFile.endTime=w.value}function P(e){return Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0")}function W(){L.forEach(e=>{e.classList.remove("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),e.classList.add("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up")})}r?c.addEventListener("click",function(){!1===M&&(c.paused?c.play():c.pause())}):(c.addEventListener("mouseover",function(){!1===M&&c.play().catch(e=>{})}),c.addEventListener("mouseout",function(){!1===M&&c.pause()})),l.addEventListener("click",function(){c.muted=!c.muted;var e=c.muted?'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="m14.667 6-4 4m0-4 4 4M7.333 3.333 4 6H1.333v4H4l3.333 2.667V3.333Z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="M10.36 3.64a3.333 3.333 0 0 1 0 4.713m2.353-7.066a6.667 6.667 0 0 1 0 9.426m-5.38-9.38L4 4H1.333v4H4l3.333 2.667V1.333Z"></path></svg>';this.innerHTML=e,c.focus()}),n.querySelector(".reset-button").onclick=function(){sendModuleData.moduleParameters.SAM=[],k.value=0,w.value=d,k.onchange(),w.onchange(),clearBrash(),sendModuleData.moduleParameters.SAM=[],r?isUseBrash(2):isUseBrash(1),C.click(),H()},g.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a,e=(i.value=t*i.max,t*d);c.currentTime=parseFloat(e)||0}),s.parentElement.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a,e=(i.value=t*i.max,t*d);c.currentTime=parseFloat(e)||0}),S.onclick=function(){k.value=E(parseFloat(k.value)-parseFloat(k.step)),p.value=D(parseFloat(k.value),p.min,p.max),p.oninput(),c.currentTime=parseFloat(k.value)||0},k.onchange=function(){this.value=E(parseFloat(this.value)),p.value=D(parseFloat(this.value),p.min,p.max),p.oninput(),c.currentTime=parseFloat(this.value)||0},x.onclick=function(){k.value=E(parseFloat(k.value)+parseFloat(k.step)),p.value=D(parseFloat(k.value),p.min,p.max),p.oninput(),c.currentTime=parseFloat(k.value)||0},y.onclick=function(){w.value=F(parseFloat(w.value)-parseFloat(w.step)),f.value=D(parseFloat(w.value),f.min,f.max),f.oninput(),c.currentTime=parseFloat(w.value)||0},w.onchange=function(){this.value=F(parseFloat(this.value)),f.value=D(parseFloat(this.value),f.min,f.max),f.oninput(),c.currentTime=parseFloat(this.value)||0},b.onclick=function(){w.value=F(parseFloat(w.value)+parseFloat(w.step)),f.value=D(parseFloat(w.value),f.min,f.max),f.oninput(),c.currentTime=parseFloat(w.value)||0},window.addEventListener("resize",function(){var e;e=u.offsetWidth*p.value/(p.max-p.min),s.style.width=e+"px",e=u.offsetWidth-u.offsetWidth*f.value/(f.max-f.min),v.style.width=e+"px",L.forEach(e=>{e.click()}),T()}),p.oninput=function(){parseInt(f.value)-parseInt(p.value)<=m&&(p.value=parseInt(f.value)-m);var e=u.offsetWidth*this.value/(this.max-this.min);s.style.width=e+"px",k.value=A(this.value,this.max,this.min),H()},f.oninput=function(){parseInt(f.value)-parseInt(p.value)<=m&&(f.value=parseInt(p.value)+m);var e=u.offsetWidth-u.offsetWidth*this.value/(this.max-this.min);v.style.width=e+"px",w.value=A(this.value,this.max,this.min),H()},c.addEventListener("loadedmetadata",async function(){var e=n.querySelector(".modal-content-display"),e=(e&&(e=window.getComputedStyle(e),e=parseFloat(e.getPropertyValue("padding-top")),this.offsetHeight<e?(this.classList.remove("h-full"),this.classList.add("h-auto")):this.classList.add("h-full")),this.pause(),this.muted=!0,sendModuleData.sourceFile.naturalWidth=this.videoWidth,sendModuleData.sourceFile.naturalHeight=this.videoHeight,sendModuleData.sourceFile.offsetWidth=this.offsetWidth,sendModuleData.sourceFile.offsetHeight=this.offsetHeight,d=sendModuleData.sourceFile.fileSizeBytes>maxFileSize?maxFileSize/sendModuleData.sourceFile.fileSizeBytes*this.duration:this.duration,sendModuleData.sourceFile.startTime=0,P(sendModuleData.sourceFile.endTime=d));h.textContent="0:00/"+e;{var[e,t=5]=[d];const a=n.querySelector(".timeline-markers"),o=(a.innerHTML="",e/t);e=Array.from({length:6},(e,t)=>P(o*t)),[...new Set(e)].forEach(e=>{var t=document.createElement("div");t.textContent=e,a.appendChild(t)})}await 0;{var[t,l=10]=[this.src];const i=document.createElement("canvas"),s=document.createElement("video");s.autoplay=!0,s.muted=!0,s.src=t,s.crossOrigin="anonymous",s.onloadeddata=async()=>{var t=i.getContext("2d"),a=(i.width=s.videoWidth,i.height=s.videoHeight,c.offsetWidth/(60/i.height*i.width*10)),o=(s.pause(),s.duration/(l-1));for(let e=0;e<l;e++){var r=e*o;s.currentTime=r,await new Promise(e=>s.onseeked=e),t.clearRect(0,0,i.width,i.height),i.width=s.videoWidth*a,i.height=s.videoHeight;for(let e=0;e<a;e++)t.drawImage(s,e*s.videoWidth,0,s.videoWidth,s.videoHeight);var r=i.toDataURL("image/png"),r=await(await fetch(r)).blob(),r=URL.createObjectURL(r),n=document.createElement("div");n.classList.add("h-14","w-full","opacity-60"),n.style.backgroundSize="auto 100%",n.style.backgroundRepeat="repeat",n.style.backgroundImage=`url(${r})`,u.appendChild(n)}}}await 0,k.value=0,k.max=d.toFixed(2),w.value=d.toFixed(2),w.max=d.toFixed(2);e=Math.min((f.max-f.min)/d,(p.max-p.min)/d);m=e,updateContentPaddingTop(),T()}),c.addEventListener("timeupdate",function(){k.value>this.currentTime&&(this.currentTime=k.value),this.currentTime>w.value&&(this.currentTime=k.value);var e=P(this.currentTime),t=P(d);h.textContent=e+"/"+t,i.value=this.currentTime/d*i.max}),C.onclick=async function(){r||updateCanvasHoverBrash(),M=!1,n.querySelectorAll(".accessible-media-control").forEach(e=>{e.classList.add("hidden")}),C.classList.remove("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),C.classList.add("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),isUseBrash(0),n.querySelectorAll(".canvas-brash").forEach(e=>{e.classList.add("hidden")}),W(),c.paused&&c.play()},n.querySelector(".close-button").onclick=function(){sendModuleData.sourceFile.urlFile=e,sendModuleData.sourceFile.formatFile="mp4",a&&"function"==typeof a&&a(),turnOnUpdateEmbBrash(),t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.SAM)&&(0===sendModuleData.moduleParameters.SAM.length?(console.log("SAM is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("SAM is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},n.querySelector(".clear-brush").onclick=async function(){clearBrash(),sendModuleData.moduleParameters.SAM=[],r?isUseBrash(2):isUseBrash(1)},L.forEach((e,o)=>{const t=document.createElement("svg"),a=(t.classList.add("svg-brash","svg-brash-"+o,"absolute","w-full","h-full","z-[-1]"),c.insertAdjacentElement("beforebegin",t),document.createElement("canvas"));a.classList.add("canvas-brash","canvas-brash-"+o,"absolute","w-full","h-full","z-[0]"),a.setAttribute("id","canvas-brash-"+o),c.insertAdjacentElement("beforebegin",a),e.onclick=async function(){r||updateCanvasHoverBrash(),t.style.width=c.offsetWidth+"px",a.style.width=c.offsetWidth+"px",c.pause(),M=!0,n.querySelectorAll(".accessible-media-control").forEach(e=>{e.classList.remove("hidden")}),C.classList.remove("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),C.classList.add("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),r?isUseBrash(2):isUseBrash(1),n.querySelectorAll(".canvas-brash").forEach(e=>{e.classList.remove("hidden")}),W(),this.classList.remove("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),this.classList.add("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),n.querySelectorAll(".canvas-brash").forEach(e=>{a===e?(e.classList.remove("z-[0]"),e.classList.add("z-[1]")):(e.classList.add("z-[0]"),e.classList.remove("z-[1]"))}),c.currentTime=parseFloat(k.value)||0,q!==parseFloat(k.value)&&(q=parseFloat(k.value),clearBrash(),sendModuleData.moduleParameters.SAM=[],turnOnUpdateEmbBrash()),await new Promise(a=>{c.addEventListener("seeked",async e=>{var t=document.createElement("canvas");t.width=e.target.videoWidth,t.height=e.target.videoHeight,t.getContext("2d").drawImage(e.target,0,0,e.target.videoWidth,e.target.videoHeight),t.toBlob(async e=>{await getEmbBrash(e,o),a()},"image/jpeg")})}),r?isUseBrash(2):isUseBrash(1)}}),document.body.appendChild(o),c.addEventListener("loadeddata",function(){0<L.length&&L[L.length-1].click()})}function createModalSAMImage(e,t=null,a=null){sendModuleData.moduleParameters.SAM=[];const r="ontouchstart"in window||navigator.msMaxTouchPoints;var o=document.querySelector(".modal-sam-image-template").content.cloneNode(!0);const n=o.querySelector(".modal-root"),l=(turnOnUpdateEmbBrash(),n.querySelector(".image"));try{l.src=URL.createObjectURL(e)}catch{l.src=e}const i=n.querySelectorAll(".brush");function s(){const t=l.offsetHeight;n.querySelectorAll(".canvas-brash").forEach(e=>{e.style.height=t+"px"}),n.querySelectorAll(".svg-brash").forEach(e=>{e.style.height=t+"px"})}n.querySelector(".clear-brush").onclick=async function(){clearBrash(),sendModuleData.moduleParameters.SAM=[],r?isUseBrash(2):isUseBrash(1)},n.querySelector(".close-button").onclick=function(){sendModuleData.sourceFile.urlFile=e,sendModuleData.sourceFile.formatFile="jpg",a&&"function"==typeof a&&a(),turnOnUpdateEmbBrash(),t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.SAM)&&(0===sendModuleData.moduleParameters.SAM.length?(console.log("SAM is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("SAM is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},r?isUseBrash(2):isUseBrash(1),i.forEach((e,t)=>{const a=document.createElement("svg"),o=(a.classList.add("svg-brash","svg-brash-"+t,"absolute","w-full","h-full","z-[-1]"),l.insertAdjacentElement("beforebegin",a),document.createElement("canvas"));o.classList.add("canvas-brash","canvas-brash-"+t,"absolute","w-full","h-full","z-[0]"),o.setAttribute("id","canvas-brash-"+t),l.insertAdjacentElement("beforebegin",o),e.onclick=async function(){r||updateCanvasHoverBrash(),a.style.width=l.offsetWidth+"px",o.style.width=l.offsetWidth+"px",sendModuleData.sourceFile.naturalWidth=l.naturalWidth,sendModuleData.sourceFile.naturalHeight=l.naturalHeight,sendModuleData.sourceFile.offsetWidth=l.offsetWidth,sendModuleData.sourceFile.offsetHeight=l.offsetHeight,i.forEach(e=>{e.classList.remove("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),e.classList.add("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up")}),this.classList.remove("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements","!bg-dark-pop-up"),this.classList.add("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),n.querySelectorAll(".canvas-brash").forEach(e=>{o===e?(e.classList.remove("z-[0]"),e.classList.add("z-[1]")):(e.classList.add("z-[0]"),e.classList.remove("z-[1]"))}),await getEmbBrash(l.src,t),r?isUseBrash(2):isUseBrash(1)}}),window.addEventListener("resize",function(){i.forEach(e=>{e.click()}),s()}),document.body.appendChild(o),l.addEventListener("load",function(){var e=n.querySelector(".modal-content-display");e&&(e=window.getComputedStyle(e),e=parseFloat(e.getPropertyValue("padding-top")),this.offsetHeight>e)&&(this.classList.add("h-full"),this.classList.remove("h-auto")),0<i.length&&i[i.length-1].click(),s()})}function createModalCropperVideo(e,t=null,a){var o="ontouchstart"in window||navigator.msMaxTouchPoints,r=document.querySelector(".modal-cropper-video-template").content.cloneNode(!0);const n=r.querySelector(".modal-root"),c=n.querySelector(".video");c.setAttribute("crossorigin","anonymous");try{c.src=URL.createObjectURL(e)}catch{c.src=e}let d;const u=n.querySelector(".timeline"),h=n.querySelector(".duration");var l=n.querySelector(".sound-button");let m=0;const i=n.querySelector(".timeline-range-current"),p=n.querySelector(".timeline-range-left"),f=n.querySelector(".timeline-range-right"),s=document.createElement("div"),v=(s.classList.add("rounded-l-md","h-14","absolute","z-2","left-0","flex-row","flex","bg-dark-elements","opacity-90"),document.createElement("div"));v.classList.add("rounded-r-md","h-14","absolute","z-2","right-0","flex-row","flex","bg-dark-elements","opacity-90"),u.parentElement.appendChild(s),u.parentElement.appendChild(v);var g=document.createElement("div"),y=(g.classList.add("h-14","absolute","z-2","left-0","w-full"),u.parentElement.appendChild(g),n.querySelector(".end-time-back"));const w=n.querySelector(".end-time-input");var b=n.querySelector(".end-time-forward"),S=n.querySelector(".start-time-back");const k=n.querySelector(".start-time-input");var x=n.querySelector(".start-time-forward");g.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a,e=(i.value=t*i.max,t*d);c.currentTime=parseFloat(e)||0}),s.parentElement.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=this.offsetWidth,t=Math.min(e,a)/a,e=(i.value=t*i.max,t*d);c.currentTime=parseFloat(e)||0});function L(e){return e<0?e=0:e>d&&(e=d),e>w.value&&(e=w.value),parseFloat(e).toFixed(2)}function q(e){return e<0?e=0:e>d&&(e=d),e<k.value&&(e=k.value),parseFloat(e).toFixed(2)}function M(e,t,a){return Math.abs(e/(a-t)*d).toFixed(2)}function C(e,t,a){return Math.abs(e/d*(a-t)).toFixed(2)}function E(){sendModuleData.sourceFile.startTime=k.value,sendModuleData.sourceFile.endTime=w.value}function F(e){return Math.floor(e/60)+":"+Math.floor(e%60).toString().padStart(2,"0")}o?c.parentElement.addEventListener("click",function(){c.paused?c.play():c.pause()}):(c.parentElement.addEventListener("mouseover",function(){c.play().catch(e=>{})}),c.parentElement.addEventListener("mouseout",function(){c.pause()})),l.addEventListener("click",function(){c.muted=!c.muted;var e=c.muted?'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="m14.667 6-4 4m0-4 4 4M7.333 3.333 4 6H1.333v4H4l3.333 2.667V3.333Z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12" fill="none" class="h-4"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.85" stroke-width="1.5" d="M10.36 3.64a3.333 3.333 0 0 1 0 4.713m2.353-7.066a6.667 6.667 0 0 1 0 9.426m-5.38-9.38L4 4H1.333v4H4l3.333 2.667V1.333Z"></path></svg>';this.innerHTML=e,c.focus()}),n.querySelector(".reset-button").onclick=function(){k.value=0,w.value=d,k.onchange(),w.onchange(),E()},S.onclick=function(){k.value=L(parseFloat(k.value)-parseFloat(k.step)),p.value=C(parseFloat(k.value),p.min,p.max),p.oninput(),c.currentTime=parseFloat(k.value)||0},k.onchange=function(){this.value=L(parseFloat(this.value)),p.value=C(parseFloat(this.value),p.min,p.max),p.oninput(),c.currentTime=parseFloat(this.value)||0},x.onclick=function(){k.value=L(parseFloat(k.value)+parseFloat(k.step)),p.value=C(parseFloat(k.value),p.min,p.max),p.oninput(),c.currentTime=parseFloat(k.value)||0},y.onclick=function(){w.value=q(parseFloat(w.value)-parseFloat(w.step)),f.value=C(parseFloat(w.value),f.min,f.max),f.oninput(),c.currentTime=parseFloat(w.value)||0},w.onchange=function(){this.value=q(parseFloat(this.value)),f.value=C(parseFloat(this.value),f.min,f.max),f.oninput(),c.currentTime=parseFloat(this.value)||0},b.onclick=function(){w.value=q(parseFloat(w.value)+parseFloat(w.step)),f.value=C(parseFloat(w.value),f.min,f.max),f.oninput(),c.currentTime=parseFloat(w.value)||0},window.addEventListener("resize",function(){var e;e=u.offsetWidth*p.value/(p.max-p.min),s.style.width=e+"px",e=u.offsetWidth-u.offsetWidth*f.value/(f.max-f.min),v.style.width=e+"px"}),p.oninput=function(){parseInt(f.value)-parseInt(p.value)<=m&&(p.value=parseInt(f.value)-m);var e=u.offsetWidth*this.value/(this.max-this.min);s.style.width=e+"px",k.value=M(this.value,this.max,this.min),E()},f.oninput=function(){parseInt(f.value)-parseInt(p.value)<=m&&(f.value=parseInt(p.value)+m);var e=u.offsetWidth-u.offsetWidth*this.value/(this.max-this.min);v.style.width=e+"px",w.value=M(this.value,this.max,this.min),E()},c.addEventListener("loadedmetadata",async function(){this.pause(),this.muted=!0,sendModuleData.sourceFile.naturalWidth=this.videoWidth,sendModuleData.sourceFile.naturalHeight=this.videoHeight,sendModuleData.sourceFile.offsetWidth=this.offsetWidth,sendModuleData.sourceFile.offsetHeight=this.offsetHeight,d=sendModuleData.sourceFile.fileSizeBytes>maxFileSize?maxFileSize/sendModuleData.sourceFile.fileSizeBytes*this.duration:this.duration,sendModuleData.sourceFile.startTime=0;var e=F(sendModuleData.sourceFile.endTime=d);h.textContent="0:00/"+e;{var[e,t=5]=[d];const o=n.querySelector(".timeline-markers"),r=(o.innerHTML="",e/t);e=Array.from({length:6},(e,t)=>F(r*t)),[...new Set(e)].forEach(e=>{var t=document.createElement("div");t.textContent=e,o.appendChild(t)})}await 0;{var[t,l=10]=[this.src];const i=document.createElement("canvas"),s=document.createElement("video");s.autoplay=!0,s.muted=!0,s.src=t,s.crossOrigin="anonymous",s.onloadeddata=async()=>{var t=i.getContext("2d"),a=(i.width=s.videoWidth,i.height=s.videoHeight,c.offsetWidth/(60/i.height*i.width*10)),o=(s.pause(),s.duration/(l-1));for(let e=0;e<l;e++){var r=e*o;s.currentTime=r,await new Promise(e=>s.onseeked=e),t.clearRect(0,0,i.width,i.height),i.width=s.videoWidth*a,i.height=s.videoHeight;for(let e=0;e<a;e++)t.drawImage(s,e*s.videoWidth,0,s.videoWidth,s.videoHeight);var r=i.toDataURL("image/png"),r=await(await fetch(r)).blob(),r=URL.createObjectURL(r),n=document.createElement("div");n.classList.add("h-14","w-full","opacity-60"),n.style.backgroundSize="auto 100%",n.style.backgroundRepeat="repeat",n.style.backgroundImage=`url(${r})`,u.appendChild(n)}}}await 0,k.value=0,k.max=d.toFixed(2),w.value=d.toFixed(2),w.max=d.toFixed(2);e=document.createElement("canvas"),t=e.getContext("2d"),e.width=this.offsetWidth,e.height=this.offsetHeight,t.drawImage(this,0,0,e.width,e.height),t=e.toDataURL();const a=document.createElement("img");a.classList.add("absolute"),this.parentElement.insertBefore(a,this),a.onload=function(){var e=new Cropper(a,{viewMode:2,movable:!0,minCropBoxWidth:40,minCropBoxHeight:40,crop(e){e={x:e.detail.x,y:e.detail.y,width:e.detail.width,height:e.detail.height};sendModuleData.moduleParameters.cropField=[e]}});"function"==typeof e.ready&&e.ready.then(function(){})},a.src=t,a.width=this.offsetWidth,a.height=this.offsetHeight;e=Math.min((f.max-f.min)/d,(p.max-p.min)/d);m=e}),c.addEventListener("timeupdate",function(){k.value>this.currentTime&&(this.currentTime=k.value),this.currentTime>w.value&&(this.currentTime=k.value);var e=F(this.currentTime),t=F(d);h.textContent=e+"/"+t,i.value=this.currentTime/d*i.max}),n.querySelector(".close-button").onclick=function(){sendModuleData.sourceFile.urlFile=e,sendModuleData.sourceFile.formatFile="mp4",t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.cropField)&&(0===sendModuleData.moduleParameters.cropField.length?(console.log("Crop field is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("Crop field is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},document.body.appendChild(r)}function createModalCropperImage(e,t=null,a){"ontouchstart"in window||navigator.msMaxTouchPoints;var o=document.querySelector(".modal-cropper-image-template").content.cloneNode(!0),r=o.querySelector(".modal-root");r.querySelector(".media-element-field");const n=r.querySelector(".image");n.onload=function(){var e=new Cropper(n,{viewMode:2,movable:!0,minCropBoxWidth:40,minCropBoxHeight:40,crop(e){e={x:e.detail.x,y:e.detail.y,width:e.detail.width,height:e.detail.height};sendModuleData.moduleParameters.cropField=[e]}});"function"==typeof e.ready&&e.ready.then(function(){}),sendModuleData.sourceFile.naturalWidth=n.naturalWidth,sendModuleData.sourceFile.naturalHeight=n.naturalHeight,sendModuleData.sourceFile.offsetWidth=n.offsetWidth,sendModuleData.sourceFile.offsetHeight=n.offsetHeight};try{n.src=URL.createObjectURL(e)}catch{n.src=e}r.querySelector(".close-button").onclick=function(){sendModuleData.sourceFile.urlFile=e,sendModuleData.sourceFile.formatFile="jpg",t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.cropField)&&(0===sendModuleData.moduleParameters.cropField.length?(console.log("Crop field is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("Crop field is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},document.body.appendChild(o)}function createModalCropperAvatarImage(t=null,n=null){"ontouchstart"in window||navigator.msMaxTouchPoints;var e=document.querySelector(".modal-avatar-template").content.cloneNode(!0);const a=e.querySelector(".modal-root");a.querySelector(".media-element-field");var o=a.querySelector("#avatar-input");const r=a.querySelector(".gender-button");let l="male";const i=a.querySelector(".age-select"),s=a.querySelector(".desktop-ethnic-select"),c=a.querySelector(".mobile-ethnic-select"),d=a.querySelector(".generate-avatar-button");function u(e){document.querySelectorAll(".cropper-container").forEach(e=>{e.remove()});const t=a.querySelector(".image");t.src="",t.classList.remove(".cropper-hidden"),t.onload=function(){void 0!==t.cropper&&t.cropper.destroy();var e=new Cropper(t,{aspectRatio:1,viewMode:2,movable:!0,minCropBoxWidth:40,minCropBoxHeight:40,autoCropArea:.2,crop(e){e={x:e.detail.x,y:e.detail.y,width:e.detail.width,height:e.detail.height};sendModuleData.moduleParameters.avatarCropField=[e]}});"function"==typeof e.ready&&e.ready.then(function(){}),sendModuleData.avatarFile.naturalWidth=t.naturalWidth,sendModuleData.avatarFile.naturalHeight=t.naturalHeight,sendModuleData.avatarFile.offsetWidth=t.offsetWidth,sendModuleData.avatarFile.offsetHeight=t.offsetHeight},t.src=e}async function h(t=null){const a=document.createElement("div");a.classList.add("group");var e=document.createElement("label"),o=(e.classList.add("w-20","h-20","relative","flex","flex-row","text-center","items-center","justify-center","gap-3","cursor-pointer","bg-dark-elements","rounded-[.625rem]","border","border-dashed","border-white","border-opacity-20","py-6"),document.createElement("button")),r=document.createElement("img"),r=(r.src=t,r.classList.add("w-20","h-20","object-cover","rounded-[.625rem]"),o.appendChild(r),document.createElement("button")),e=(r.classList.add("rounded-md","flex","items-center","justify-center","transition-colors","font-normal","disabled:cursor-not-allowed","px-1.5","gap-1.5","py-1.5","opacity-0","group-hover:opacity-100","transition-opacity","absolute","top-1","right-1","z-[1]","full-opacity-on-touchscreen","!bg-dark-pop-up","hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements"),r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="white"><g><path d="M2.5 4.99996H17.5M15.8333 4.99996V16.6666C15.8333 17.5 15 18.3333 14.1667 18.3333H5.83333C5 18.3333 4.16667 17.5 4.16667 16.6666V4.99996M6.66667 4.99996V3.33329C6.66667 2.49996 7.5 1.66663 8.33333 1.66663H11.6667C12.5 1.66663 13.3333 2.49996 13.3333 3.33329V4.99996M8.33333 9.16663V14.1666M11.6667 9.16663V14.1666" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g></svg>',e.appendChild(o),e.appendChild(r),a.appendChild(e),d.parentElement),e=e.parentElement;e.parentElement;e.insertAdjacentElement("afterend",a),o.onclick=async function(){var e=await urlToBlob(t);u(window.URL.createObjectURL(e))},r.onclick=function(){openDeleteNoticeModal(t,n).then(e=>{!0===e&&a.remove()}).catch(e=>{console.error("Error:",e)})}}s.onchange=function(){c.value=this.value},c.onchange=function(){s.value=this.value},r.onclick=function(){"male"===l?(l="female",r.querySelector(".fa-solid.fa-mars").parentElement.classList.add("hidden"),r.querySelector(".fa-solid.fa-venus").parentElement.classList.remove("hidden")):(l="male",r.querySelector(".fa-solid.fa-mars").parentElement.classList.remove("hidden"),r.querySelector(".fa-solid.fa-venus").parentElement.classList.add("hidden"))},d.onclick=async function(){try{var e=await fetch("/generate-avatar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gender:l,age:i.value,ethnic:s.value})});if(!e.ok)throw new Error("Network response was not ok");var t=await e.json();200===t.status&&h(window.location.origin+t.media_file)}catch(e){console.error("There was a problem with the fetch operation:",e)}},(async()=>{try{await new Promise((o,r)=>{fetch("/get-avatars").then(e=>{if(e.ok)return e.json();throw new Error("Network response was not ok")}).then(e=>{if(200===e.status){const t=window.location.origin,a=e.folder_name;e=e.user_avatars.map(async e=>{!1===e.isDirectory&&"image"===getFileFormat(e.name)&&h(`${t}/media/content/${userContentId}/${a}/`+e.name)});Promise.all(e).then(o).catch(r)}}).catch(e=>{console.error("There was a problem with the fetch operation:",e),r(e)})}),console.log("User avatars initialization completed successfully")}catch(e){console.error("Error initializing user avatars:",e)}})(),a.querySelector(".close-button").onclick=function(){var e=a.querySelector(".image");sendModuleData.avatarFile.urlFile=e.src,sendModuleData.avatarFile.formatFile="jpg",t&&t instanceof HTMLElement&&Array.isArray(sendModuleData.moduleParameters.avatarCropField)&&(0===sendModuleData.moduleParameters.avatarCropField.length?(console.log("Avatar crop field is a list (array) and it's empty."),t.classList.remove("text-accent-primary","stroke-accent-primary"),t.classList.add("text-danger-primary","stroke-danger-primary")):(console.log("Avatar crop field is a list (array) and it's not empty."),t.classList.add("text-accent-primary","stroke-accent-primary"),t.classList.remove("text-danger-primary","stroke-danger-primary"))),closeModal(this)},o.addEventListener("change",function(e){e=e.target.files;if(0<e.length){const t=e[0];e=new FileReader;e.onload=function(e){t.type.startsWith("image")&&u(e.target.result)},e.readAsDataURL(t)}}),document.body.appendChild(e)}function createModalLoadOneAudio(a=null,o=null,e=null){"ontouchstart"in window||navigator.msMaxTouchPoints;var t=document.querySelector(".modal-load-one-audio-template").content.cloneNode(!0),r=t.querySelector(".modal-root");const n=r.querySelector(".modal-message");var l=r.querySelector(".modal-notification"),l=(e&&(l.classList.remove("hidden"),l.innerHTML=e),r.querySelector("#one-audio-input"));const i=r.querySelector(".record-button");let s,c=[],d=Date.now(),u;function h(){var e,t;s&&"recording"===s.state&&(i.classList.remove("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements"),i.classList.add("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),i.innerHTML='<i style="scale: 1.2" class="fa-solid fa-microphone-lines fill-dark-background group-disabled:fill-light-tertiary"></i>Record voice',s.stop(),clearTimeout(u),0<c.length)&&(e=new Blob(c,{type:"audio/wav"}),e=URL.createObjectURL(e),t=(Date.now()-d)/1e3,n.classList.add("hidden"),createModalLoadedOneAudio(e,a,t,o)),s=null}i.onclick=function(){s&&"recording"===s.state?h():(d=Date.now(),this.classList.remove("hover:bg-accent-hover","text-dark-background","bg-accent-primary"),this.classList.add("hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements"),this.innerHTML='<i style="scale: 1.2" class="fa-solid fa-microphone-lines-slash fill-dark-background group-disabled:fill-light-tertiary"></i>Stop record',c=[],navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){(s=new MediaRecorder(e)).ondataavailable=function(e){c.push(e.data)},s.onstop=function(){var e=new Blob(c,{type:"audio/webm"}),e=URL.createObjectURL(e),t=(Date.now()-d)/1e3;console.log("Recording stopped"),n.classList.add("hidden"),createModalLoadedOneAudio(e,a,t,o)},s.start(),console.log("Recording started"),u=setTimeout(h,1e3*maxDurationToShow)}).catch(function(e){console.error("Error accessing microphone:",e)}))},a&&(r.querySelector("h2").querySelector("text").textContent=a),l.addEventListener("change",function(e){e=e.target.files;if(0<e.length){const t=e[0];e=new FileReader;e.onload=function(e){t.type.startsWith("audio")&&(n.classList.add("hidden"),e=e.target.result.split(",")[1],e=base64ToBlob(e,"audio/wav"),createModalLoadedOneAudio(URL.createObjectURL(e),a,void 0,o))},e.readAsDataURL(t)}else n.classList.remove("hidden"),n.querySelector("span").textContent="Something went wrong. Please, try again."}),document.body.appendChild(t)}function createModalLoadedOneAudio(e,t=null,o=null,a=null){"ontouchstart"in window||navigator.msMaxTouchPoints;var r=document.querySelector(".modal-loaded-one-audio-template").content.cloneNode(!0),n=r.querySelector(".modal-root");const l=n.querySelector(".trim-audio-message");var i=n.querySelector(".restart-button"),s=n.querySelector(".attach-button"),c=n.querySelector(".close-button");const d=n.querySelector(".timeline-range-current"),u=n.querySelector(".timeline-range-left"),h=n.querySelector(".timeline-markers-audio-start"),m=n.querySelector(".timeline-range-right"),p=n.querySelector(".timeline-markers-audio-end"),f=document.createElement("div"),v=(f.classList.add("h-full","absolute","z-[2]","left-0","flex-row","flex","bg-dark-elements","opacity-90"),document.createElement("div"));v.classList.add("h-full","absolute","z-[2]","right-0","flex-row","flex","bg-dark-elements","opacity-90"),d.parentElement.appendChild(f),d.parentElement.appendChild(v);let g=10,y,w;const b=n.querySelector("audio"),S=(b.src=e,n.querySelector(".audio-control"));function k(e){var t=d.parentElement;const l=20,i=document.createElement("canvas"),a=(i.style.opacity=.5,i.width=t.offsetWidth,i.height=t.offsetHeight-2*l,t.appendChild(i),window.AudioContext=window.AudioContext||window.webkitAudioContext,new AudioContext);const s=(e,t,a,o,r)=>{e.lineWidth=1,e.strokeStyle="#fff",e.fillStyle="#fff",e.beginPath(),a=r?a:-a,a=-Math.abs(a),e.moveTo(t,0),e.lineTo(t,a),e.arc(t+o/2,a,o/2,0,0,r),e.lineTo(t+o,0),e.stroke(),e.fill()};fetch(e).then(e=>e.arrayBuffer()).then(e=>a.decodeAudioData(e)).then(e=>{{var a=(e=>{const t=Math.pow(Math.max(...e),-1);return e.map(e=>e*t)})((e=>{const o=e.getChannelData(0),t=100,r=Math.floor(o.length/t),n=[];for(let e=0;e<t;e++){let t=r*e;let a=0;for(let e=0;e<r;e++)a=a+Math.abs(o[t+e]);n.push(a/r)}return n})(e)),t=window.devicePixelRatio||1,o=(i.width=i.offsetWidth*t,i.height=(i.offsetHeight+2*l)*t,i.getContext("2d")),r=(o.scale(t,t),o.translate(0,i.offsetHeight/2+l),i.offsetWidth/a.length);for(let t=0;t<a.length;t++){var n=r*t;let e=a[t]*i.offsetHeight-l;e<0?e=0:e>i.offsetHeight/2&&(e=e>i.offsetHeight/2),s(o,n,e,r,(t+1)%2)}}})}function x(e,t,a){return Math.abs(e/(a-t)*o).toFixed(2)}function L(e){var t=Math.floor(e/60),e=Math.floor(e%60);return t.toString().padStart(2,"0")+":"+e.toString().padStart(2,"0")}b.addEventListener("timeupdate",function(){var e;y>this.currentTime&&isFinite(y)&&(this.currentTime=y),w<this.currentTime&&isFinite(y)&&(this.currentTime=y),(o||isFinite(b.duration))&&(e=this.currentTime/o*100,d.style.left=e+"%")}),b.onloadedmetadata=function(){y=0,h.textContent="0:00",!o&&isFinite(b.duration)?(w=b.duration,o=b.duration):w=o,o>maxDurationToShow&&(w=maxDurationToShow),p.textContent=L(w),m.value=(a=w,e=m.min,t=m.max,Math.abs(a/o*(t-e)).toFixed(2)),m.oninput(),o>maxDurationToShow&&(l.classList.remove("hidden"),l.querySelector("text").textContent=maxDurationToShow+" seconds");var e,t,a=Math.min((m.max-m.min)/o,(u.max-u.min)/o);g=a,k(b.src),(t=document.createElement("div")).classList.add("h-14","absolute","z-2","left-0","w-full"),d.parentElement.appendChild(t),t.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=(this.offsetWidth,Math.min(e,this.offsetWidth)/this.offsetWidth*100),t=(d.style.left=a+"%",o*a/100);b.currentTime=t})},S.addEventListener("click",function(){b.paused?b.play():b.pause();var e=b.paused?'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="#fff"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.167 2.5 15.832 10 4.166 17.5v-15Z"></path></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="#fff"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7.833 3.333H4.5v13.334h3.333V3.333ZM15.5 3.333h-3.333v13.334H15.5V3.333Z"></path></svg>';S.innerHTML=e}),window.addEventListener("resize",function(){var e;e=timeline.offsetWidth*u.value/(u.max-u.min),f.style.width=e+"px",e=timeline.offsetWidth-timeline.offsetWidth*m.value/(m.max-m.min),v.style.width=e+"px"}),u.parentElement.addEventListener("click",function(e){var t=this.getBoundingClientRect(),a=this.parentElement.getBoundingClientRect(),e=e.pageX-t.left-(a.left-t.left),a=(this.offsetWidth,Math.min(e,this.offsetWidth)/this.offsetWidth*100),t=(d.style.left=a+"%",o*a/100);b.currentTime=t}),u.oninput=function(){parseInt(m.value)-parseInt(u.value)<=g&&(u.value=parseInt(m.value)-g);var e=this.parentElement.offsetWidth*this.value/(this.max-this.min),e=(h.style.left=e+"px",this.parentElement.offsetWidth*this.value/(this.max-this.min));f.style.width=e+"px",y=x(this.value,this.max,this.min),isFinite(y)&&(h.textContent=L(y))},m.oninput=function(){parseInt(m.value)-parseInt(u.value)<=g&&(m.value=parseInt(u.value)+g);var e=this.parentElement.offsetWidth-this.parentElement.offsetWidth*this.value/(this.max-this.min),e=(p.style.right=e+"px",this.parentElement.offsetWidth-this.parentElement.offsetWidth*this.value/(this.max-this.min));v.style.width=e+"px",w=x(this.value,this.max,this.min),isFinite(w)&&(p.textContent=L(w))},i.onclick=function(){b.currentTime=y},s.onclick=function(){a&&"function"==typeof a&&a(e,y,w),document.querySelectorAll(".modal-root").forEach(e=>{closeModal(e)})},c.onclick=function(){document.querySelectorAll(".modal-root").forEach(e=>{closeModal(e)})},t&&(n.querySelector("h2").querySelector("text").textContent=t),document.body.appendChild(r)}async function createModalLoadAnalysis(a,o=null){"ontouchstart"in window||navigator.msMaxTouchPoints;var e=document.querySelector(".modal-load-analysis-template").content.cloneNode(!0),t=e.querySelector(".modal-root");const r=t.querySelector(".modal-message");t=t.querySelector(".scan-button");const n=t.parentElement.parentElement,l=async()=>{let e;e=(["jpg","jpeg","png","gif","bmp"].includes(o.toLowerCase())?generateImageFilename:["mp4","avi","mov","wmv","mkv"].includes(o.toLowerCase())?generateVideoFilename:["wav","mp3"].includes(o.toLowerCase())?generateAudioFilename:generateUUID)(),"string"==typeof a&&(a=await urlToBlob(a)),uploadChunkFile(a,e);var t={method:analysisModuleName,filename:e};await fetch("/submit-cpu-task",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{if(200===e.status){const t=e.id;setTimeout(()=>{(async e=>{const a=setInterval(async()=>{await fetch(`/query-cpu-task/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{console.log(e);if(e.status===200){clearInterval(a);if(!e.response){i("Oops! Something went wrong. Please try again.",true);return}const t=e.response.is_original;if(t===true)i("Heads up: This content is not a deepfake from Wunjo, but it could be a deepfake from another program or even original content. You know, I dont know what I dont know!",false);else i("Yeah! This content appears to be a deepfake created by Wunjo.",false)}else if(e.status===300){clearInterval(a);i(e.response.message,true)}else if(e.status===404){clearInterval(a);i(e.response.message,true)}}).catch(e=>{console.error("An error occurred:",error);clearInterval(a);i("Oops! An unexpected error occurred. Please try again.",true)})},3e3)})(t)},1e3)}else loaderModalWarn("Something wrong..."+e.message)}).catch(e=>{loaderModalError("Something wrong...During create task.")})};function i(e,t=!1){n.classList.add("hidden"),r.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" stroke="#fff" fill="#fff" class="shrink-0"><g clip-path="url(#a)"><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-opacity="0.6" stroke-width="1.5" d="M10 6.666V10m0 3.333h.008M18.333 10a8.333 8.333 0 1 0-16.667 0 8.333 8.333 0 0 0 16.667 0Z"></path></g><defs><clipPath id="a"><path stroke="none" d="M0 0h20v20H0z"></path></clipPath></defs></svg><span>${e}</span>`,!1===t?(r.classList.remove("bg-dark-background"),r.classList.add("bg-accent-primary")):(r.classList.remove("bg-dark-background"),r.classList.add("bg-danger-primary"))}t.onclick=async function(){n.innerHTML="";var e=document.createElement("div"),t=(e.classList.add("flex","items-center","gap-2","p-2.5","relative","w-full","h-10","bg-dark-elements","rounded-[.625rem]","overflow-hidden"),document.createElement("div")),a=(t.classList.add("absolute","w-full","h-full","left-0","top-0","bg-gradient-to-r","from-[rgba(255,237,210,0.20)]","to-accent-primary","opacity-10"),t.style.background="linear-gradient(to right, rgba(255, 237, 210, 0.2), rgb(255, 237, 210))",document.createElement("p"));a.classList.add("text-m-mobile","md:text-m","grow"),a.textContent="Scanning...",(scanLoadingDivBackground=document.createElement("div")).classList.add("absolute","h-full","w-full","left-0","top-0","animate-loadingStripe"),scanLoadingDivBackground.style.background="repeating-linear-gradient(-45deg, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0) 16px, rgba(0, 0, 0, 0.08) 16px, rgba(0, 0, 0, 0.08) 32px) 0% 0% / 200% 200%",e.appendChild(t),e.innerHTML+='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none" class="animate-loadingRing mx-auto stroke-accent-primary"><path d="M17.5 10C17.5 14.1421 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 5.85786 5.85786 2.5 10 2.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>',e.appendChild(a),e.appendChild(scanLoadingDivBackground),n.appendChild(e),await l()},console.log(a),document.body.appendChild(e)}async function createModalUpdate(){var e=document.querySelector(".modal-update-template").content.cloneNode(!0),t=e.querySelector(".modal-root").querySelector("h2");function a(e){return e.split(".").map(e=>parseInt(e,10))}function o(t,a){for(let e=0;e<t.length;e++){if(a[e]>t[e])return!0;if(a[e]<t[e])return!1}return!1}var r=JSON.parse(serverVersionData);if(0!==Object.keys(r).length&&r.hasOwnProperty("version")){var n=r.version;const l=a(document.querySelector(".version").getAttribute("vers"));if(o(l,a(n))){const i=r.history,s=Object.keys(i).filter(e=>o(l,a(e))).sort((e,t)=>{e=a(e);return a(t).join(".")-e.join(".")}),c=document.createElement("div");s.forEach((e,a)=>{const o=document.createElement("p"),r=(o.classList.add("max-h-[500px]","flex","gap-2.5","text-m-mobile","md:tex-m","p-2.5","bg-dark-background","bg-opacity-30","rounded-md"),o.style.overflowY="auto",o.innerHTML='<svg class="shrink-0 opacity-60" width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" stroke="white" stroke-width="1.5"/><path d="M10.125 8.875C10.125 7.83947 10.9645 7 12 7C13.0355 7 13.875 7.83947 13.875 8.875C13.875 9.56245 13.505 10.1635 12.9534 10.4899C12.478 10.7711 12 11.1977 12 11.75V13" stroke="white" stroke-width="1.5" stroke-linecap="round"/><circle cx="12" cy="16" r="1" fill="white"/></svg>',document.createElement("span"));r.classList.add("flex","flex-col");var t=document.createElement("strong");t.textContent=e,r.appendChild(t),i[e].forEach(e=>{var t=document.createElement("text");t.classList.add("text-light-secondary","my-1"),t.textContent=e,r.appendChild(t)}),o.appendChild(r),a!==s.length-1&&o.classList.add("hidden"),c.appendChild(o),o.addEventListener("click",()=>{let e=a-1;e<0&&(e=s.length-1);var t=c.children[e];o.classList.add("hidden"),t&&t.classList.remove("hidden")})}),t.after(c)}}document.body.appendChild(e)}function createModalMessage(e){var t=document.querySelector(".modal-message-template").content.cloneNode(!0);t.querySelector(".modal-root").querySelector(".message").textContent=e,document.body.appendChild(t)}function loaderModalHidden(){var e,t=document.querySelector(".modal-load-element");t&&(t.querySelector("p").textContent="",e=t.querySelector(".loader"),t.classList.add("hidden"),e.classList.remove("loader-warn","loader-error"))}function loaderModalInfo(e){var t=document.querySelector(".modal-load-element");t&&(t.querySelector("p").textContent=e,t.classList.remove("hidden"),t.querySelector(".loader").classList.remove("loader-warn","loader-error"))}function loaderModalWarn(e){var t=document.querySelector(".modal-load-element");t&&(t.querySelector("p").textContent=e,t.classList.remove("hidden"),(e=t.querySelector(".loader")).classList.add("loader-warn"),e.classList.remove("loader-error"))}function loaderModalError(e){var t=document.querySelector(".modal-load-element");t&&(t.querySelector("p").textContent=e,t.classList.remove("hidden"),(e=t.querySelector(".loader")).classList.add("loader-error"),e.classList.remove("loader-warn"))}